<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/session_start.php");
	include("php_scripts/function_share.php");
	include("php_scripts/load_per_control.php");
	
	$search_per_type = (isset($search_per_type))? $search_per_type : 1;
	
	switch($CTRL_TYPE){
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;

			$search_ct_code = '140';
			$cmd = " select CT_NAME from PER_COUNTRY where trim(CT_CODE)='$search_ct_code' ";
			$db_dpis->send_cmd($cmd);	
			$data = $db_dpis->get_array();
			$search_ct_name = $data[CT_NAME];
			break;
		case 3 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
	} // end switch case	
	
	switch($SESS_USERGROUP_LEVEL){
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;

			$search_ct_code = '140';
			$cmd = " select CT_NAME from PER_COUNTRY where trim(CT_CODE)='$search_ct_code' ";
			$db_dpis->send_cmd($cmd);	
			$data = $db_dpis->get_array();
			$search_ct_name = $data[CT_NAME];
			break;
		case 3 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
		case 5 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id = $ORG_ID;
				$search_org_name = $ORG_NAME;			
			}else if($SESS_ORG_STRUCTURE==1){	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id = $ORG_ID;
				$search_org_ass_name = $ORG_NAME;
			}
			break;
		case 6 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id = $ORG_ID;
				$search_org_name = $ORG_NAME;
			}else{	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id = $ORG_ID;
				$search_org_ass_name = $ORG_NAME;
			}
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id_1 = $ORG_ID_1;
				$search_org_name_1 = $ORG_NAME_1;
			}else{	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id_1 = $ORG_ID_1;
				$search_org_ass_name_1 = $ORG_NAME_1;
			}
			break;
	} // end switch case
	
	$search_min_level = 1;
	$search_max_level = 11;
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
</head>
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript" src="java_scripts/function_search.js"></script>   
<script language="JavaScript">
	var total_rpt_order = 4;

	function change_current_page( page ){
		form1.current_page.value = page;
		form1.submit();
	}
		
	function call_select_person () {	
		parameter = "&SELECTED_LIST=" + form1.SELECTED_PER_ID.value;
	    call_openDialog("select_person.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"รายชื่อ<?=$PERSON_TITLE?>");		
	}

	function call_show_person () {	
		parameter = "&SELECTED_LIST=" + form1.SELECTED_PER_ID.value;
	    call_openDialog("show_person.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"รายชื่อ<?=$PERSON_TITLE?>");		
	}

	function get_parameter_search_per_line(){
		// set ตัวแปรกลาง เพื่อส่งค่าสำหรับ search LINE
		var parameter_search_per_line = "";
	
		//alert("0:"+document.all.SEARCH_PER_ORG.style.display);
		if(form1.PROVINCE_ID && form1.PROVINCE_ID.value!=""){ 				parameter_search_per_line ="PROVINCE:"+form1.PROVINCE_ID.value; }
		if(form1.MINISTRY_ID && form1.MINISTRY_ID.value!=""){					if(parameter_search_per_line) parameter_search_per_line += "|";	parameter_search_per_line +="MINISTRY:"+form1.MINISTRY_ID.value; }
		if(form1.DEPARTMENT_ID && form1.DEPARTMENT_ID.value!=""){	if(parameter_search_per_line) parameter_search_per_line += "|";	parameter_search_per_line +="DEPARTMENT:"+form1.DEPARTMENT_ID.value;
		}
		
		if(document.all.SEARCH_PER_ORG.style.display=='block'){
		if(form1.search_org_id && form1.search_org_id.value!=""){  			if(parameter_search_per_line) parameter_search_per_line += "|";	parameter_search_per_line +="ORG:"+form1.search_org_id.value;}
		if(form1.search_org_id_1 && form1.search_org_id_1.value!=""){		if(parameter_search_per_line) parameter_search_per_line += "|";	parameter_search_per_line +="ORG_1:"+form1.search_org_id_1.value;}
		if(form1.search_org_id_2 && form1.search_org_id_2.value!=""){		if(parameter_search_per_line) parameter_search_per_line += "|";	parameter_search_per_line +="ORG_2:"+form1.search_org_id_2.value;}
		} //end if SEARCH_PER_ORG
		if(parameter_search_per_line ){		parameter_search_per_line  = "&LINE_CONDITION="+parameter_search_per_line;	}
	return parameter_search_per_line;
	}

	function call_search_perline () {	
		var parameter = "";
 		parameter_search_per_line= get_parameter_search_per_line();		//alert('>>'+parameter_search_per_line);
		call_openDialog("search_perline.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter + parameter_search_per_line,800,600,"<?=$PL_TITLE?>");
	}

	function call_report ( type ) {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var HISTORY_LIST = "";
		for(var i=1; i<=total_rpt_order; i++){
			if(eval("document.all.HISTORY_ORDER_" + i + ".checked")){
				if(HISTORY_LIST) HISTORY_LIST += "|";
				HISTORY_LIST += eval("document.all.HISTORY_ORDER_" + i + ".value");
			}
		}	
		for(var i=0; i < document.form1.NUMBER_DISPLAY.length; i++){
			if(document.form1.NUMBER_DISPLAY[i].checked)	NUMBER_DISPLAY = document.form1.NUMBER_DISPLAY[i].value;
		}
		document.form1.HISTORY_LIST.value = HISTORY_LIST;
		document.form1.target = "_blank";
		if(!type) document.form1.action = "report/rpt_R010017.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY+"&FLAG_RTF=0";
		else if(type==2) document.form1.action = "report/rpt_R010017.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY+"&FLAG_RTF=1";
		else document.form1.action = "report/rpt_R010017_xls.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;
		document.form1.submit();
	} 
	
	function swap_order(ord1, ord2){
		var tmp_ord1_checked = eval("document.all.HISTORY_ORDER_" + ord1 + ".checked");
		var tmp_ord1_value = eval("document.all.HISTORY_ORDER_" + ord1 + ".value");
		var tmp_ord1_label = eval("document.all.HISTORY_LABEL_" + ord1 + ".innerText");
		var tmp_ord1_class = eval("document.all.HISTORY_ROW_" + ord1 + ".className");

		var tmp_ord2_checked = eval("document.all.HISTORY_ORDER_" + ord2 + ".checked");
		var tmp_ord2_value = eval("document.all.HISTORY_ORDER_" + ord2 + ".value");
		var tmp_ord2_label = eval("document.all.HISTORY_LABEL_" + ord2 + ".innerText");
		var tmp_ord2_class = eval("document.all.HISTORY_ROW_" + ord2 + ".className");
		
		eval("document.all.HISTORY_ORDER_" + ord1 + ".checked = " + tmp_ord2_checked);
		eval("document.all.HISTORY_ORDER_" + ord1 + ".value = '" + tmp_ord2_value + "'");
		eval("document.all.HISTORY_LABEL_" + ord1 + ".innerText = '" + tmp_ord2_label + "'");
		eval("document.all.HISTORY_ROW_" + ord1 + ".className = '" + tmp_ord2_class + "'");

		eval("document.all.HISTORY_ORDER_" + ord2 + ".checked = " + tmp_ord1_checked);
		eval("document.all.HISTORY_ORDER_" + ord2 + ".value = '" + tmp_ord1_value + "'");
		eval("document.all.HISTORY_LABEL_" + ord2 + ".innerText = '" + tmp_ord1_label + "'");
		eval("document.all.HISTORY_ROW_" + ord2 + ".className = '" + tmp_ord1_class + "'");
	} 
	
	function move_order(type, order){
		if(type == 1){
			// move it up
			swap_order(order, (order - 1));
		}else if(type == 2){
			// move it down
			swap_order(order, (order + 1));
		} 
	} 
	
	function control_all(isChecked){
		if(isChecked){
			for(var i=1; i<=total_rpt_order; i++){ 
				eval("document.all.HISTORY_ORDER_" + i + ".checked=true;");
				eval("document.all.HISTORY_ROW_" + i + ".className='table_body';");
			} // end for
		}else{
			for(var i=1; i<=total_rpt_order; i++){ 
				eval("document.all.HISTORY_ORDER_" + i + ".checked=false;");
				eval("document.all.HISTORY_ROW_" + i + ".className='table_body_3';");
			} // end for
		}
	} 
	
	function  control_order(isChecked, order){
		if(isChecked){
			eval("document.all.HISTORY_ROW_" + order + ".className='table_body';");
			for(var i=1; i<=total_rpt_order; i++){				
				if(!eval("document.all.HISTORY_ORDER_" + i + ".checked")) break;
			}
			///if(i == 17) document.all.CHECKALL.checked = true;
		}else{
			if(document.all.CHECKALL.checked) document.all.CHECKALL.checked = false;
			eval("document.all.HISTORY_ROW_" + order + ".className='table_body_3';");
		}
	}
	
	function form_initialize(){
		form1.btn_view_list.style.display = 'none';
		for(var i=1; i<=total_rpt_order; i++) eval("document.all.HISTORY_ROW_" + i + ".className='table_body';");
		
		document.all.HISTORY_ORDER_1.value = "SPECIALSKILLHIS";
		document.all.HISTORY_LABEL_1.innerText = "ความเชี่ยวชาญพิเศษ";

		document.all.SEARCH_PER_ORG_ASS.style.display='none';
		document.all.SEARCH_PER_ORG.style.display='block';
	}
	
	function disable_field(disable_flag){
		if(disable_flag){
			form1.search_org_ass_id.value = "";
			form1.search_org_ass_name.value = "";
			form1.search_org_ass_id_1.value = "";
			form1.search_org_ass_name_1.value = "";
			form1.search_org_ass_id_2.value = "";
			form1.search_org_ass_name_2.value = "";
			document.all.SEARCH_PER_ORG.style.display='none';
			document.all.SEARCH_PER_ORG_ASS.style.display='block';
		}else{
			form1.search_org_id.value = "";
			form1.search_org_name.value = "";
			form1.search_org_id_1.value = "";
			form1.search_org_name_1.value = "";
			form1.search_org_id_2.value = "";
			form1.search_org_name_2.value = "";
			document.all.SEARCH_PER_ORG_ASS.style.display='none';
			document.all.SEARCH_PER_ORG.style.display='block';
		} // end if
	}
	function setPerType(per_type){
			if(per_type=="1"){ //กำหนดค่าเริ่มต้น เป็นข้าราชการ
				//document.all.SEARCH_PER_LINE.style.display='block'; document.all.SEARCH_POS_NAME.style.display='none'; document.all.SEARCH_EMPSER_POS_NAME.style.display='none'; document.all.SEARCH_TEMP_POS_NAME.style.display='none';
			}else{
				if(per_type=="2"){
					//document.all.SEARCH_POS_NAME.style.display='block'; document.all.SEARCH_PER_LINE.style.display='none'; document.all.SEARCH_EMPSER_POS_NAME.style.display='none'; document.all.SEARCH_TEMP_POS_NAME.style.display='none';
				}else if(per_type=="3"){
					//document.all.SEARCH_EMPSER_POS_NAME.style.display='block'; document.all.SEARCH_PER_LINE.style.display='none'; document.all.SEARCH_POS_NAME.style.display='none'; document.all.SEARCH_TEMP_POS_NAME.style.display='none';
				}else if(per_type=="4"){
					//document.all.SEARCH_TEMP_POS_NAME.style.display='block'; document.all.SEARCH_PER_LINE.style.display='none'; document.all.SEARCH_POS_NAME.style.display='none';  document.all.SEARCH_EMPSER_POS_NAME.style.display='none';
				}
			} //end else		
	} //end function
	
	function returnFrom(src, returnValue){
//		alert("src="+src+"("+returnValue+")");
		if  (src.indexOf("rpt_column_adjust") > -1) {
			if(returnValue){
				form1.COLUMN_FORMAT.value = returnValue;
	//			alert(form1.COLUMN_FORMAT.value);
			} // end if
		} else if  (src.indexOf("select_person") > -1) {
			form1.SELECTED_PER_ID.value = returnValue;
	//		alert(form1.SELECTED_PER_ID.value);
			if(returnValue){
				form1.btn_view_list.style.display = "block";
				document.getElementById("list_type1").checked=true;
			}else{
				form1.btn_view_list.style.display = "none";
			} // end if
		} else if  (src.indexOf("search_perline") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_pl_code.value = arrValue[0];
				form1.search_pl_name.value = arrValue[1];
				if(document.getElementById("list_type2"))	document.getElementById("list_type2").checked=true;
			} // end if
		}
//		$( "#d_frame" )[0].src="";
//		alert("returnValue="+tt.value);
		tt.value = returnValue;
	} // end if
	
</script>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE=" &gt; ดูข้อมูล";
		include("current_location.html");
?>
	  </td>
	</tr>
  	<tr>
    	<td align="center" valign="top">
		<form name="form1" method="post" action="rpt_R010017.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="SELECTED_PER_ID" value="<?=$SELECTED_PER_ID?>">
          <input type="hidden" name="HISTORY_LIST" value="">
          <input type="hidden" name="report" value="<?=$report?>">
		  <input type="hidden" name="COLUMN_FORMAT" value="<?=$COLUMN_FORMAT?>">
		&nbsp;
		<table width="90%"  border="0" cellspacing="0" cellpadding="0">
		  <tr>
			<td align="center">
			  <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn2" type="button" class="button" style="width:150" value="<?=$PDF_TITLE?>" onClick="call_report(0);">
              <?  } else { ?>
              <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$PDF_TITLE?>" onClick="call_report(0);">
              <? } echo "&nbsp; &nbsp;";?>
			  <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn21" type="button" class="button" style="width:130" value="<?=$EXCEL_TITLE?>" onClick="call_report(1);">
              <?  } else { ?>
              <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$EXCEL_TITLE?>" onClick="call_report(1);">
              <? } echo "&nbsp; &nbsp;";?>
              <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn3" type="reset" class="button" value="<?=$CLEAR_TITLE?>" onClick="form_initialize();">
              <?  } else { ?>
              <img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="30" height="30" border="0" onClick="form_initialize(); form1.reset();">
              <? } echo "&nbsp; &nbsp;"; ?>
			<input type="radio" name="NUMBER_DISPLAY" value="1" <?=($NUMBER_DISPLAY==1)?"checked":""?>>เลขอารบิค
			  <input type="radio" name="NUMBER_DISPLAY" value="2" <?=($NUMBER_DISPLAY==2)?"checked":""?>>เลขไทย
		  	<select name="CH_PRINT_FONT" class="selectbox">
					<?  foreach($ARR_PRINT_FONT as $key=>$value){  ?><option value="<?=$key; ?>"<?=($PRINT_FONT==$key)?"selected":""?> ><?=$value; ?></option><?  } ?>
			</select>
			  </td>
		  </tr>
		</table>  
		&nbsp;
		<table width="95%" align="center" cellpadding="0" cellspacing="0">
    	  <tr>
		  	<td width="35%" align="center" valign="top"><table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
              <tr>
                <td align="center" valign="top"><table width="100%" border="0" cellspacing="1" cellpadding="1" class="label_normal">	
                    <tr>
                      <td height="22" colspan="2" align="center" class="table_head"><?=$REPORT_CONDITION?></td>
                      </tr>
                    <tr>
                     <td height="22" nowrap="nowrap" colspan="2">&nbsp;<?=$PER_TYPE_TITLE?>&nbsp;&nbsp;<select class="selectbox" name="search_per_type" onChange="javascript:setPerType(this.value);">		  
<? 
		foreach($PERSON_TYPE as $key=>$value){  
/*
			if($SESS_PER_TYPE==0){	//ทั้งหมด
				$disinput[$key] = "";		$disinput[0]="";	
				$chinput[$key] = "";		
				if(trim($search_per_type) && $search_per_type==$key){	//ค้นหา
					$chinput[$key] = " selected";		$chinput[0]="";		$styleline[$key] = "display:block";
			   }
			}else if(trim($SESS_PER_TYPE) && $SESS_PER_TYPE==$key){	//ประเภทอื่น
				$chinput[$key] = " selected";		 $chinput[0]="";		$disinput[$key]="";		$styleline[$key] = "display:block";
			}
*/
			if($key==1 || $value=="ข้าราขการ"){		// ข้าราขการ
				$chinput[$key] = " selected";		$disinput[$key]="";
?>	
			<option name="search_per_type" value="<?=$key; ?>" <?=$chinput[$key]." ".$disinput[$key]; ?>><?=$value; ?></option>
<?
			} //end if
	  } //end foreach 
?>
	</select>
						</td>
					</tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
                    <tr>
                      <td height="22" nowrap="nowrap" colspan="2"><? $styleORG[$SESS_ORG_STRUCTURE]="display:block;";
					  if($SESS_ORG_STRUCTURE==1){ $select_org_structure=1; $styleORG[0]="display:none;"; }else{ $styleORG[1]="display:none;";	} ?>
                      <input name="select_org_structure" type="radio" value="0" <?=($SESS_ORG_STRUCTURE==1)?"disabled":"" ?> <?=($select_org_structure==0)?"checked":""?> onClick="disable_field(false);">                        <?=$LAW_STRUCTURE_TITLE?></td></tr>
                    <tr>
 <td height="22" nowrap="nowrap" colspan="2"><input name="select_org_structure" type="radio" value="1" <?=($SESS_ORG_STRUCTURE==0 || ($SESS_ORG_STRUCTURE==2&&$ORG_ID))?"disabled":"" ?> <?=($select_org_structure==1)?"checked":""?> onClick="disable_field(true);">   <?=$ASSIGN_STRUCTURE_TITLE?></td>
                    </tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
			<? if($CTRL_TYPE == 2 || ($SESS_USERGROUP_LEVEL == 2 && $BKK_FLAG != 1)){ ?>
                    <tr>
                      <td width="25%" align="right" height="22" nowrap="nowrap"><?=$PV_TITLE?>&nbsp;:&nbsp;</td>
                      <td><input type="text" name="PROVINCE_NAME" value="<?=$PROVINCE_NAME?>" style="width:75%" class="textbox"  readonly="true"></td>
                    </tr>
			<? } // end if ?>
                    <tr>
                     <td width="25%" align="right" height="22" nowrap="nowrap"><?=$MINISTRY_TITLE?>&nbsp;:&nbsp;</td>
                      <td><input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:75%" class="textbox"  readonly="true">
		  	  <? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3){ ?>
                        <input type="button" name="btn_ministry" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_ministry()">
                        <input name="image2" type="image" onClick="form1.MINISTRY_NAME.value=''; form1.MINISTRY_ID.value=''; form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value=''; form1.search_org_name.value=''; form1.search_org_id.value=''; form1.search_org_name_1.value=''; form1.search_org_id_1.value=''; form1.search_org_name_2.value=''; form1.search_org_id_2.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
                        <? }else{ echo "&nbsp;"; } // end if ?>
                        <input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>">					  </td>
                    </tr>
                    <tr>
                    <td width="25%" align="right" height="22" nowrap="nowrap"><?=$DEPARTMENT_TITLE?>&nbsp;:&nbsp;</td>
                    <td><input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:75%" class="textbox"  readonly="true">
                      <? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4){ ?>
                      <input type="button" name="btn_department" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_department()">
                      <input name="image2" type="image" onClick="form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value=''; form1.search_org_name.value=''; form1.search_org_id.value=''; form1.search_org_name_1.value=''; form1.search_org_id_1.value=''; form1.search_org_name_2.value=''; form1.search_org_id_2.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
                      <? }else{ echo "&nbsp;"; } // end if ?>
                      <input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>">					</td>
                  </tr>
                  <tr>
                      <td height="22" colspan="2" align="center">
					  	<div id="SEARCH_PER_ORG" style="<?=$styleORG[0]; ?>">
					    <table width="100%" border="0" cellspacing="1" cellpadding="1" class="label_normal">						  
						  <tr>
							<td width="25%" align="right" height="22"><?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_name" value="<?=$search_org_name?>" style="width:75%" class="textbox"  readonly="true">
							  <? if($SESS_USERGROUP_LEVEL < 5){ if(!$SESS_ORG_ID) { ?>
							  <input type="button" name="btn_org" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org()">
							  <input name="image" type="image" onClick="form1.search_org_name.value=''; form1.search_org_id.value=''; form1.search_org_name_1.value=''; form1.search_org_id_1.value=''; form1.search_org_name_2.value=''; form1.search_org_id_2.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <? } }else{ echo "&nbsp;"; } // end if ?>
							  <input type="hidden" name="search_org_id" value="<?=$search_org_id?>">                    </td>
						  </tr>
						  <tr>
							<td align="right" height="22"><?=$ORG_TITLE1?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_name_1" value="<?=$search_org_name_1?>" style="width:75%" class="textbox"  readonly="true">
							  <input type="button" name="btn_org_1" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_1()">
							  <input name="image" type="image" onClick="form1.search_org_name_1.value=''; form1.search_org_id_1.value=''; form1.search_org_name_2.value=''; form1.search_org_id_2.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <input type="hidden" name="search_org_id_1" value="<?=$search_org_id_1?>">                    </td>
						  </tr>
						  <tr>
							<td align="right" height="22"><?=$ORG_TITLE2?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_name_2" value="<?=$search_org_name_2?>" style="width:75%" class="textbox"  readonly="true">
							  <input type="button" name="btn_org_2" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_2()">
							  <input name="image" type="image" onClick="form1.search_org_name_2.value=''; form1.search_org_id_2.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <input type="hidden" name="search_org_id_2" value="<?=$search_org_id_2?>"></td>
						  </tr>

                      	</table>
						</div>
					  	<div id="SEARCH_PER_ORG_ASS" style="<?=$styleORG[1]; ?>">
					    <table width="100%" border="0" cellspacing="1" cellpadding="1" class="label_normal">						  
						  <tr>
							<td align="right" height="22"><?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_ass_name" value="<?=$search_org_ass_name?>" style="width:75%" class="textbox"  readonly="true">
							  <? if($SESS_USERGROUP_LEVEL < 5){ if(!$SESS_ORG_ID) { ?>
							  <input type="button" name="btn_org" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org()">
							  <input name="image" type="image" onClick="form1.search_org_ass_name.value=''; form1.search_org_ass_id.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							   <? } } else{ echo "&nbsp;"; } // end if ?>
							  <input type="hidden" name="search_org_ass_id" value="<?=$search_org_ass_id?>">                    </td>
						  </tr>
						  <tr>
							<td align="right" height="22"><?=$ORG_TITLE1?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_ass_name_1" value="<?=$search_org_ass_name_1?>" style="width:75%" class="textbox"  readonly="true">
							  <input type="button" name="btn_org_ass_1" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_1()">
							  <input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.search_org_ass_name_1.value=''; form1.search_org_ass_id_1.value=''; form1.search_org_ass_name_2.value=''; form1.search_org_ass_id_2.value=''; return false;" align="center" alt="ล้างค่า">
							  <input type="hidden" name="search_org_ass_id_1" value="<?=$search_org_ass_id_1?>">                    </td>
						  </tr>
						  <tr>
							<td align="right" height="22"><?=$ORG_TITLE2?>&nbsp;:&nbsp;</td>
							<td><input type="text" name="search_org_ass_name_2" value="<?=$search_org_ass_name_2?>" style="width:75%" class="textbox"  readonly="true">
							  <input type="button" name="btn_org_ass_2" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_2()">
							  <input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.search_org_ass_name_2.value=''; form1.search_org_ass_id_2.value=''; return false;" align="center" alt="ล้างค่า">
							  <input type="hidden" name="search_org_ass_id_2" value="<?=$search_org_ass_id_2?>"></td>
						  </tr>
						</table>
						</div>
					    </td>
                      </tr>
					   <tr>
						<td height="22">&nbsp;</td>
                      	<td height="7"  align="left"><input name="have_pic" type="checkbox" value="1"> &nbsp;พิมพ์ภาพถ่าย</td>
                      </tr>
					<tr>
						<td height="22">&nbsp;</td>
                      	<td height="7"  align="left"><input name="have_remark" type="checkbox" value="1"> &nbsp;พิมพ์หมายเหตุ</td>
                      </tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
                </table></td>
              </tr>
            </table></td>
      		<td width="40%" height="260" align="center" valign="top">
			<table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
			  <tr>
			  	<td align="center" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                  <tr>
                    <td height="22" colspan="2" align="center" class="table_head"><?=$REPORT_FORMAT ?></td>
                    </tr>
                  <tr>
                    <td width="5%" align="center"><input type="checkbox" id="list_type0" name="list_type[]" value="ALL" checked></td>
                    <td>แสดงรายชื่อทั้งหมด</td>
                  </tr>
                  <tr>
                    <td align="center"><input type="checkbox" id="list_type1" name="list_type[]" value="SELECT"></td>
                    <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td width="33%"><input name="btn_select_list" type="button" class="button" value="<?=$SELECT_PERSON_TITLE?>" onClick="call_select_person();"></td>
                        <td><input name="btn_view_list" type="button" class="button" value="ดูรายชื่อที่เลือก" style="display:none;" onClick="call_show_person();"></td>
                      </tr>
                    </table></td>
                  </tr>
                  <tr>
                    <td align="center"><input type="checkbox" id="list_type2" name="list_type[]" value="CONDITION"></td>
                    <td>ระบุเงื่อนไข</td>
                  </tr>
                  <tr>
                    <td align="center">&nbsp;</td>
                    <td><table width="95%" border="0" cellpadding="1" cellspacing="1" class="table_head">
                      <tr>
                        <td width="25%" height="22"><table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_body_3">
                          <tr>
                            <td width="25%" height="22">&nbsp;<?=$POS_NO_TITLE?></td>
                            <td><input type="text" name="search_pos_no" value="<?=$search_pos_no?>" style="width:25%" class="textbox" onKeyPress="return DigitOnly();" onClick="document.getElementById('list_type2').checked=true;"></td>
                          </tr>
                          <tr>
                            <td height="22">&nbsp;<?=$NAME_TITLE?></td>
                            <td><input type="text" name="search_name" value="<?=$search_name?>" style="width:98%" class="textbox" onClick="document.getElementById('list_type2').checked=true;"></td>
                          </tr>
                          <tr>
                            <td height="22">&nbsp;<?=$SURNAME_TITLE?></td>
                            <td><input type="text" name="search_surname" value="<?=$search_surname?>" style="width:98%" class="textbox" onClick="document.getElementById('list_type2').checked=true;"></td>
                          </tr>
                          <tr>
                            <td height="22">&nbsp;<?=$LEVEL_TITLE?></td>
                                <td height="22">
								<select name="search_min_level" class="selectbox" style="width:80%;" onChange="document.getElementById('list_type2').checked=true;">
								<option value=""></option>
								<?
								$where = "";
								if ($CTRL_TYPE==1) $where = " and LEVEL_NO in ('K4', 'K5', 'D1', 'D2', 'M1', 'M2') ";
									if($DPISDB=="oci8"){ $cmd = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; }
									elseif($DPISDB=="odbc"){ $cmd = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; }
									elseif($DPISDB=="mysql"){ $cmd = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; }
									$db_dpis->send_cmd($cmd);
									while($data = $db_dpis->get_array()){					
								?>
									<option value="<?=$data[LEVEL_NO]?>" <?=(trim($data[LEVEL_NAME])==$search_min_level)?"selected":""?>><?=$data[LEVEL_NAME]?></option>
								<?
									} // end while
								?>
								</select></td>
                          </tr>
                          <tr>
                            <td height="22">&nbsp;ถึง</td>
                            <td>
                              <select name="search_max_level" class="selectbox" style="width:80%;" onChange="document.getElementById('list_type2').checked=true;">
                                <option value=""></option>
                                <?
									if($DPISDB=="oci8"){ $cmd1 = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; } 
									elseif($DPISDB=="odbc"){ $cmd1 = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; }
									elseif($DPISDB=="mysql"){ $cmd1 = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where LEVEL_ACTIVE=1 $where order by LEVEL_SEQ_NO "; }
									$db_dpis->send_cmd($cmd1);
									while($data = $db_dpis->get_array()){					
								?>
                                <option value="<?=$data[LEVEL_NO]?>" <?=(trim($data[LEVEL_NAME])==$search_max_level)?"selected":""?>>
                                  <?=$data[LEVEL_NAME]?>
                                  </option>
                                <?
									} // end while
								?>
                              </select></td>
                          </tr>
						  
						  <tr>
                            <td height="22">&nbsp;<?=$PL_TITLE?></td>
                            <td>
								<input type="text" name="search_pl_name" value="<?=$search_pl_name?>" style="width:75%" class="textbox"  readonly="true">
						   		<input type="button" name="btn_perline" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_perline()">
						  		<input name="image" type="image" onClick="form1.search_pl_name.value=''; form1.search_pl_code.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
 					       		<input type="hidden" name="search_pl_code" value="<?=$search_pl_code?>">							</td>
                          </tr>						  
						  
                          <tr>
                            <td height="22">&nbsp;<?=$PER_STATUS_TITLE?></td>
                            <td>
							  <input name="search_per_status[]" type="checkbox" value="1" onClick="document.getElementById('list_type2').checked=true;" <?=(in_array(1, $search_per_status) || !isset($search_per_status))?"checked":""?>>&nbsp;ปกติ<br>
							  <input name="search_per_status[]" type="checkbox" value="0" onClick="document.getElementById('list_type2').checked=true;" <?=(in_array(0, $search_per_status))?"checked":""?>>&nbsp;รอบรรจุ<br>
							  <input name="search_per_status[]" type="checkbox" value="2" onClick="document.getElementById('list_type2').checked=true;" <?=(in_array(2, $search_per_status))?"checked":""?>>&nbsp;<?=$RETIRE_TITLE?>
							  <input name="search_per_status[]" type="checkbox" value="3" onClick="document.getElementById('list_type2').checked=true;" <?=(in_array(3, $search_per_status))?"checked":""?>>&nbsp;รอเลขที่ตำแหน่ง<br>
							  <!--input name="search_per_status" type="radio" value="" onClick="document.getElementById('list_type2').checked=true;" <?=($search_per_status=="")?"checked":""?>>&nbsp;ทั้งหมด-->							</td>
                          </tr>
                        </table></td>
                        </tr>

                    </table></td>
                  </tr>
                </table></td>
			  </tr>
			</table>
			</td>
			<td align="center" valign="top" height="260">
			<table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
			  <tr>
			  	<td align="center" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                  <tr class="table_head">
                    <td width="5%" align="center"><input type="checkbox" name="CHECKALL" value="" checked onClick="control_all(this.checked);"></td>
                    <td align="center">รายชื่อประวัติที่ต้องการออกรายงาน</td>
                    <td width="5%" align="center">&nbsp;</td>
                    <td width="5%" align="center">&nbsp;</td>
                  </tr>
				  <tr id="HISTORY_ROW_1" class="table_body">
                    <td><input type="checkbox" name="HISTORY_ORDER_1" value="MINISTRY" checked onClick="control_order(this.checked, 1);"></td>
                    <td><span id="HISTORY_LABEL_1"><?=$MINISTRY_TITLE?></span></td>
                    <td align="center">&nbsp;</td>
                    <td align="center"><img src="images/arrow_down.gif" onClick="move_order(2, 1)" style="cursor:hand; display:block;" alt="เลื่อนลำดับลง" name="IMG_DOWN_1"></td>
                  </tr>
                  <tr id="HISTORY_ROW_2" class="table_body_3">
                    <td><input type="checkbox" name="HISTORY_ORDER_2" value="DEPARTMENT" checked onClick="control_order(this.checked, 2);"></td>
                    <td><span id="HISTORY_LABEL_2"><?=$DEPARTMENT_TITLE?></span></td>
                    <td align="center"><img src="images/arrow_up.gif" onClick="move_order(1, 2)" style="cursor:hand; display:block;" alt="เลื่อนลำดับขึ้น" name="IMG_UP_2"></td>
                    <td align="center"><img src="images/arrow_down.gif" onClick="move_order(2, 2)" style="cursor:hand; display:block;" alt="เลื่อนลำดับลง" name="IMG_DOWN_2"></td>
                  </tr>
				  <tr id="HISTORY_ROW_3" class="table_body_3">
                    <td><input type="checkbox" name="HISTORY_ORDER_3" value="EDUCATE" checked onClick="control_order(this.checked, 3);"></td>
                    <td><span id="HISTORY_LABEL_3">ประวัติการศึกษา</span></td>
                    <td align="center"><img src="images/arrow_up.gif" onClick="move_order(1, 3)" style="cursor:hand;" alt="เลื่อนลำดับขึ้น"></td>
                    <td align="center"><img src="images/arrow_down.gif" onClick="move_order(2, 3)" style="cursor:hand;" alt="เลื่อนลำดับลง"></td>
                  </tr>
				  <tr id="HISTORY_ROW_4" class="table_body_3">
                    <td><input type="checkbox" name="HISTORY_ORDER_4" value="SPECIALSKILLHIS" checked onClick="control_order(this.checked, 4);"></td>
                    <td><span id="HISTORY_LABEL_4">ความเชี่ยวชาญพิเศษ</span></td>
                    <td align="center"><img src="images/arrow_up.gif" onClick="move_order(1, 4)" style="cursor:hand; display:block;" alt="เลื่อนลำดับขึ้น" name="IMG_UP_3"></td>
                    <td align="center"><img src="images/arrow_down.gif" onClick="move_order(2, 4)" style="cursor:hand; display:block;" alt="เลื่อนลำดับลง" name="IMG_DOWN_3"></td>
                  </tr>
				  
                </table></td>
			  </tr>
			</table>
			</td>
    	  </tr>
		  <tr>
		<td colspan="4">
                  <table width="100%" border="1" align="center" class="label_normal">
			     	  <tr>
                        <td align="center" colspan="5"><b>ตัวอย่างรายงาน</b></td>
                      </tr>
				  	    <tr align="center" valign="top">
                        <td  align="left" colspan="2" >1. นายสมชาย ใจดี  </td>
						<td  align="left" colspan="3" >ปีเกษียณอายุ 01/10/2558</td>
                      </tr>
				       <tr>
                        <td align="left" colspan="5">ตำแหน่ง ผู้อำนวยการ (สูง) </td>
                      </tr>
                      <tr>
                        <td align="center" colspan="5"><b>ประวัติการศึกษา</b></td>
                      </tr>
                      <tr align="center">
                        <td class="table_body" width="20%" >วุฒิการศึกษา</td>
                        <td class="table_body" width="20%">ชื่อวุฒิการศึกษา</td>
                        <td class="table_body" width="20%">สาขาวิชาเอก</td>
                        <td class="table_body" width="20%">สถาบันการศึกษา</td>
						   <td class="table_body" width="20%">ประเทศ</td>
                      </tr>
					    <tr align="center">
					    <td align="left">ปริญญาตรีหรือเทียบเท่า</td>
                        <td align="left">วิทยาศาสตรบัณฑิต</td>
                        <td align="left">วิทยาการคอมพิวเตอร์</td>
                        <td>มหาวิทยาลัยเชียงใหม่</td>
						 <td>ไทย</td>
						   </tr>      
						     <tr>
                        <td align="center" colspan="5"><b>ความเชี่ยวชาญพิเศษ</b></td>
                      </tr>
                      <tr align="center">
                        <td class="table_body"  colspan="2">ด้านความเชี่ยวชาญพิเศษ</td>
                        <td class="table_body" colspan="3">เน้นทาง</td>
                      </tr>
					    <tr align="center">
					    <td align="left" colspan="2">ด้านการบริหารจัดการและบริหารธุรกิจ</td>
                        <td  align="left" colspan="3">ทรัพยากรบุคคล</td>
						 </tr>      
                     
                    </table>
				</td>	
          </tr>
  		</table>
		&nbsp;
	  </form>	
	  </td>
	</tr>
</table>
<?
	include("jqModalDialog.html");
?>
</body>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
</html>
