<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/master_table_workcycle.php"); 
    
    if(empty($END_SCAN_HH)){ $END_SCAN_HH="23";}
    if(empty($END_SCAN_II)){ $END_SCAN_II="59";}
    if(empty($TIME_LEAVEEARLY_HH)){ $TIME_LEAVEEARLY_HH="13";}
    if(empty($TIME_LEAVEAFTER_HH)){ $TIME_LEAVEAFTER_HH="12";}
    
?>
<html>
<head>
<title><?=$webpage_title;?> - <?=$MENU_TITLE_LV0;?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1;?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2;?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3;?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected;?>" type="text/css">
</head>
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript">
	function change_current_page( page ){
		form1.current_page.value = page;
		form1.submit();
	}
	
	function confirm_delete(data_id , data_label){
		if(confirm("คุณต้องการลบข้อมูลนี้ [ " + data_label + " ] ใช่หรือไม่?")){
			form1.command.value = "DELETE";
			form1.WC_CODE.value = data_id;
			form1.submit();
		} // end if
	}

	   function call_rtf_pdf_report(report_type) {
	   var  report_type
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "รายงานข้อมูล<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")));?>";

		if (report_type==1){
		document.form1.action = "report/rpt_master_table_workcycle.php?report_title=" + encodeURIComponent(report_title) + "&UTC" + rptDate+"&FLAG_RTF=1";
		}else if (report_type==0){ 
		document.form1.action = "report/rpt_master_table_workcycle.php?report_title=" + encodeURIComponent(report_title) + "&UTC" + rptDate+"&FLAG_RTF=0";
		}
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "master_table_workcycle.html";
	} 
	
	function call_export_file() {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "รายงานข้อมูล<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")));?>";

		document.form1.action = "report/rpt_master_table_workcycle_xls.php?report_title=" + encodeURIComponent(report_title) + "&UTC" + rptDate;
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "master_table_workcycle.html";
	}
	
	function checkadd(f) {
		if(f.WC_CODE.value=="") {
			alert("กรุณาระบุ รหัส");
			f.WC_CODE.focus();
			return false;
		} 
		
		if(f.WC_NAME.value=="") {
			alert("กรุณาระบุ ชื่อรอบ");
			f.WC_NAME.focus();
			return false;
		}
		
		
		if(f.WC_START_HH.value=="00" && f.WC_START_II.value=="00") {
			if(confirm("ต้องการใช้เวลา 00.00 เป็นเวลาเข้าใช่หรือไม่?\n กด OK เพื่อยืนยันใช้งาน\n กด Cancel เพื่อกลับไปแก้ไข")){
			}else{
				f.WC_START_HH.focus();
				return false;
			}

		}
		
		
			if(f.WC_END_HH.value=="00" && f.WC_END_II.value=="00") {
				alert("กรุณาระบุ เวลาออก");
				f.WC_END_HH.focus();
				return false;
			}
			
		
			if(f.NEXTDAY_EXIT.checked==false){
				var START = f.WC_START_HH.value+''+f.WC_START_II.value;
				var END = f.WC_END_HH.value+''+f.WC_END_II.value;
				if( parseInt(START) >= parseInt(END)){
					alert("เวลาออกต้อง มากกว่า เวลาเข้า");
					f.WC_END_HH.focus();
					return false;
				}
			}else{
				var START = f.WC_START_HH.value+''+f.WC_START_II.value;
				var END = f.WC_END_HH.value+''+f.WC_END_II.value;
				if( parseInt(START) <= parseInt(END)){
					alert("เวลาออก ของวันถัดไปต้อง น้อยกว่า เวลาเข้า");
					f.WC_END_HH.focus();
					return false;
				}
			}
			
			if(f.NEXTDAY_LEAVEEARLY.checked==false){
				var START3 = f.TIME_LEAVEEARLY_HH.value+''+f.TIME_LEAVEEARLY_II.value;
				var END3 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START3) < parseInt(END3)){
					alert("กรณีลาครึ่งวันหลังต้อง มากกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEEARLY_HH.focus();
					return false;
				}
			}else{
				
				var START3 = f.TIME_LEAVEEARLY_HH.value+''+f.TIME_LEAVEEARLY_II.value;
				var END3 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START3) > parseInt(END3)){
					alert("กรณีลาครึ่งวันหลัง ของวันถัดไปต้อง น้อยกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEEARLY_HH.focus();
					return false;
				}
				
			}
			
			
			if(f.NEXTDAY_LEAVEAFTER.checked==false){
				var START4 = f.TIME_LEAVEAFTER_HH.value+''+f.TIME_LEAVEAFTER_II.value;
				var END4 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START4) < parseInt(END4)){
					alert("กรณีลาครึ่งวันแรกต้อง มากกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEAFTER_HH.focus();
					return false;
				}
			}else{
				var START4 = f.TIME_LEAVEAFTER_HH.value+''+f.TIME_LEAVEAFTER_II.value;
				var END4 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START4) > parseInt(END4)){
					alert("กรณีลาครึ่งวันแรก ของวันถัดไปต้อง น้อยกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEAFTER_HH.focus();
					return false;
				}
				
			}

		

							
		form1.command.value='ADD';
	}
		
	function checkupdate(f) {
		if(f.WC_NAME.value=="") {
			alert("กรุณาระบุ ชื่อรอบ");
			f.WC_NAME.focus();
			return false;
		}
		
		if(f.WC_START_HH.value=="00" && f.WC_START_II.value=="00") {
			if(confirm("ต้องการใช้เวลา 00.00 เป็นเวลาเข้าใช่หรือไม่?\n กด OK เพื่อยืนยันใช้งาน\n กด Cancel เพื่อกลับไปแก้ไข")){
			}else{
				f.WC_START_HH.focus();
				return false;
			}

		}
		
		

			if(f.WC_END_HH.value=="00" && f.WC_END_II.value=="00") {
				alert("กรุณาระบุ เวลาออก");
				f.WC_END_HH.focus();
				return false;
			}
		
			if(f.NEXTDAY_EXIT.checked==false){
				var START = f.WC_START_HH.value+''+f.WC_START_II.value;
				var END = f.WC_END_HH.value+''+f.WC_END_II.value;
				if( parseInt(START) >= parseInt(END)){
					alert("เวลาออกต้อง มากกว่า เวลาเข้า");
					f.WC_END_HH.focus();
					return false;
				}
			}else{
				var START = f.WC_START_HH.value+''+f.WC_START_II.value;
				var END = f.WC_END_HH.value+''+f.WC_END_II.value;
				if( parseInt(START) <= parseInt(END)){
					alert("เวลาออก ของวันถัดไปต้อง น้อยกว่า เวลาเข้า");
					f.WC_END_HH.focus();
					return false;
				}
			}
			
			if(f.NEXTDAY_LEAVEEARLY.checked==false){
				var START3 = f.TIME_LEAVEEARLY_HH.value+''+f.TIME_LEAVEEARLY_II.value;
				var END3 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START3) < parseInt(END3)){
					alert("กรณีลาครึ่งวันหลังต้อง มากกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEEARLY_HH.focus();
					return false;
				}
			}else{
				
				var START3 = f.TIME_LEAVEEARLY_HH.value+''+f.TIME_LEAVEEARLY_II.value;
				var END3 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START3) > parseInt(END3)){
					alert("กรณีลาครึ่งวันหลัง ของวันถัดไปต้อง น้อยกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEEARLY_HH.focus();
					return false;
				}
				
			}
			
			
			if(f.NEXTDAY_LEAVEAFTER.checked==false){
				var START4 = f.TIME_LEAVEAFTER_HH.value+''+f.TIME_LEAVEAFTER_II.value;
				var END4 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START4) < parseInt(END4)){
					alert("กรณีลาครึ่งวันแรกต้อง มากกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEAFTER_HH.focus();
					return false;
				}
			}else{
				var START4 = f.TIME_LEAVEAFTER_HH.value+''+f.TIME_LEAVEAFTER_II.value;
				var END4 = f.WC_START_HH.value+''+f.WC_START_II.value;
				if( parseInt(START4) > parseInt(END4)){
					alert("กรณีลาครึ่งวันแรก ของวันถัดไปต้อง น้อยกว่า เวลาเข้า กรุณาตรวจสอบข้อมูล");
					f.TIME_LEAVEAFTER_HH.focus();
					return false;
				}
				
			}
			
			
						
		form1.command.value='UPDATE';
	}
		
	function call_sort(flag) {
		form1.order_by.value=flag;		
		form1.sort_by.value=flag;
		if(form1.sort_type.value==flag+":asc"){
			form1.sort_type.value=flag+":desc";
		}else{ //desc
			form1.sort_type.value=flag+":asc";
		}		
		form1.command.value='SEARCH';
		form1.submit();
	} // end function call_sort
	
	function ResetData(f){
	
		f.search_name.value="";
		f.search_code.value="";
	
	}
	
	
	function Inint_AJAX() {
        try { return new ActiveXObject("Msxml2.XMLHTTP");  } catch(e) {} //IE
        try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch(e) {} //IE
        try { return new XMLHttpRequest();          } catch(e) {} //Native Javascript
        alert("XMLHttpRequest not supported");
        return null;
     };

     function dochange(idSpanBgn,idSpanEnd) {
          var req = new XMLHttpRequest();  //Inint_AJAX();
          req.onreadystatechange = function () {
               if (req.readyState==4) {
                    if (req.status==200) {

						var res = req.responseText.split("<::>");
						document.getElementById(idSpanBgn).innerHTML=res[0]; //รับค่ากลับมา
						document.getElementById(idSpanEnd).innerHTML=res[1]; //รับค่ากลับมา
						form1.hidP_EXTRATIME_SHOW.value=res[0]; 
						form1.hidP_TIMEOVERLATE_SHOW.value=res[1]; 
						/*#ES#*/
                    }
               }
          };

          	//req.open("GET", "localtion.php?data="+src+"&val="+val); 
			//สร้าง connection
          var url = 'php_scripts/es_AjTimes.php';
          req.open("GET", url+'?hh='+form1.WC_START_HH.value
		  +'&mm='+form1.WC_START_II.value
		  +'&mmPlusBgn='+form1.TMP_P_EXTRATIME.value+'&mmPlusEnd='+form1.TMP_P_TIMEOVERLATE.value);
//          req.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8"); // set Header
          req.setRequestHeader("Content-Type", "application/json;charset=utf8"); // set Header
          req.send(); //ส่งค่า
		  
		 
     }
     //window.onLoad=dochange('pvnName', -1,0);
	 
	 function dochangeSAMEDAY(f) {
         
		var START = f.WC_START_HH.value+''+f.WC_START_II.value;
		var END = f.START_SCAN_HH.value+''+f.START_SCAN_II.value;
		if( parseInt(START) < parseInt(END)){
			document.getElementById('SAMEDAY_STARTSCAN').checked = true;
		}else{
			document.getElementById('SAMEDAY_STARTSCAN').checked = false;
		}
		  
		  
     }
	 
	 
	 
	 function ResetDataSave(f){
	
		f.WC_CODE.value="";
		f.WC_NAME.value="";
		f.WC_START_HH.value="00";
		f.WC_START_II.value="00";
		f.WC_END_HH.value="00";
		f.WC_END_II.value="00";
		document.getElementById('P_EXTRATIME_SHOW').innerHTML="";
		f.hidP_EXTRATIME_SHOW.value=""; 
		document.getElementById('P_TIMEOVERLATE_SHOW').innerHTML="";
		f.hidP_TIMEOVERLATE_SHOW.value=""; 
		f.TIME_LEAVEEARLY_HH.value="00";
		f.TIME_LEAVEEARLY_II.value="00";
		f.TIME_LEAVEAFTER_HH.value="00";
		f.TIME_LEAVEAFTER_II.value="00";
		document.getElementById('WC_ACTIVE1').checked = true;
		document.getElementById("err_text").innerHTML ="";
		f.START_SCAN_HH.value="00";
		f.START_SCAN_II.value="00";
		document.getElementById('SAMEDAY_STARTSCAN').checked = false;
		document.getElementById('NEXTDAY_EXIT').checked = false;
		f.END_SCAN_HH.value="00";
		f.END_SCAN_II.value="00";
		document.getElementById('NEXTDAY_ENDSCAN').checked = false;
		document.getElementById('NEXTDAY_ONTIME').checked = false;
		document.getElementById('NEXTDAY_ENDLATETIME').checked = false;
		f.TMP_P_EXTRATIME.value=f.HID_P_EXTRATIME.value;
		f.TMP_P_TIMEOVERLATE.value=f.HID_P_TIMEOVERLATE.value;
		document.getElementById('NEXTDAY_LEAVEEARLY').checked = false;
		document.getElementById('NEXTDAY_LEAVEAFTER').checked = false;
	
	}
	
	function changeChk(){
		var a = new Date();
		a.setHours( form1.WC_END_HH.value);
		a.setMinutes( form1.WC_END_II.value);
		a.setSeconds( 0 );
		var time_a = a.getTime();
		
		var b = new Date();
		b.setHours( form1.WC_START_HH.value );
		b.setMinutes( form1.WC_START_II.value );
		b.setSeconds( 0 );
		var time_b = b.getTime();
		var time_left = time_a - time_b;
		time_left /= 1000;
		time_left /= 60;
		time_left /= 60;
		
		/*if(form1.TMP_P_FULLTIME.value>time_left) {
			 
				alert("เวลาเข้า-ออกที่ระบุ เมื่อรวมกันแล้วต้องไม่น้อยกว่า จำนวนชั่วโมงทำงาน "+form1.TMP_P_FULLTIME.value+" (ชม.)\nกรุณาตรวจสอบข้อมูล");
				form1.WC_END_HH.focus();
				return false;
		}*/
	}
</script>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
	<tr>
    	<td height="10"><? include("header_menu.html");?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE=" &gt; ดูข้อมูล";
		include("current_location.html");
?>
	  </td>
	</tr>
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="master_table_workcycle.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page;?>">
          <input type="hidden" name="total_page" value="<?=$total_page;?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0;?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1;?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2;?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3;?>">
          <input type="hidden" name="command" value="">
&nbsp;
<table width="95%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
  	  <td width="22%"><table width="100%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
  	    <tr>
  	      <td height="22" align="center" class="table_body_3"><a href="#" style="text-decoration: none">กำหนดรอบตามเวลาเข้า-ออก</a></td>
	      </tr>
	    </table></td>
	  <td width="82%"><table width="32%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body"><a href="es_master_table_workcycle.html?MENU_ID_LV0=<?=$MENU_ID_LV0;?>&MENU_ID_LV1=<?=$MENU_ID_LV1;?>&MENU_ID_LV2=<?=$MENU_ID_LV2;?>" style="text-decoration: none">กำหนดรอบตามจำนวนชั่วโมง</a></td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
  <table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
    <tr>
      <td><table width="100%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
                <tr> 
                  <td colspan="4" height="5"></td>
                </tr>
                <tr> 
                  <td width="25%" align="right"><span class="label_alert">*</span>&nbsp;รหัส&nbsp;:&nbsp;</td>
                  <td width="22%"><input type="text" name="WC_CODE" value="<?=$WC_CODE;?>" style="width:35%" class="textbox" <?=($UPD)?"readonly":"";?>>&nbsp;&nbsp;<span class="label_alert" id="err_text"><?=$err_text;?></span></td>
                  <td width="20%" align="right">จำนวนชั่วโมงทำงาน (ชม.)&nbsp;:&nbsp;</td>
                  <td width="33%"><font color="663300">
                  <? 
                        $cmd = " SELECT CONFIG_VALUE FROM SYSTEM_CONFIG  where config_name = 'P_FULLTIME' ";
                        $db_dpis->send_cmd($cmd);
                        $data = $db_dpis->get_array();
                        $TMP_P_FULLTIME = $data[CONFIG_VALUE];
                        echo $TMP_P_FULLTIME;
                  ?>
                  </font>
                  <input type="hidden" name="TMP_P_FULLTIME" value="<?=$TMP_P_FULLTIME;?>">
                  </td>
                </tr>
                <tr> 
                  <td align="right"><span class="label_alert">*</span>&nbsp;ชื่อรอบ&nbsp;:&nbsp;</td>
                  <td ><input type="text" name="WC_NAME" value="<?=$WC_NAME;?>" style="width:99%" class="textbox">
                  <input type="hidden" name="hidWC_NAME" value="<?=$WC_NAME;?>"></td>
                  <td align="right" >เช้า (ชม.)&nbsp;:&nbsp;</td>
                  <td ><font color="663300">
                  <? 
                        $cmd = " SELECT CONFIG_VALUE FROM SYSTEM_CONFIG  where config_name = 'P_PARTTIME_AM' ";
                        $db_dpis->send_cmd($cmd);
                        $data = $db_dpis->get_array();
                        $TMP_P_PARTTIME_AM = $data[CONFIG_VALUE];
                        echo $TMP_P_PARTTIME_AM;
                  ?>
                  </font>
                  <input type="hidden" name="TMP_P_PARTTIME_AM" value="<?=$TMP_P_PARTTIME_AM;?>">
                  
                  &nbsp;&nbsp;&nbsp;
                  บ่าย (ชม.)&nbsp;:&nbsp;
                  
                  <font color="663300">
                  <? 
                        $cmd = " SELECT CONFIG_VALUE FROM SYSTEM_CONFIG  where config_name = 'P_PARTTIME_PM' ";
                        $db_dpis->send_cmd($cmd);
                        $data = $db_dpis->get_array();
                        $TMP_P_PARTTIME_PM = $data[CONFIG_VALUE];
                        echo $TMP_P_PARTTIME_PM;
                  ?>
                  </font>
                  <input type="hidden" name="TMP_P_PARTTIME_PM" value="<?=$TMP_P_PARTTIME_PM;?>">
                  </td>
                </tr>
                <tr>
                  <td colspan="4" align="right"><hr size='1'></td>
                </tr>
                <tr>
                  <td align="right">กรณีปกติ (ทำงานเต็มวัน)&nbsp;</td>
                  <td>&nbsp;</td>
                  <td align="right">&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td align="right"><span class="label_alert">*</span> เวลาเข้า&nbsp;:&nbsp;</td>
                  <td colspan="3">
                  <table width="100%" cellpadding="0" cellspacing="0" border="0" class="label_normal">
		  <tr>
		    <td width="29%" align="left"><select name="WC_START_HH" onChange="return dochange('P_EXTRATIME_SHOW','P_TIMEOVERLATE_SHOW');">
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$WC_START_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    :
                    <select name="WC_START_II" onChange="return dochange('P_EXTRATIME_SHOW','P_TIMEOVERLATE_SHOW');">
                      <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$WC_START_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    น.</td>
		    <td width="19%" align="right">สแกนได้ตั้งแต่เวลา&nbsp;:&nbsp;</td>
		  	<td width="52%" align="left"><select name="START_SCAN_HH" id="START_SCAN_HH" onChange="return dochangeSAMEDAY(form1);">
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$START_SCAN_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    :
  <select name="START_SCAN_II" id="START_SCAN_II" onChange="return dochangeSAMEDAY(form1);">
    <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
    <option value="<?=$ii;?>" <? if($ii==$START_SCAN_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
    <? } ?>
  </select>
                  น.  
                  
                  &nbsp;              
                  <input type="checkbox" name="SAMEDAY_STARTSCAN" id="SAMEDAY_STARTSCAN" value="1"<? if($SAMEDAY_STARTSCAN==1){ echo 'checked';}?>>
                    ของวันก่อนหน้า
                    </td>
		  </tr>		
	  </table>
                  
                    
                    
                    </td>
                </tr>
                <tr>
                  <td align="right"><span class="label_alert">*</span> เวลาออก&nbsp;:&nbsp;</td>
                  <td colspan="3">
                  <table width="100%" cellpadding="0" cellspacing="0" border="0" class="label_normal">
		  <tr>
		    <td width="29%" align="left"><select name="WC_END_HH" id="WC_END_HH" onChange="return changeChk();">
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$WC_END_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    :
                    <select name="WC_END_II" id="WC_END_II" onChange="return changeChk();">
                      <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$WC_END_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    น.
                    &nbsp;&nbsp;
                    <input type="checkbox" name="NEXTDAY_EXIT" id="NEXTDAY_EXIT" value="1"<? if($NEXTDAY_EXIT==1){ echo 'checked';}?>> 
                    ของวันถัดไป</td>
		    <td width="19%" align="right">ห้ามสแกนหลังเวลา&nbsp;:&nbsp;</td>
		  	<td width="52%" align="left">
            
                    
                    <select name="END_SCAN_HH" >
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                      <option value="<?=$ii;?>" <? if($ii==$END_SCAN_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
                    </select>
                    :
  <select name="END_SCAN_II">
    <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
    <option value="<?=$ii;?>" <? if($ii==$END_SCAN_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
    <? } ?>
  </select>
                  น.      
                  &nbsp;              
                  <input type="checkbox" name="NEXTDAY_ENDSCAN" id="NEXTDAY_ENDSCAN" value="1"<? if($NEXTDAY_ENDSCAN==1){ echo 'checked';}?>>
                    ของวันถัดไป
                    </td>
		  </tr>		
	  </table>
                              </td>
                </tr>
                <tr>
                      <td align="right">เวลาเพิ่มพิเศษ (นาที)&nbsp;:&nbsp;</td>
                      <td><? 
                        $cmd = " SELECT CONFIG_VALUE FROM SYSTEM_CONFIG  where config_name = 'P_EXTRATIME' ";
                        $db_dpis->send_cmd($cmd);
                        $data = $db_dpis->get_array();
                        $TMP_P_EXTRATIME = $data[CONFIG_VALUE];
                  ?>
                 
                  <input type="text" name="TMP_P_EXTRATIME" value="<? if($UPD){ echo $MIN_ONTIME;}else{ echo $TMP_P_EXTRATIME;}?>" style="width:20%" class="textbox" maxlength="4" onKeyPress="return DigitOnly();" onChange="return dochange('P_EXTRATIME_SHOW','P_TIMEOVERLATE_SHOW');">
                  <input type="hidden" name="HID_P_EXTRATIME" value="<?=$TMP_P_EXTRATIME;?>"></td>
                      <td align="right">กำหนดเวลาสาย (นาที)&nbsp;:&nbsp;</td>
                      <td><? 
                        $cmd = " SELECT CONFIG_VALUE FROM SYSTEM_CONFIG  where config_name = 'P_TIMEOVERLATE' ";
                        $db_dpis->send_cmd($cmd);
                        $data = $db_dpis->get_array();
                        $TMP_P_TIMEOVERLATE = $data[CONFIG_VALUE];

                  ?>
                  <input type="text" name="TMP_P_TIMEOVERLATE" value="<? if($UPD){ echo $MIN_ENDLATETIME;}else{ echo $TMP_P_TIMEOVERLATE;}?>" style="width:20%" maxlength="4" class="textbox" onKeyPress="return DigitOnly();" onChange="return dochange('P_EXTRATIME_SHOW','P_TIMEOVERLATE_SHOW');">
                  <input type="hidden" name="HID_P_TIMEOVERLATE" value="<?=$TMP_P_TIMEOVERLATE;?>"></td>
                 </tr>
                <tr>
                  <td align="right">เวลาที่ไม่ถือว่ามาสาย&nbsp;:&nbsp;</td>
                  <td><font color="663300">
                  			<span id="P_EXTRATIME_SHOW" ><?=$P_EXTRATIME_SHOW;?></span> น.
                            
                            <input type="hidden" name="hidP_EXTRATIME_SHOW" value="<?=$P_EXTRATIME_SHOW;?>">
                  </font>
                  &nbsp;&nbsp;
                    <input type="checkbox" name="NEXTDAY_ONTIME" id="NEXTDAY_ONTIME" value="1"<? if($NEXTDAY_ONTIME==1){ echo 'checked';}?>> 
                    ของวันถัดไป
                  </td>
                  <td align="right">เวลาสิ้นสุดที่ถือว่ามาสาย&nbsp;:&nbsp;</td>
                  <td>
                  
                  <font color="663300">
		                  <span id="P_TIMEOVERLATE_SHOW"><?=$P_TIMEOVERLATE_SHOW;?></span> น.
                    <input type="hidden" name="hidP_TIMEOVERLATE_SHOW" value="<?=$P_TIMEOVERLATE_SHOW;?>">
                  </font>
                  &nbsp;&nbsp;
                    <input type="checkbox" name="NEXTDAY_ENDLATETIME" id="NEXTDAY_ENDLATETIME" value="1"<? if($NEXTDAY_ENDLATETIME==1){ echo 'checked';}?>> 
                    ของวันถัดไป
                  </td>
                </tr>
                
                
                <? if ($UPD) {  ?>
                    
                    <tr>
                      <td align="right">&nbsp;</td>
                      <td colspan="3"><font color="0000FF">
                                        &nbsp;* ลงเวลาได้ถึง <span id="P_EXTRATIME_SHOW1" ><?=$P_EXTRATIME_SHOW;?></span> น. ไม่ถือว่ามาสาย<br/>
                                        &nbsp;* ลงเวลาตั้งแต่ <span id="P_EXTRATIME_SHOW2" ><?=$P_EXTRATIME_SHOW2;?></span>  <span id="P_TIMEOVERLATE_SHOW1" ><?=$P_TIMEOVERLATE_SHOW;?></span> น. ถือว่ามาสาย<br/>
                                        &nbsp;* ลงเวลาหลังจาก <span id="P_TIMEOVERLATE_SHOW2" ><?=$P_TIMEOVERLATE_SHOW;?></span> หากไม่มีการลาเช้า ถือว่าขาดราชการ
                             </font>
                        </td>
                    </tr>
                  <? } ?>
                
                <tr>
                  <td colspan="4" align="right"><hr size='1'></td>
                </tr>
                <tr>
                  <td align="right" valign="top">กรณีลาครึ่งวันแรก&nbsp;&nbsp; <br>ลงเวลาเข้างานได้ไม่เกิน&nbsp;:&nbsp;</td>
                  <td valign="bottom">
                  <select name="TIME_LEAVEEARLY_HH" >
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                        <option value="<?=$ii;?>" <? if($ii==$TIME_LEAVEEARLY_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
			 	  </select>
           			 :
            		<select name="TIME_LEAVEEARLY_II" >
                      <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                        <option value="<?=$ii;?>" <? if($ii==$TIME_LEAVEEARLY_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
			 		</select>
             		น.
                    &nbsp;&nbsp;
                    <input type="checkbox" name="NEXTDAY_LEAVEEARLY" id="NEXTDAY_LEAVEEARLY" value="1"<? if($NEXTDAY_LEAVEEARLY==1){ echo 'checked';}?>> 
                    ของวันถัดไป
                      </td>
                  <td align="right" valign="top">กรณีลาครึ่งวันหลัง&nbsp;&nbsp; <br>ลงเวลาออกได้หลังเวลา&nbsp;:&nbsp;</td>
                  <td valign="bottom">
                  <select name="TIME_LEAVEAFTER_HH" >
                      <?
                      for($i=0; $i<24; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                        <option value="<?=$ii;?>" <? if($ii==$TIME_LEAVEAFTER_HH){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
			 	  </select>
           			 :
            		<select name="TIME_LEAVEAFTER_II" >
                      <?
                      for($i=0; $i<60; $i++){
                            $ii = substr("0".$i,-2,2);
                      ?>
                        <option value="<?=$ii;?>" <? if($ii==$TIME_LEAVEAFTER_II){ echo 'selected';}?>>&nbsp;<?=$ii;?></option>
                      <? } ?>
			 		</select>
             น.
             
             (เป็นต้นไป)
             &nbsp;&nbsp;
                    <input type="checkbox" name="NEXTDAY_LEAVEAFTER" id="NEXTDAY_LEAVEAFTER" value="1"<? if($NEXTDAY_LEAVEAFTER==1){ echo 'checked';}?>> 
                    ของวันถัดไป
  				</td>
                </tr>
                <!--<tr>
                  <td align="right">&nbsp;</td>
                  <td colspan="3"><font color="0000FF">&nbsp;* กรณีไม่กำหนด หากมีการลาเช้าหรือลาบ่าย ผู้ลาสามารถลงเวลาเข้า-ออกกี่โมงก็ได้
						</font></td>
                </tr>-->
                <tr>
                  <td colspan="4" align="right"><hr size='1'></td>
                </tr>
                <tr> 
                  <td align="right"><?=$ACTIVE_TITLE;?>&nbsp;:&nbsp;</td>
                  <td colspan="3">
                    <input type="radio" name="WC_ACTIVE" id="WC_ACTIVE1" value="1" <?=($WC_ACTIVE==1)?"checked":"";?>>
                    ใช้งาน&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="WC_ACTIVE" id="WC_ACTIVE2" value="0" <?=($WC_ACTIVE==0)?"checked":"";?>>
                  ยกเลิก</td>
                </tr>
                
                <? if ($UPD) {  ?>
            <tr>
              <td align="right"><?=$UPDATE_USER_TITLE;?>&nbsp;:&nbsp;</td>
              <td colspan="3"><input name="SHOW_UPDATE_USER" type="text" style="width:40%" class="textbox" value="<?=$SHOW_UPDATE_USER;?>" readonly></td>
              </tr>
            <tr>
              <td align="right"><?=$UPDATE_DATE_TITLE;?>&nbsp;:&nbsp;</td>
              <td colspan="3"><input name="SHOW_UPDATE_DATE" type="text" style="width:20%" class="textbox" value="<?=$SHOW_UPDATE_DATE;?>" readonly></td>
              </tr>
            
            <? }?>
            
                <tr> 
                  <td align="right">&nbsp;</td>
                  <td height="30" colspan="3"><? if ($UPD) { 
                    if($PAGE_AUTH["edit"]=="Y"){
			  		if ($BUTTON_DISPLAY==1) { ?>
                    <input name="Submit22" type="submit" class="button" onClick="return checkupdate(form1);" value="  <?=$EDIT_TITLE;?>  ">
                    <? } else { ?>
                    <input name="image" type="image" onClick="return checkupdate(form1);" src="images/save.png" alt="<?=$EDIT_TITLE;?>" border="0">
                    <?}?>
                    <?}
		  		if ($BUTTON_DISPLAY==1) { ?>
                    <input type="submit" name="Reset2" value="  <?=$CANCEL_TITLE;?>  " onClick="form1.command.value='CANCEL'" class="button" >
                    <? } else { ?>
                    <input name="image" type="image" onClick="form1.command.value='CANCEL'" src="images/cancel.gif" alt="<?=$CANCEL_TITLE;?>" border="0">
                    <?}?>
                    <? } else { 
                    if($PAGE_AUTH["add"]=="Y"){
			  		if ($BUTTON_DISPLAY==1) { ?>
                    <input name="Submit2" type="submit" class="button" onClick="return checkadd(form1);" value=" <?=$ADD_TITLE;?> ">
                    <? } else { ?>
                    <input name="image" type="image" onClick="return checkadd(form1);" src="images/save.png" alt="<?=$ADD_TITLE;?>" border="0">
                    <?}?>
                    <?}
			  	if ($BUTTON_DISPLAY==1) { ?>
                    <input name="Reset2" type="button" onClick="return ResetDataSave(form1);" class="button" value=" <?=$CLEAR_TITLE;?> ">
                    <? } else { ?>
                    <img src="images/default.jpg" alt="<?=$CLEAR_TITLE;?>" width="32" height="32" border="0" onClick="return ResetDataSave(form1);">&nbsp;
<?}?>
                  <?}?></td>
                </tr>
            </table></td>
    </tr>
  </table>
  <?
	if(!$sort_by) $sort_by=1;
	$sort_type = (isset($sort_type))?  $sort_type : "1:asc";
	$arrSort=explode(":",$sort_type);
	$SortType[$arrSort[0]]	=$arrSort[1];
	if(!$order_by) $order_by=1;
  	if(trim($search_code)) $arr_search_condition[] = "(a.WC_CODE like '$search_code%')";
  	if(trim($search_name)) $arr_search_condition[] = "(a.WC_NAME like '%$search_name%')";
	$search_condition = "";
	if(count($arr_search_condition)) $search_condition = " and " . implode(" and ", $arr_search_condition);
  	if($order_by==1){	//
		$order_str = "a.WC_SEQ_NO ".$SortType[$order_by].", a.WC_CODE ".$SortType[$order_by];
    }elseif($order_by==2){	//รหัส
		$order_str = "a.WC_CODE ".$SortType[$order_by];
  	}elseif($order_by==3) {	//รอบ
		$order_str = "a.WC_NAME ".$SortType[$order_by];
  	} elseif($order_by==4) { //เวลาเข้า
		$order_str = "a.WC_START ".$SortType[$order_by];
	} elseif($order_by==5) { //เวลาออก
		$order_str = "a.WC_END ".$SortType[$order_by];
	}
	//------------------------------------------------------------------------------------------------------//

	$cmd =" select count(a.WC_CODE) as count_data from PER_WORK_CYCLE a WHERE a.WORKCYCLE_TYPE=1 $search_condition ";
	$db_dpis->send_cmd($cmd);
//	$db_dpis->show_error();
	$data = $db_dpis->get_array();
	$data = array_change_key_case($data, CASE_LOWER);
	$count_data = $data[count_data];	
//	echo "$count_data";
  ?>
  <table width="95%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="15%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body"><?=$SEARCH_TITLE;?></td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
  <table width="95%" align="center"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td align="center" class="input_table"><table width="100%"  border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr>
              <td width="24%" align="right">รหัส&nbsp;:&nbsp;</td>
              <td width="15%"><input type="text" name="search_code" value="<?=$search_code;?>" style="width:64%" class="textbox"></td>
              <td width="19%" align="right">ชื่อรอบ&nbsp;:&nbsp;</td>
              <td width="42%"><input type="text" name="search_name" value="<?=$search_name;?>" style="width:60%" class="textbox" ></td>
			  </tr>
			  <tr>
              <td height="30">&nbsp;</td>
              <td height="30">&nbsp;</td>
              <td height="30" colspan="2" ><? if ($BUTTON_DISPLAY==1) { ?>
                <input name="Submit3" type="submit" class="button" value="<?=$SEARCH_TITLE;?>" onClick="form1.current_page.value=0;">
                <input name="Submit4" type="submit" class="button" value="<?=$SHOW_ALL_TITLE;?>" onClick="return ResetData(form1); form1.current_page.value=0;">
                
                <? } else { ?>
                <input name="image2" type="image" onClick="javascript:form1.current_page.value=0;" src="images/search.png" alt="<?=$SEARCH_TITLE;?>">
                <input name="image23" type="image" onClick="return ResetData(form1); form1.current_page.value=0;" src="images/showall.png" alt="<?=$SHOW_ALL_TITLE;?>">
                
                
                <?}?></td>
              </tr>
          </table></td>
        </tr>
		<tr>
		  <td>
<table width="95%" border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td><input type="hidden" name="order_by" value="<?=$order_by;?>"><input type="hidden" name="sort_by" value="<?=$sort_by;?>">
<input type="hidden" name="sort_type" value="<?=$sort_type;?>">
<?=$SORT_TITLE;?></td>
</tr>
</table>
		  <table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_body_3">
            <tr>
              <td width="26%" height="22"><? if($PAGE_AUTH["print"]=="Y"){ ?>
                <? if ($BUTTON_DISPLAY==1) { ?>
                <input name="btn_report" type="button" class="button" style="width:150" value="<?=$PDF_TITLE;?>" onClick="call_rtf_pdf_report(0);">   
				        <? if ($RTF_FLAG==1) { ?>
                <input name="btn21" type="button" class="button" style="width:150" value="<?=$RTF_TITLE;?>" onClick="call_rtf_pdf_report(1);">    
	                   <? } ?>
                <?  } else { ?>
                <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$PDF_TITLE;?>" onClick="call_rtf_pdf_report(0);">   
				         <? if ($RTF_FLAG==1) { ?>
               <img src="images/doc_icon_word.jpg" border="0" alt="<?=$RTF_TITLE;?>" onClick="call_rtf_pdf_report(1);">    
	                   <? } ?>
                <? } ?>                <? }else{ echo "&nbsp;"; } ?></td>
              <td width="59%" align="center">พบข้อมูล <?=$MENU_TITLE_LV1;?> ทั้งสิ้น <?=($count_data + 0);?> รายการ</td>
              <td width="15%" align="right"><? if($PAGE_AUTH["print"]=="Y"){ ?>
                <? if ($BUTTON_DISPLAY==1) { ?>
                <input name="btn_export" type="button" class="button" style="width:130" value="<?=$EXCEL_TITLE;?>" onClick="call_export_file();">
                <?  } else { ?>
                <img src="images/doc_icon_excel.jpg" border="0" alt="<?=$EXCEL_TITLE;?>" onClick="call_export_file();">
                <? } ?>                <? }else{ echo "&nbsp;"; } ?></td>
            </tr>
          </table></td>
		</tr>
  </table>  
  <?

  
	$total_page = ceil( $count_data / $data_per_page );
	$page_link = create_link_page($total_page, $current_page);
	$limit_data = "";
/* การแสดงข้อมูล จะต้องวิ่งไปดูว่าได้ทำยื่นคำร้องรับรองการมาปฏิบัติงาน*/
	if($DPISDB=="oci8"){
    	if($current_page > 1){	
			$limit_data = " and a.WC_CODE not in ( select * from (select WC_CODE from PER_WORK_CYCLE $search_condition order by WC_CODE) where rownum <= $start_record ) ";
		} // end if 
		$cmd = "	select		*
							from (
								select		a.WC_CODE, a.WC_NAME, a.WC_START, a.WC_END, a.WC_ACTIVE,
                                a.WC_SEQ_NO,a.TIME_LEAVEEARLY,a.TIME_LEAVEAFTER,a.ON_TIME,
                                a.END_LATETIME
								from 		PER_WORK_CYCLE a
												WHERE a.WORKCYCLE_TYPE = 1 
                                                $search_condition
												$limit_data
								order by 	$order_str
							) where rownum <= $data_per_page ";
	} // end if
	
	//echo $cmd;
	$count_page_data = $db_dpis->send_cmd($cmd);
//	$db_dpis->show_error();
//	echo $cmd;
	if ($count_page_data) {
		$current_list = "";
		$data_count = 0;
?>
  <table width="95%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
    <tr align="center" class="table_head">
      <td  width="5%" onClick="call_sort(1);"><? if($order_by==1&&$sort_by==1){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?><?=$SEQ_NO_TITLE;?></td>
      <td  width="8%" height="21" onClick="call_sort(2);"><strong><? if($order_by==2&&$sort_by==2){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>รหัส</strong></td>
      <td  width="21%" onClick="call_sort(3);"><strong><? if($order_by==3&&$sort_by==3){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>ชื่อรอบ</strong></td>
      <td  align="center" width="8%" onClick="call_sort(4);"><? if($order_by==4&&$sort_by==4){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>เวลาเข้า</td>
      <td  align="center" width="8%" onClick="call_sort(5);"><? if($order_by==5&&$sort_by==5){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>เวลาออก</td>
      <td  align="center" width="8%">เวลาที่ไม่สาย</td>
      <td  align="center" width="8%">สิ้นสุดเวลาสาย</td>
      <td  align="center" width="8%">เวลาเข้า<br>(กรณีลา<br>ครึ่งวันแรก)</td>
      <td  align="center" width="8%">เวลาออก<br>(กรณีลา<br>ครึ่งวันหลัง)</td>
      <?if($PAGE_AUTH["edit"]=="Y"){?>
      <td width="5%"><?=$EDIT_TITLE;?></td>
      <?}?>
      <?if($PAGE_AUTH["del"]=="Y"){?>
      <td width="5%"><?=$DEL_TITLE;?></td>
      <?}?>
      <td  width="8%"><strong><?=$ACTIVE_TITLE;?></strong></td>
    </tr>
    <?
	while ($data = $db_dpis->get_array()) {
		$data_count++;
		if($data_count > $data_per_page) break;
		$DATA_WC_CODE = $data[WC_CODE];
		$current_list .= ((trim($current_list))?", ":"") . "'" . $DATA_WC_CODE ."'";
		$DATA_WC_NAME = $data[WC_NAME];
		$DATA_WC_ACTIVE = $data[WC_ACTIVE];
        $DATA_WC_SEQ_NO = $data[WC_SEQ_NO];
        
        $DATA_WC_START ="";
       // if($data[WC_START] != "0000"){
        	$DATA_WC_START = substr($data[WC_START],0,2).":".substr($data[WC_START],2,2)." น.";
        //}
        
        $DATA_WC_END ="";
       // if($data[WC_END] != "0000"){
        	$DATA_WC_END = substr($data[WC_END],0,2).":".substr($data[WC_END],2,2)." น.";
       // }
        
        $DATA_TIME_LEAVEEARLY ="";
        if($data[TIME_LEAVEEARLY] != "0000"){
        	$DATA_TIME_LEAVEEARLY = substr($data[TIME_LEAVEEARLY],0,2).":".substr($data[TIME_LEAVEEARLY],2,2)." น.";
        }
        
        $DATA_TIME_LEAVEAFTER ="";
        if($data[TIME_LEAVEEARLY] != "0000"){
        	$DATA_TIME_LEAVEAFTER = substr($data[TIME_LEAVEAFTER],0,2).":".substr($data[TIME_LEAVEAFTER],2,2)." น.";
        }
        
		$DATA_P_EXTRATIME_SHOW ="";
        if($data[ON_TIME]){
        	$DATA_P_EXTRATIME_SHOW = substr($data[ON_TIME],0,2).':'.substr($data[ON_TIME],2,2)." น.";
        }
		
        $DATA_P_TIMEOVERLATE_SHOW = "";
        if($data[END_LATETIME]){
        	$DATA_P_TIMEOVERLATE_SHOW = substr($data[END_LATETIME],0,2).':'.substr($data[END_LATETIME],2,2)." น.";
        }
        
?>
            <tr class="table_body"  onMouseOver="this.className='table_body_over';" onMouseOut="this.className='table_body';" >
              <td align="center"><input name="ARR_ORDER[<?=$DATA_WC_CODE;?>]" type="text" size="5" maxlength="3" value="<?=($DATA_WC_SEQ_NO > 0)?$DATA_WC_SEQ_NO:"";?>" style="text-align:right" onKeyPress="return NumOnly();" class="TextBox"></td>
                 
              <td align="center"><?=$DATA_WC_CODE;?></td>
              <td >&nbsp;<?=$DATA_WC_NAME;?></td>
              <td align="center"><?=$DATA_WC_START;?></td>
              <td align="center"><?=$DATA_WC_END;?></td>
              <td align="center"><?=$DATA_P_EXTRATIME_SHOW;?></td>
              <td align="center"><?=$DATA_P_TIMEOVERLATE_SHOW;?></td>
              <td align="center"><?=$DATA_TIME_LEAVEEARLY;?></td>
              <td align="center"><?=$DATA_TIME_LEAVEAFTER;?></td>
              <?if($PAGE_AUTH["edit"]=="Y"){?>
              		<td align="center">&nbsp;<a href="<?=("javascript:form1.action+='?UPD=1';form1.WC_CODE.value='".$DATA_WC_CODE."';form1.submit()");?>"><img src="images/b_edit.png" border="0" alt="แก้ไขข้อมูล"></a></td>
              <?}?>
              <?if($PAGE_AUTH["del"]=="Y"){?>
              		<td align="center">&nbsp;<a href="<?=("javascript:confirm_delete('".$DATA_WC_CODE."','".$DATA_WC_NAME."')");?>"><img src="images/b_drop.png" border="0" alt="ลบข้อมูล"></a></td>
              <?}?>
              <td align="center"><input type="checkbox" name="list_show_id[]" value="'<?=$DATA_WC_CODE;?>'" <?=(($DATA_WC_ACTIVE==1)?"checked":"");?>>
              </td>
            </tr>
    <? } // end while ?>
    
    
	<?if($PAGE_AUTH["edit"]=="Y"){?>
        <tr class="table_footer">
          <td align="center"><? if ($BUTTON_DISPLAY==1) { ?>
                		<input type="submit" name="Submit33" value="<?=$REORDER_TITLE;?>" onClick="form1.command.value='REORDER'" class="button" style="width:98%">
                <?  } else { ?>
                        <center>
                          <input name="image3" type="image" onClick="form1.command.value='REORDER'" src="images/reorder.gif" alt="<?=$REORDER_TITLE;?>" border="0">
                        </center>
                <? } ?></td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>      
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>      
          <td>&nbsp;</td>
          <td align="center">
          <? if ($BUTTON_DISPLAY==1) { ?>
            	<input type="submit" name="Submit42" value="<?=$SETFLAG_TITLE;?>" onClick="form1.command.value='SETFLAG'" class="button" style="width:98%">
          <?  } else { ?>
            	<input name="image32" type="image" onClick="form1.command.value='SETFLAG'" src="images/save.png" alt="<?=$SETFLAG_TITLE;?>" border="0">
          <? } ?></td>
        </tr>
	<?}?>
  </table>
          <? if($total_page > 1) : ?>
          <table width="95%" border="0" align="center" cellpadding="2" cellspacing="2" class="label_normal">
            <tr>
              <td><?=$page_link;?></td>
            </tr>
          </table>
          <? endif; ?>&nbsp;
  
  <? } // if  count show ?>
  			<input type="hidden" name="current_list" value="<?=$current_list;?>">
        </form>	
		</td>
	</tr>
</table>
</body>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
</html>
