<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/structure_by_law.php");
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/>
</head>
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script> 
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript">
	function MM_openBrWindow(theURL,winName,features) { //v2.0
	  window.open(theURL,winName,features);
	}
	
	function confirm_add_save() {
		if (!form1.NEW_ORG_CODE.value || !form1.NEW_ORG_NAME.value ||
			!form1.NEW_OL_CODE.value || !form1.NEW_OT_CODE.value ||
			!form1.NEW_OS_CODE.value || !form1.NEW_CT_CODE.value ) {
			
			alert("กรุณากรอกข้อมูลตามรายการที่มีเครื่องหมาย (*) ให้ครบถ้วนก่อนการบันทึก");
			return false;
		} else {
			form1.command.value='ADD';
			form1.submit();
			return true;
		}
	}

	function confirm_edit_save() {
		if (!form1.ORG_CODE.value || !form1.ORG_NAME.value ||
			!form1.OL_CODE.value || !form1.OT_CODE.value ||
			!form1.OS_CODE.value || !form1.CT_CODE.value ) {
			
			alert("กรุณากรอกข้อมูลตามรายการที่มีเครื่องหมาย (*) ให้ครบถ้วนก่อนการบันทึก");
			return false;
		} else {
			form1.command.value='UPDATE';
			form1.submit(); 
			return true;
		}
	}
	
	function call_more_editor ( fieldname ) {
		var getdate = new Date();
		MM_openBrWindow("maximize_editor.html?formname=form1&fieldname="+fieldname+"&gatedate="+getdate,'moreeditor','toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=550,height=520')
	}
	
	function call_search_org_level (type) {	
		parameter = "";
		childReturn = window.showModalDialog("search_org_level_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.OL_CODE.value = arrValue[0];
				form1.OL_NAME.value = arrValue[1];
			}else{
				form1.NEW_OL_CODE.value = arrValue[0];
				form1.NEW_OL_NAME.value = arrValue[1];
			}
		} // end if
	}
	
	function call_search_org_province (type) {	
		parameter = "";
		childReturn = window.showModalDialog("search_org_province_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.OP_CODE.value = arrValue[0];
				form1.OP_NAME.value = arrValue[1];
			}else{
				form1.NEW_OP_CODE.value = arrValue[0];
				form1.NEW_OP_NAME.value = arrValue[1];
			}
		} // end if
	}
	
	function call_search_org_type (type) {	
		parameter = "";
		childReturn = window.showModalDialog("search_org_type_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.OT_CODE.value = arrValue[0];
				form1.OT_NAME.value = arrValue[1];
			}else{
				form1.NEW_OT_CODE.value = arrValue[0];
				form1.NEW_OT_NAME.value = arrValue[1];
			}
		} // end if
	}
	
	function call_search_org_stat (type) {	
		parameter = "";
		childReturn = window.showModalDialog("search_org_stat_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.OS_CODE.value = arrValue[0];
				form1.OS_NAME.value = arrValue[1];
			}else{
				form1.NEW_OS_CODE.value = arrValue[0];
				form1.NEW_OS_NAME.value = arrValue[1];
			}
		} // end if
	}
	
	function call_search_country (type) {	
		parameter = "";
		childReturn = window.showModalDialog("search_country_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.CT_CODE.value = arrValue[0];
				form1.CT_NAME.value = arrValue[1];
				form1.PV_CODE.value = "";
				form1.PV_NAME.value = "";
				form1.AP_CODE.value = "";
				form1.AP_NAME.value = "";
			}else{
				form1.NEW_CT_CODE.value = arrValue[0];
				form1.NEW_CT_NAME.value = arrValue[1];
				form1.NEW_PV_CODE.value = "";
				form1.NEW_PV_NAME.value = "";
				form1.NEW_AP_CODE.value = "";
				form1.NEW_AP_NAME.value = "";
			}
		} // end if
	}
	
	function call_search_province (type) {	
		if(type==1){
			if(form1.CT_CODE.value != 0){
				parameter = "&CT_CODE=" + form1.CT_CODE.value;
			}else{
				alert("กรุณาเลือกประเทศก่อน");
				form1.btn_country.focus();
				return false;
			}
		}else{
			if(form1.NEW_CT_CODE.value != 0){
				parameter = "&CT_CODE=" + form1.NEW_CT_CODE.value;
			}else{
				alert("กรุณาเลือกประเทศก่อน");
				form1.btn_new_country.focus();
				return false;
			}			
		}
		childReturn = window.showModalDialog("search_province_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.PV_CODE.value = arrValue[0];
				form1.PV_NAME.value = arrValue[1];
				form1.AP_CODE.value = "";
				form1.AP_NAME.value = "";
			}else{
				form1.NEW_PV_CODE.value = arrValue[0];
				form1.NEW_PV_NAME.value = arrValue[1];
				form1.NEW_AP_CODE.value = "";
				form1.NEW_AP_NAME.value = "";
			}
		} // end if
	}
	
	function call_search_amphur (type) {
		if(type==1){
			if(form1.PV_CODE.value != 0){
				parameter = "&PV_CODE=" + form1.PV_CODE.value;
			}else{
				alert("กรุณาเลือกจังหวัดก่อน");
				form1.btn_province.focus();
				return false;
			}
		}else{
			if(form1.NEW_PV_CODE.value != 0){
				parameter = "&PV_CODE=" + form1.NEW_PV_CODE.value;
			}else{
				alert("กรุณาเลือกจังหวัดก่อน");
				form1.btn_new_province.focus();
				return false;
			}
		}
		childReturn = window.showModalDialog("search_amphur_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.AP_CODE.value = arrValue[0];
				form1.AP_NAME.value = arrValue[1];
			}else{
				form1.NEW_AP_CODE.value = arrValue[0];
				form1.NEW_AP_NAME.value = arrValue[1];
			}
		} // end if
	}

<!-- function สำหรับเรียกหน้าต่าง แผนที่ google เพื่อกำหนดตำแหน่ง latitude longtitude เพิ่ม โดยพงษ์ศักดิ์ 22/11/2552-->
	function call_map_position(type) {
		if(type==1){
			parameter = "&ORG_NAME=" + form1.ORG_NAME.value;
			parameter = parameter + "&PV_NAME=" + form1.PV_NAME.value;
			parameter = parameter + "&AP_NAME=" + form1.AP_NAME.value;
			parameter = parameter + "&CT_NAME=" + form1.CT_NAME.value;
			parameter = parameter + "&POS_LAT=" + form1.POS_LAT.value;
			parameter = parameter + "&POS_LONG=" + form1.POS_LONG.value;
		}else{
			parameter = "&ORG_NAME=" + form1.NEW_ORG_NAME.value;
			parameter = parameter + "&PV_NAME=" + form1.NEW_PV_NAME.value;
			parameter = parameter + "&AP_NAME=" + form1.NEW_AP_NAME.value;
			parameter = parameter + "&CT_NAME=" + form1.NEW_CT_NAME.value;
			parameter = parameter + "&POS_LAT=" + form1.NEW_POS_LAT.value;
			parameter = parameter + "&POS_LONG=" + form1.NEW_POS_LONG.value;
		}
		childReturn = window.showModalDialog("google_map_position_frame.html?type="+type+parameter,"","dialogHeight: 600px; dialogWidth: 800px; status: No; resizable: No; help: No; statusbar: No;");
		if(childReturn){
			arrValue = childReturn.split("<::>");
			if(type==1){
				form1.POS_LAT.value = arrValue[0];
				form1.POS_LONG.value = arrValue[1];
			}else{
				form1.NEW_POS_LAT.value = arrValue[0];
				form1.NEW_POS_LONG.value = arrValue[1];
			}
		} // end if
	}
    <!-- จบ function google map -->	
	
	function select_org(org_id, org_id_ref){
		form1.ORG_ID.value = org_id;
		form1.ORG_ID_REF.value = org_id_ref;
		form1.submit();
	}
	
	function add_opened_org(opened_org_id, thispage, org_parent_id) {
		opened_org = form1.LIST_OPENED_ORG.value;
		// แก้ไข เมื่อ 29/12/2009 พงษ์ศักดิ์ เพิ่มข้อมูลหน้าสำหรับกรณีการแบ่งหน้า
		if(opened_org==""){
			opened_org = "," + opened_org_id + "." + thispage + "." + org_parent_id + ",";
		}else{
			opened_org += (opened_org_id + "." + thispage + "." + org_parent_id + ",");
		}
		form1.LIST_OPENED_ORG.value = opened_org;  	// เก็บข้อมูลโครงสร้างที่เปิดลำดับอยู่ 
																						// รูปแบบ xx.pp.bb xx=รหัสโครงสร้างที่เปิด  
																							// pp=หน้าที่กำลังเปิด ถ้ามีหน้าเดียว มีค่า 0  bb=รหัสโครงสร้างระดับบน 1 ขั้น
		var arr1 = new Array();
		var arr2 = new Array();
		arr1 = opened_org.split(",");
		var buff = "";
		chk_org = opened_org_id;
		for(i=arr1.length-1; i >= 0; i--) {
			arr2 = arr1[i].split(".");
			if (arr2[0] == chk_org) {
				buff = buff + arr2[0] + ",";
				chk_org = arr2[2];
			}
		}
		form1.ADD_FLAG.value = buff;	// เก็บลำดับของข้อมูลโครงสร้าง ชุดที่กำลังสนใจอยู่ เรียงจากล่างไปบน
		form1.ORG_SEARCH.value = "";
//		alert("add"+opened_org);
	//	alert(form1.LIST_OPENED_ORG.value);
	//	form1.ORG_ID.value = opened_org_id;
	//	form1.ORG_ID_REF.value = "";
		form1.submit();
	}

	function refresh_opened_org(opened_org_id, thispage){
		opened_org = form1.LIST_OPENED_ORG.value;
		if(opened_org==""){
			opened_org = "";
		}else{
			search_str = "," + opened_org_id + ".";
			pos = opened_org.indexOf(search_str);
			pos2 = opened_org.indexOf(".",pos+search_str.length+1); // search for . after thispage
			opened_org = opened_org.substring(0, pos+search_str.length) + thispage + opened_org.substring(pos2, opened_org.length);
			if(opened_org=="," || opened_org==",,") opened_org = "";
		}
//		alert("refresh"+opened_org);
		form1.LIST_OPENED_ORG.value = opened_org;	
		form1.ORG_SEARCH.value = "";
	//	alert(form1.LIST_OPENED_ORG.value);
	//	form1.ORG_ID.value = form1.ORG_ID_REF.value;
	//	form1.ORG_ID_REF.value = "";
		form1.submit();
	}

	function search_org(search_org_id){
		search_org = form1.ORG_SEARCH.value;
		search_text = form1.stext.value;
		if(search_org==""){
			search_org = "";
		}else{
			if (search_text.length > 0) {
				search_org = ""+search_org_id+","+search_text;
			}else{
				search_org = "";
			}
		}
//		alert("refresh"+opened_org);
		form1.ORG_SEARCH.value = search_org;	
	//	alert(form1.LIST_OPENED_ORG.value);
	//	form1.ORG_ID.value = form1.ORG_ID_REF.value;
	//	form1.ORG_ID_REF.value = "";
		form1.submit();
	}
	
	function remove_closed_org(closed_org_id){
		opened_org = form1.LIST_OPENED_ORG.value;
		if(opened_org==""){
			opened_org = "";
		}else{
			var arr1 = new Array();
			var arr2 = new Array();
			arr1 = opened_org.split(",");
			var buff = ",";
			for(i=0; i < arr1.length; i++) {
				if (arr1[i].length > 0) {
					arr2 = arr1[i].split(".");
					if (arr2[0] != closed_org_id && arr2[2] != closed_org_id) {
						buff = buff + arr2[0] + "." + arr2[1] + "." + arr2[2] + ",";
					}
				}
			}
			opened_org = buff;
			if(opened_org=="," || opened_org==",,") opened_org = "";
		}
		form1.LIST_OPENED_ORG.value = opened_org;	
		form1.ORG_SEARCH.value = "";
//		alert("remove"+opened_org);
	//	alert(form1.LIST_OPENED_ORG.value);
	//	form1.ORG_ID.value = form1.ORG_ID_REF.value;
	//	form1.ORG_ID_REF.value = "";
		form1.submit();
	}

	function call_change_structure_level () {
		parameter = "&ORG_ID=" + document.form1.ORG_ID.value + "&ORG_ID_REF=" + document.form1.ORG_ID_REF.value;
		childReturn = window.showModalDialog("structure_by_law_parent_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 600px; dialogWidth: 1000px; status: No; resizable: No; help: No; statusbar: No;");
		if(childReturn){ 
//			if(childReturn == "ORG") childReturn = 0;
			arrValue = childReturn.split("<::>");
			if(arrValue[0] != form1.ORG_ID_REF.value){
				form1.NEW_ORG_ID_REF.value = arrValue[0];
				form1.command.value = "CHANGESTRUCTUREPARENT";
				form1.submit();
			}
		} // end if
	}
	
	function call_edit_structure (ORG_ID, ORG_ID_REF, LIST_OPENED_ORG) {
		document.form1.ORG_ID.value = ORG_ID;
		document.form1.ORG_ID_REF.value = ORG_ID_REF;
		document.form1.LIST_OPENED_ORG.value = LIST_OPENED_ORG;
		document.form1.command.value = "";
		document.form1.search_org_name.value = "";
		document.form1.submit();
	}

	function change_current_page( page ){
		document.form1.current_page.value = page;
		document.form1.command.value = "SEARCH_ORG";
		document.form1.submit();
	}
	
</script>
<span id="defaultTheme"></span> 
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE=" &gt; ดูข้อมูล";
		include("current_location.html");
?>
	  </td>
  </tr>
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="structure_by_law.html" enctype="multipart/form-data">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="NEW_ORG_ID_REF">
          <input type="hidden" name="ORG_ID_REF" value="<?=$ORG_ID_REF?>">
          <input type="hidden" name="ORG_ID" value="<?=$ORG_ID?>">
          <input type="hidden" name="LIST_OPENED_ORG" value="<?=$LIST_OPENED_ORG?>">
          <input type="hidden" name="PAGE_ROWS" value="100">
          <input type="hidden" name="PAGE_TABS" value="10">
          <input type="hidden" name="ADD_FLAG" value="">
          <input type="hidden" name="ORG_SEARCH" value="">
  <? if($command != "SEARCH_ORG" || !trim($search_org_name)){ ?>
&nbsp;  
  <table width="95%"  border="0" align="center" cellpadding="0" cellspacing="0">
    <tr>
      <td align="center" valign="top">
          <table width="98%" border="0" align="center" cellpadding="1" cellspacing="1" class="input_table">
		    <tr><td><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td><input type="text" name="search_org_name" value="<?=$search_org_name?>" style="width:98%" class="textbox"><input type="hidden" name="search_ol_code" value="<?=$search_ol_code?>"></td>
                <td width="15%" align="right"><? if ($BUTTON_DISPLAY==1) { ?>
				<input name="SubmitSearch" type="submit" class="button" onClick="if(document.form1.search_org_name.value.trim()){ document.form1.command.value='SEARCH_ORG'; document.form1.search_ol_code.value=''; document.form1.ORG_ID.value=''; document.form1.ORG_ID_REF.value=''; document.form1.LIST_OPENED_ORG.value=''; document.form1.action+='#searchORG'; }else{ alert('ระบุชื่อที่ต้องการค้นหา'); return false; }" value="<?=$SEARCH_TITLE?>"><? } else { ?>
				<input name="image22" type="image" onClick="if(document.form1.search_org_name.value.trim()){ document.form1.command.value='SEARCH_ORG'; document.form1.search_ol_code.value=''; document.form1.ORG_ID.value=''; document.form1.ORG_ID_REF.value=''; document.form1.LIST_OPENED_ORG.value=''; document.form1.action+='#searchORG'; }else{ alert('ระบุชื่อที่ต้องการค้นหา'); return false; }" src="images/search.png" alt="<?=$SEARCH_TITLE?>">
				<?}?>				</td>
              </tr>
            </table></td></tr>
		  </table>
		  <table width="98%" border="0" align="center" cellpadding="1" cellspacing="1" class="table_body">
            <tr><td height="10"></td></tr>
			<tr align="center">
              <td height="25"><table width="98%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
				  <?
//				  		$cmd = " select ORG_NAME from PER_ORG where ORG_ID=$START_ORG_ID and ORG_ID_REF=$START_ORG_ID ";
				  		$cmd = " select ORG_NAME from PER_ORG where ORG_ID=$START_ORG_ID ";
						$db_dpis->send_cmd($cmd);
						$data = $db_dpis->get_array();
						$TMP_ORG_NAME = $data[ORG_NAME];
						
						$class = "table_body";
//						if($ORG_ID==$START_ORG_ID && $ORG_ID_REF==$START_ORG_ID) $class = "table_body_over";
						if($ORG_ID==$START_ORG_ID) $class = "table_body_over";
				  ?>
                  <td height="22" class="<?=$class?>">&nbsp;<span onClick="select_org(<?=$START_ORG_ID?>,<?=$START_ORG_ID?>);" style="cursor:hand;"><?=$TMP_ORG_NAME?></span></td>
                </tr>
                <tr>
                  <td height="22"><? list_tree_org("", $START_ORG_ID, $ORG_ID, 1);//echo "$LIST_OPENED_ORG"; ?></td>
                </tr>
              </table></td>
			</tr>
            <tr><td height="10"></td></tr>
          </table>
	  </td>
      <td width="55%" align="center" valign="top">
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="35%" align="right" height="22"><span class="label_alert">*</span>&nbsp;รหัสส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_CODE" value="<?=$ORG_CODE?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td align="right" height="22">ลำดับส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_SEQ_NO" value="<?=$ORG_SEQ_NO?>" style="width:85%" class="textbox" onKeyPress="DigitOnly();" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ชื่อส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_NAME" value="<?=$ORG_NAME?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right">ชื่อย่อส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_SHORT" value="<?=$ORG_SHORT?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right">ชื่อภาษาอังกฤษ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_ENG_NAME" value="<?=$ORG_ENG_NAME?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ฐานะของหน่วยงาน&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="OL_NAME" value="<?=$OL_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="OL_CODE" value="<?=$OL_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn2" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกฐานะของหน่วยงาน" onClick="call_search_org_level(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OL_NAME.value=''; form1.OL_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">กลุ่มสำนักงานประจำ<?=$PV_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="OP_NAME" value="<?=$OP_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="OP_CODE" value="<?=$OP_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn3" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกกลุ่มสำนักงานประจำจังหวัด" onClick="call_search_org_province(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OP_NAME.value=''; form1.OP_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;สังกัด&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="OT_NAME" value="<?=$OT_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="OT_CODE" value="<?=$OT_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn4" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกสังกัด" onClick="call_search_org_type(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OT_NAME.value=''; form1.OT_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;สถานภาพของหน่วยงาน&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="OS_NAME" value="<?=$OS_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="OS_CODE" value="<?=$OS_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn5" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกสถานภาพของหน่วยงาน" onClick="call_search_org_stat(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OS_NAME.value=''; form1.OS_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">หน้าที่ความรับผิดชอบ&nbsp;:&nbsp;</td>
                  <td><a href="javascript:call_more_editor('ORG_JOB')"><?=$DETAIL_TITLE?></a><iframe id="editor_ORG_JOB" width="70%" height=0 frameborder="0"></iframe><input type="hidden" name="ORG_JOB" value=""></td>
                </tr>
                <tr>
                  <td height="22" align="right">สถานที่ตั้ง&nbsp;:&nbsp;</td>
                  <td><input type="text" name="ORG_ADDR1" value="<?=$ORG_ADDR1?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="text" name="ORG_ADDR2" value="<?=$ORG_ADDR2?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="text" name="ORG_ADDR3" value="<?=$ORG_ADDR3?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;<?=$CT_TITLE ?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="CT_NAME" value="<?=$CT_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="CT_CODE" value="<?=$CT_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn_country" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกประเทศ" onClick="call_search_country(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.AP_NAME.value=''; form1.AP_CODE.value=''; form1.PV_NAME.value=''; form1.PV_CODE.value=''; form1.CT_NAME.value=''; form1.CT_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><?=$PV_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="PV_NAME" value="<?=$PV_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="PV_CODE" value="<?=$PV_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn_province" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกจังหวัด" onClick="call_search_province(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.AP_NAME.value=''; form1.AP_CODE.value=''; form1.PV_NAME.value=''; form1.PV_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><?=$AP_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="AP_NAME" value="<?=$AP_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="AP_CODE" value="<?=$AP_CODE?>">					  </td>
                      <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn_amphur" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกอำเภอ" onClick="call_search_amphur(1);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.AP_NAME.value=''; form1.AP_CODE.value=''; return false;" align="center" alt="ล้างค่า"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">วันที่ประกาศปรับปรุง&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22"><input name="ORG_DATE" type="text" class="textbox" id="ORG_DATE" onBlur="//chk_date(this, 'BDH');" value="<?=show_date($ORG_DATE)?>" style="width:100% "></td>
                      <td width="15%">&nbsp;<input type="reset" class="button" onClick="return showCalendar('ORG_DATE', 'dd/mm/y');" value="<?=$SELECT_TITLE?>"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td  height="22" align="right">เว็บไซต์&nbsp;:&nbsp;</td>
				  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
				  <tr>
				  <!--  ส่งไปกำหนดตำแหน่งใน google map แล้วเก็บค่า latitude longtitude ที่ POS_LAT POS_LONG .... แก้โดยพงษ์ศักดิ์ 22/11/2552 -->
                  <td width="85%" height="22"><input type="text" name="ORG_WEBSITE" value="<?=$ORG_WEBSITE?>" style="width:100%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                  <td width="15%">&nbsp;<? if($SESS_PROVINCE_CODE || ($ORG_ID && $ORG_ID_REF) && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="btn_gmap" class="button" value="แผนที่" alt="กำหนดตำแหน่งบนแผนที่" onClick="call_map_position(1);"><input type="hidden" name="POS_LAT" value="<?=$POS_LAT?>"><input type="hidden" name="POS_LONG" value="<?=$POS_LONG?>"><? endif; ?></td>
				  </tr></table></td>
				  <!-- จบ google map -->
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="radio" name="ORG_ACTIVE" value="1" <?=($ORG_ACTIVE==1)?"checked":""?>>ใช้&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="ORG_ACTIVE" value="0" <?=($ORG_ACTIVE==0)?"checked":""?>>ยกเลิก</td>
                </tr>
				<? if($ORG_ID && $ORG_ID_REF) : ?>
                <tr align="center">
                  <td height="30" colspan="2">
                      <?if($PAGE_AUTH["edit"]=="Y" && $ORG_ID!=1){?>
					  <? if ($BUTTON_DISPLAY==1) { ?>
					  <input name="Submit2" type="button" class="button" onClick="call_change_structure_level();" value="เปลี่ยนระดับโครงสร้าง">
					  <?  } else { ?>
              <img src="images/change.png" alt="เปลี่ยนระดับโครงสร้าง" width="32" height="32" border="0" onClick="call_change_structure_level();" >
              <? } echo "&nbsp; &nbsp;"; ?>
					  <?}?>
					  <?if($PAGE_AUTH["edit"]=="Y"){?>
					  <? if ($BUTTON_DISPLAY==1) { ?>
                      <input name="Submit22" type="submit" class="button" onClick="set_more_editor(); return confirm_edit_save();" value="<?=$EDIT_TITLE?>">
					   <?  } else { ?>
					   <input name="image23" type="image" onClick="set_more_editor(); return confirm_edit_save();" src="images/save.png" alt="<?=$EDIT_TITLE?>">
					   <? } echo "&nbsp; &nbsp;"; ?>
                      <?}?>
                      <?if($PAGE_AUTH["del"]=="Y" && $ORG_ID!=1){?>
					  <?if ($BUTTON_DISPLAY==1) { ?>
                      <input name="Submit22" type="submit" class="button" onClick="if(confirm('ต้องการลบโครงสร้างส่วนราชการนี้ใช่หรือไม่ [<?=$ORG_NAME?>] โครงสร้างลูกที่อยู่ภายใต้โครงสร้างส่วนราชการนี้จะถูกลบไปด้วย?')){ form1.command.value='DELETE'; }else{ return false; }" value="<?=$DEL_TITLE?>"><?  } else { ?>
                      <img src="images/delete.gif" alt="<?=$DEL_TITLE?>" width="32" height="32" border="0" onClick="if(confirm('ต้องการลบโครงสร้างส่วนราชการนี้ใช่หรือไม่ [<?=$ORG_NAME?>] โครงสร้างลูกที่อยู่ภายใต้โครงสร้างส่วนราชการนี้จะถูกลบไปด้วย?')){ form1.command.value='DELETE'; }else{ return false; }">
                      <? } echo "&nbsp; &nbsp;";?>
					  
                      <?}?>                  
			 <?if($PAGE_AUTH["edit"]=="Y" && $ORG_ID!=1){?><? if ($BUTTON_DISPLAY==1) { ?>
			 <input name="Submit2" type="submit" class="button" style="width:200" onClick="if(confirm('ข้อมูลโครงสร้างเก่าทั้งหมดจะถูกลบ  ต้องการคัดลอกโครงสร้างตามมอบหมายงานหรือไม่?')){ form1.command.value='COPY'; }else{ return false; }" value="คัดลอกโครงสร้างตามมอบหมายงาน"><?  } else { ?>
			 <input name="image232" type="image" onClick="if(confirm('ข้อมูลโครงสร้างเก่าทั้งหมดจะถูกลบ  ต้องการคัดลอกโครงสร้างตามมอบหมายงานหรือไม่?')){ form1.command.value='COPY'; }else{ return false; }" src="images/copy.png" alt="คัดลอกโครงสร้างตามมอบหมายงาน">
			 <? } echo "&nbsp; &nbsp;"; ?>
			 <?}?>			 
			 </td>
                </tr>
				<? endif; ?>
            </table></td>
          </tr>
      </table>
	  <? if($ORG_ID_REF && $PAGE_AUTH["add"]=="Y") : ?>
	  &nbsp;
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="35%" align="right" height="22"><span class="label_alert">*</span>&nbsp;รหัสส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_CODE" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right">ลำดับส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_SEQ_NO" value="" style="width:85%" class="textbox" onKeyPress="DigitOnly();"></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ชื่อส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_NAME" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right">ชื่อย่อส่วนราชการ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_SHORT" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right">ชื่อภาษาอังกฤษ&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_ENG_NAME" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ฐานะของหน่วยงาน&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_OL_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_OL_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn6" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกฐานะของหน่วยงาน" onClick="call_search_org_level(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_OL_NAME.value=''; form1.NEW_OL_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">กลุ่มสำนักงานประจำจังหวัด&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_OP_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_OP_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn7" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกกลุ่มสำนักงานประจำจังหวัด" onClick="call_search_org_province(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_OP_NAME.value=''; form1.NEW_OP_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;สังกัด&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_OT_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_OT_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn8" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกสังกัด" onClick="call_search_org_type(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_OT_NAME.value=''; form1.NEW_OT_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;สถานภาพของหน่วยงาน&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_OS_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_OS_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn9" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกสถานภาพของหน่วยงาน" onClick="call_search_org_stat(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_OS_NAME.value=''; form1.NEW_OS_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">หน้าที่ความรับผิดชอบ&nbsp;:&nbsp;</td>
                  <td><a href="javascript:call_more_editor('NEW_ORG_JOB')">รายละเอียด</a><iframe id="editor_NEW_ORG_JOB" width="70%" height=0 frameborder="0"></iframe><input type="hidden" name="NEW_ORG_JOB" value=""></td>
                </tr>
                <tr>
                  <td height="22" align="right">สถานที่ตั้ง&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_ADDR1" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_ADDR2" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="text" name="NEW_ORG_ADDR3" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;<?=$CT_TITLE ?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_CT_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_CT_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn_new_country" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกประเทศ" onClick="call_search_country(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_AP_NAME.value=''; form1.NEW_AP_CODE.value=''; form1.NEW_PV_NAME.value=''; form1.NEW_PV_CODE.value=''; form1.NEW_CT_NAME.value=''; form1.NEW_CT_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><?=$PV_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_PV_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_PV_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn_new_province" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกจังหวัด" onClick="call_search_province(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_AP_NAME.value=''; form1.NEW_AP_CODE.value=''; form1.NEW_PV_NAME.value=''; form1.NEW_PV_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><?=$AP_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_AP_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_AP_CODE" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="btn_new_amphur" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกอำเภอ" onClick="call_search_amphur(2);"><input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.NEW_AP_NAME.value=''; form1.NEW_AP_CODE.value=''; return false;" align="center" alt="ล้างค่า"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">วันที่ประกาศปรับปรุง&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22"><input name="NEW_ORG_DATE" type="text" class="textbox" id="NEW_ORG_DATE" onBlur="//chk_date(this, 'BDH');" value="" style="width:100% "></td>
                      <td width="15%">&nbsp;<input type="reset" class="button" onClick="return showCalendar('NEW_ORG_DATE', 'dd/mm/y');" value="<?=$SELECT_TITLE?>"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td  height="22" align="right">เว็บไซต์&nbsp;:&nbsp;</td>
				  <!--  ส่งไปกำหนดตำแหน่งใน google map แล้วเก็บค่า latitude longtitude ที่ POS_LAT POS_LONG .... แก้โดยพงษ์ศักดิ์ 22/11/2552 -->
				  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
				  <tr>
                  <td width="85%" height="22"><input type="text" name="NEW_ORG_WEBSITE" value="" style="width:100%" class="textbox"></td>
                  <td width="15%">&nbsp;<input type="button" name="btn_newgmap" class="button" value="แผนที่" alt="กำหนดตำแหน่งบนแผนที่" onClick="call_map_position(2);"><input type="hidden" name="NEW_POS_LAT" value=""><input type="hidden" name="NEW_POS_LONG" value=""></td>
				  </tr></table></td>
				  <!--  จบ google map -->
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;</td>
                  <td><input type="radio" name="NEW_ORG_ACTIVE" value="1" checked>ใช้&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" name="NEW_ORG_ACTIVE" value="0">ยกเลิก</td>
                </tr>
                <tr align="center">
                  <td height="30" colspan="2"><? if ($BUTTON_DISPLAY==1) { ?>
                      <input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>"><? } else { ?>
            <img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="32" height="32" border="0" onClick="form1.reset();">&nbsp;
<?}?>
                      <?if($PAGE_AUTH["add"]=="Y"){?><? if ($BUTTON_DISPLAY==1) { ?>
                      <input name="Submit2" type="submit" class="button" onClick="set_more_editor(); return confirm_add_save();" value="<?=$ADD_TITLE?>"><?  } else { ?>
                      <input name="image24" type="image" onClick="set_more_editor(); return confirm_add_save();" src="images/save.png" alt="<?=$ADD_TITLE?>">
                      <? } echo "&nbsp; &nbsp;"; ?>
                      <?}?>                  </td>
                </tr>
            </table></td>
          </tr>
      </table>
	  <? endif; ?>
      </td>
    </tr>
  </table>
  <? 
  	}elseif($command == "SEARCH_ORG" && trim($search_org_name)){ 
		if(!trim($search_ol_code)) $search_ol_code = "01";
  ?>
  <!--a name="searchORG">&nbsp;</a-->&nbsp;
  <table width="95%"  border="0" align="center" cellpadding="0" cellspacing="0">
  	<tr height="25">
	  <td width="150">&nbsp;</td>
	  <td class="input_table"><table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td align="center"><input type="text" name="search_org_name" value="<?=$search_org_name?>" style="width:98%" class="textbox"><input type="hidden" name="search_ol_code" value="<?=$search_ol_code?>"></td>
          <td width="200"><? if ($BUTTON_DISPLAY==1) { ?>
		  	<input name="SubmitSearch" type="submit" class="button" onClick="document.form1.command.value='SEARCH_ORG'; document.form1.action+='#searchORG';" value="<?=$SEARCH_TITLE?>">
			<input name="ClearSearch" type="submit" class="button" onClick="document.form1.search_org_name.value=''; document.form1.command.value=''; document.form1.ORG_ID.value=''; document.form1.ORG_ID_REF.value=''; document.form1.LIST_OPENED_ORG.value='';" value="กลับหน้าโครงสร้าง">
			 <? } else { ?>
                <input name="image2" type="image" onClick="document.form1.command.value='SEARCH_ORG'; document.form1.action+='#searchORG';" src="images/search.png" alt="<?=$SEARCH_TITLE?>">
                <input name="image2" type="image" onClick="document.form1.search_org_name.value=''; document.form1.command.value=''; document.form1.ORG_ID.value=''; document.form1.ORG_ID_REF.value=''; document.form1.LIST_OPENED_ORG.value='';" src="images/back.gif" alt="กลับหน้าโครงสร้าง">
                <?}?>
		  </td>
        </tr>
      </table></td>
	</tr>
  	<tr height="25">
	  <td width="150" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td height="25" align="center" class="<?=(($search_ol_code=="01")?"table_body_over input_table":"table_body")?>"><span onClick="document.form1.search_ol_code.value='01'; document.form1.command.value='SEARCH_ORG'; document.form1.submit();" style="cursor:hand;">กระทรวง</span></td>
        </tr>
        <tr>
          <td height="25" align="center" class="<?=(($search_ol_code=="02")?"table_body_over input_table":"table_body")?>"><span onClick="document.form1.search_ol_code.value='02'; document.form1.command.value='SEARCH_ORG'; document.form1.submit();" style="cursor:hand;">กรม</span></td>
        </tr>
        <tr>
          <td height="25" align="center" class="<?=(($search_ol_code=="03")?"table_body_over input_table":"table_body")?>"><span onClick="document.form1.search_ol_code.value='03'; document.form1.command.value='SEARCH_ORG'; document.form1.submit();" style="cursor:hand;">สำนัก/กอง</span></td>
        </tr>
        <tr>
          <td height="25" align="center" class="<?=(($search_ol_code=="04")?"table_body_over input_table":"table_body")?>"><span onClick="document.form1.search_ol_code.value='04'; document.form1.command.value='SEARCH_ORG'; document.form1.submit();" style="cursor:hand;">ต่ำกว่าสำนัก/กอง 1 ระดับ</span></td>
        </tr>
        <tr>
          <td height="25" align="center" class="<?=(($search_ol_code=="05")?"table_body_over input_table":"table_body")?>"><span onClick="document.form1.search_ol_code.value='05'; document.form1.command.value='SEARCH_ORG'; document.form1.submit();" style="cursor:hand;">ต่ำกว่าสำนัก/กอง 2 ระดับ</span></td>
        </tr>
      </table></td>
	  <?
	  	$cmd = " select			ORG_ID, ORG_ID_REF, ORG_NAME
						 from			PER_ORG
						 where		OL_CODE='$search_ol_code' and ORG_NAME like '%$search_org_name%'
						 order by		ORG_ACTIVE DESC, ORG_SEQ_NO, ORG_CODE
					  ";
		$count_data = $db_dpis->send_cmd($cmd) + 0;

		$total_page = ceil( $count_data / $data_per_page );
		$page_link = create_link_page($total_page, $current_page);
		$limit_data = "";	
	  ?>
      <input type="hidden" name="current_page" value="<?=$current_page?>">
      <input type="hidden" name="total_page" value="<?=$total_page?>">
	  <td align="center" valign="top">
	  <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td height="25" class="table_body_3" align="center">พบโครงสร้างชื่อ &quot;<span class="brown_normal"><?=$search_org_name?></span>&quot; ทั้งหมด <span class="brown_normal"><?=$count_data?></span> รายการ</td>
        </tr>
      </table>
	  <?
		if($DPISDB=="odbc"){
			if($current_page > 1){
			$cmd = " select			top $start_record ORG_ID as concat_pk
							 from			PER_ORG
							 where		OL_CODE='$search_ol_code' and ORG_NAME like '%$search_org_name%'
							 order by		ORG_ACTIVE DESC, ORG_SEQ_NO, ORG_CODE
						   ";
				$db_dpis->send_cmd($cmd);
				while($data = $db_dpis->get_array()) $arr_exclude[] = $data[concat_pk];
				$limit_data = " and ORG_ID not in (". implode(", ", $arr_exclude) .")";
			} // end if	
		
			$cmd = " select			top $data_per_page
							 					ORG_ID, ORG_ID_REF, ORG_NAME, OT_CODE
							 from			PER_ORG
							 where		OL_CODE='$search_ol_code' and ORG_NAME like '%$search_org_name%'
							 order by		ORG_ACTIVE DESC, ORG_SEQ_NO, ORG_CODE
						   ";	
		}elseif($DPISDB=="oci8"){
			$rec_start = (($current_page-1) * $data_per_page) + 1;
			$rec_end = ($current_page > 1)? ($current_page * $data_per_page) : $data_per_page;
			$cmd = " select * from (
							   select rownum rnum, q1.* from ( 
									select			ORG_ID, ORG_ID_REF, ORG_NAME, OT_CODE
									from			PER_ORG
									where			OL_CODE='$search_ol_code' and ORG_NAME like '%$search_org_name%'
									order by		ORG_ACTIVE DESC, ORG_SEQ_NO, ORG_CODE
							   )  q1
							 ) where rnum between $rec_start and $rec_end  ";
		}elseif($DPISDB=="mysql"){
			$cmd = " select			ORG_ID, ORG_ID_REF, ORG_NAME, OT_CODE
						 from			PER_ORG
						 where		OL_CODE='$search_ol_code' and ORG_NAME like '%$search_org_name%'
						 order by		ORG_ACTIVE DESC, ORG_SEQ_NO, ORG_CODE
						  ";

		} // end if
	
		$count_page_data = $db_dpis->send_cmd($cmd);
		//$db_dpis->show_error();
		//echo "<br>$cmd<br>";
		if ($count_page_data) {
			$current_list = "";
			$data_count = 0;
			$data_num = $start_record;
	  ?>
	  <table width="100%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
	  	<tr height="25" align="center" class="table_head">
		  <td width="5%"><?=$SEQ_NO_TITLE?></td>
		  <td>หน่วยงาน</td>
		  <td width="20%">สังกัด</td>
		  <td width="5%"><?=$EDIT_TITLE?></td>
		</tr>
		<? 
			while($data = $db_dpis->get_array()){
				$data_num++;
				$data_count++;
				if($data_count > $data_per_page) break;
				
				$TMP_ORG_ID = $data[ORG_ID];
				$TMP_ORG_ID_REF = $data[ORG_ID_REF];
				$TMP_ORG_NAME = $data[ORG_NAME];
				$TMP_OT_CODE = $data[OT_CODE];
				
//				$LIST_OPENED_ORG = ",$TMP_ORG_ID,";
				$LIST_OPENED_ORG = "";
				$TMP_SHOW_ORG = "";				
				switch($search_ol_code){
					case "05" :
						$TMP_SHOW_ORG .= "<span class=\"brown_normal\">งาน</span> : $TMP_ORG_NAME<br>";
						$LIST_OPENED_ORG .= "$TMP_ORG_ID_REF,";
						$cmd = " select ORG_ID_REF, ORG_NAME from PER_ORG where OL_CODE='04' and ORG_ID=$TMP_ORG_ID_REF ";
						$db_dpis2->send_cmd($cmd);
						$data2 = $db_dpis2->get_array();
						$TMP_ORG_ID_REF = $data2[ORG_ID_REF];
						$TMP_ORG_NAME = $data2[ORG_NAME];	
					case "04" :
						$TMP_SHOW_ORG .= "<span class=\"brown_normal\">ฝ่าย</span> : $TMP_ORG_NAME<br>";
						$LIST_OPENED_ORG .= "$TMP_ORG_ID_REF,";
						$cmd = " select ORG_ID_REF, ORG_NAME from PER_ORG where OL_CODE='03' and ORG_ID=$TMP_ORG_ID_REF ";
						$db_dpis2->send_cmd($cmd);
						$data2 = $db_dpis2->get_array();
						$TMP_ORG_ID_REF = $data2[ORG_ID_REF];
						$TMP_ORG_NAME = $data2[ORG_NAME];
					case "03" :
						$TMP_SHOW_ORG .= "<span class=\"brown_normal\">สำนัก/กอง</span> : $TMP_ORG_NAME<br>";
						$LIST_OPENED_ORG .= "$TMP_ORG_ID_REF,";
						$cmd = " select ORG_ID_REF, ORG_NAME from PER_ORG where OL_CODE='02' and ORG_ID=$TMP_ORG_ID_REF ";
						$db_dpis2->send_cmd($cmd);
						$data2 = $db_dpis2->get_array();
						$TMP_ORG_ID_REF = $data2[ORG_ID_REF];
						$TMP_ORG_NAME = $data2[ORG_NAME];
					case "02" :
						$TMP_SHOW_ORG .= "<span class=\"brown_normal\">กรม</span> : $TMP_ORG_NAME<br>";
						$LIST_OPENED_ORG .= "$TMP_ORG_ID_REF,";
						$cmd = " select ORG_ID_REF, ORG_NAME from PER_ORG where OL_CODE='01' and ORG_ID=$TMP_ORG_ID_REF ";
						$db_dpis2->send_cmd($cmd);
						$data2 = $db_dpis2->get_array();
						$TMP_ORG_ID_REF = $data2[ORG_ID_REF];
						$TMP_ORG_NAME = $data2[ORG_NAME];
					case "01" :
						$TMP_SHOW_ORG .= "<span class=\"brown_normal\">กระทรวง</span> : $TMP_ORG_NAME";
						$LIST_OPENED_ORG .= "$TMP_ORG_ID_REF,";
				} // end switch case
				if($LIST_OPENED_ORG) $LIST_OPENED_ORG = ",$LIST_OPENED_ORG";
				
				$cmd = " select OT_NAME from PER_ORG_TYPE where OT_CODE='$TMP_OT_CODE' ";
				$db_dpis2->send_cmd($cmd);
				$data2 = $db_dpis2->get_array();
				$TMP_OT_NAME = $data2[OT_NAME];

				$class = "table_body";
				$onmouse_event = " onMouseOver=\"this.className='table_body_over';\" onMouseOut=\"this.className='table_body';\" ";
		?>
	  	<tr class="<?=$class?>" <?=$onmouse_event?>>
		  <td align="right" valign="top"><?=$data_num?>.&nbsp;</td>
		  <td><?=$TMP_SHOW_ORG?></td>
		  <td align="center" valign="top"><?=$TMP_OT_NAME?></td>
		  <?if($PAGE_AUTH["edit"]=="Y"){?><td align="center" valign="top">&nbsp;<a href="<?=("javascript:call_edit_structure($TMP_ORG_ID,$data[ORG_ID_REF],'$LIST_OPENED_ORG');")?>"><img src="images/b_edit.png" border="0" alt="แก้ไขโครงสร้าง"></a></td><?}?>
		</tr>
		<?
			} // end while
		?>
		<tr class="table_footer" height="21">
		  <td>&nbsp;</td>
		  <td>&nbsp;</td>
		  <td>&nbsp;</td>
		  <?if($PAGE_AUTH["edit"]=="Y"){?><td>&nbsp;</td><?}?>
		</tr>
	  </table>
	  <? if($total_page > 1) : ?>
	  <table width="100%" border="0" align="center" cellpadding="2" cellspacing="2" class="label_normal">
		<tr>
		  <td><?=$page_link?></td>
		</tr>
	  </table>
	  <? endif; ?>
	  <? } // if  count show ?>
	  &nbsp;
	  </td>
	</tr>
  </table>
  &nbsp;
  <? 
  	} // end if($command == "SEARCH_ORG") 
  ?>
        </form>	
	  </td>
	</tr>
</table>
</body>
<? if($command != "SEARCH_ORG" || !trim($search_org_name)){ ?>
<script language="JavaScript">
		editor_ORG_JOB.document.open();
		editor_ORG_JOB.document.write('<body style="font:10pt arial ; margin: 0px  0px; padding: 0px  0p"><?=$ORG_JOB?></body>');
//		alert(editor_ORG_JOB.document.body.innerHTML);
		editor_ORG_JOB.document.close();
		editor_ORG_JOB.document.designMode  = "on";
		
	<?if($PAGE_AUTH["add"]=="Y"){?>
		editor_NEW_ORG_JOB.document.open();
		editor_NEW_ORG_JOB.document.write('<body style="font:10pt arial ; margin: 0px  0px; padding: 0px  0p"><?=$NEW_ORG_JOB?></body>');
//		alert(editor_NEW_ORG_JOB.document.body.innerHTML);
		editor_NEW_ORG_JOB.document.close();
		editor_NEW_ORG_JOB.document.designMode  = "on";
	<?}?>

		function set_more_editor () {
			form1.ORG_JOB.value = editor_ORG_JOB.document.body.innerHTML;
		<?if($PAGE_AUTH["add"]=="Y"){?>
			form1.NEW_ORG_JOB.value = editor_NEW_ORG_JOB.document.body.innerHTML;
		<?}?>
//			alert(form1.ORG_JOB.value);
//			alert(form1.NEW_ORG_JOB.value);
		}
</script>
<script type="text/javascript">
setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
</script>
<? } // end if ?>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
</html>
