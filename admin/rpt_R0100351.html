<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/session_start.php");
	include("php_scripts/function_share.php");
	include("php_scripts/load_per_control.php");

	switch($CTRL_TYPE){
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;

			$search_ct_code = '140';
			$cmd = " select CT_NAME from PER_COUNTRY where trim(CT_CODE)='$search_ct_code' ";
			$db_dpis->send_cmd($cmd);	
			$data = $db_dpis->get_array();
			$search_ct_name = $data[CT_NAME];

			break;
		case 3 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
	} // end switch case	
	
	switch($SESS_USERGROUP_LEVEL){
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;

			$search_ct_code = '140';
			$cmd = " select CT_NAME from PER_COUNTRY where trim(CT_CODE)='$search_ct_code' ";
			$db_dpis->send_cmd($cmd);	
			$data = $db_dpis->get_array();
			$search_ct_name = $data[CT_NAME];

			break;
		case 3 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
		case 5 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id = $ORG_ID;
				$search_org_name = $ORG_NAME;			
			}else if($SESS_ORG_STRUCTURE==1){	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id = $ORG_ID;
				$search_org_ass_name = $ORG_NAME;
			}
			break;
		case 6 :
			$MINISTRY_ID = $MINISTRY_ID;
			$MINISTRY_NAME = $MINISTRY_NAME;
			$DEPARTMENT_ID = $DEPARTMENT_ID;
			$DEPARTMENT_NAME = $DEPARTMENT_NAME;
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id = $ORG_ID;
				$search_org_name = $ORG_NAME;
			}else{	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id = $ORG_ID;
				$search_org_ass_name = $ORG_NAME;
			}
			if($SESS_ORG_STRUCTURE==0 || $SESS_ORG_STRUCTURE==2){	//ตามกฏหมาย หรือกฏหมายและมอบหมายงาน
				$search_org_id_1 = $ORG_ID_1;
				$search_org_name_1 = $ORG_NAME_1;
			}else{	//ตามมอบหมายงาน (จาก load_per_control.php)
				$search_org_ass_id_1 = $ORG_ID_1;
				$search_org_ass_name_1 = $ORG_NAME_1;
			}
			break;
	} // end switch case
	
	if(!$search_ct_code) $search_ct_code = '140';
	$cmd = " select CT_NAME from PER_COUNTRY where trim(CT_CODE)='$search_ct_code' ";
	$db_dpis->send_cmd($cmd);	
	$data = $db_dpis->get_array();
	$search_ct_name = $data[CT_NAME];
	
	if(!$search_budget_year){
		if(date("Y-m-d") <= date("Y")."-10-01") $search_budget_year = date("Y") + 543;
		else $search_budget_year = (date("Y") + 543) + 1;
	} // end if
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
</head>
<script language="JavaScript" src="java_scripts/function_utility.js"></script>
<script language="JavaScript" src="java_scripts/function_search.js"></script>   
<script language="JavaScript">
	var total_rpt_order = 4;

	function change_current_page( page ){
		form1.current_page.value = page;
		form1.submit();
	}
		
	function call_search_perline () {	
		var parameter = "";
		call_openDialog("search_perline.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter + parameter_search_per_line,800,600,"<?=$PL_TITLE?>");
	}

	function call_search_pos_name () {	
		var parameter = "";
		call_openDialog("search_pos_name.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter + parameter_search_per_line,800,600,"ตำแหน่งลูกจ้างประจำ");
	}

	function call_search_empser_pos_name () {	
		var parameter = "";
		call_openDialog("search_empser_pos_name.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter + parameter_search_per_line,800,600,"ตำแหน่งพนักงานราชการ");
	}

	function call_report ( export_type,type ) {
//		alert("export_type="+export_type+" , type="+type);
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		if(document.form1.search_budget_year.value.trim()==""){
			alert("โปรดระบุ<?=$YEAR_TITLE?>");
			document.form1.search_budget_year.focus();
			return;
		} // end if 
		if(document.getElementById("list_type1").checked && document.form1.search_PM_CODE.value=="" && document.form1.search_pn_code.value==""){
			alert("โปรดระบุ<?=$PL_TITLE?> หรือ <?=$POS_EMP_TITLE?>");
			if(document.all.SEARCH_PER_MGT.style.display=="block") document.form1.btn_perline.focus();
			else if(document.all.SEARCH_POS_NAME.style.display=="block") document.form1.btn_pos_name.focus();
			return;
		} // end if
/*		
		var RPTORD_LIST = "";
		for(var i=1; i<=total_rpt_order; i++){
			if(eval("document.all.RPTORD_ORDER_" + i + ".checked") && !eval("document.all.RPTORD_ORDER_" + i + ".disabled")){
				if(RPTORD_LIST) RPTORD_LIST += "|";
				RPTORD_LIST += eval("document.all.RPTORD_ORDER_" + i + ".value");
			}
		}	
*/
		for(var i=0; i < document.form1.NUMBER_DISPLAY.length; i++){
			if(document.form1.NUMBER_DISPLAY[i].checked)	NUMBER_DISPLAY = document.form1.NUMBER_DISPLAY[i].value;
		}
//		document.form1.RPTORD_LIST.value = RPTORD_LIST;
		document.form1.export_type.value = export_type;
		document.form1.target = "_blank";
		if(export_type=="report"){
			if(!type) document.form1.action = "report/rpt_R0100351.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY+"&FLAG_RTF=0";
			else if(type==2) document.form1.action = "report/rpt_R0100351.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY+"&FLAG_RTF=1";
			else document.form1.action = "report/rpt_R0100351_xls.php?UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;
		}else if(export_type=="graph"){//if(export_type=="report"){
			if(!type){document.form1.action = "../graph/types/Column.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==1){document.form1.action = "../graph/types/Bar.php?gid=rpt_R010035.php&UTC=" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==2){document.form1.action = "../graph/types/BarGrp2.php?gid=rpt_R010035.php&UTC=" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==3){document.form1.action = "../graph/types/Line.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==4){document.form1.action = "../graph/types/LineGrp2.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==5){document.form1.action = "../graph/types/Pie2One.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==6){document.form1.action = "../graph/types/PieGrp2.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==7){document.form1.action = "../graph/types/BarStack.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
			else if(type==8){document.form1.action = "../graph/types/BarStackGrp2.php?gid=rpt_R010035.php&UTC" + rptDate+'&NUMBER_DISPLAY='+NUMBER_DISPLAY;}
		}//}else if(export_type=="graph"){

		document.form1.submit();
	} 
	
	function swap_order(ord1, ord2){
		var tmp_ord1_checked = eval("document.all.RPTORD_ORDER_" + ord1 + ".checked");
		var tmp_ord1_disabled = eval("document.all.RPTORD_ORDER_" + ord1 + ".disabled");
		var tmp_ord1_value = eval("document.all.RPTORD_ORDER_" + ord1 + ".value");
		var tmp_ord1_label = eval("document.all.RPTORD_LABEL_" + ord1 + ".innerText");
		var tmp_ord1_class = eval("document.all.RPTORD_ROW_" + ord1 + ".className");
		if(ord1 > 1) var tmp_ord1_icon_up = eval("document.all.IMG_UP_" + ord1 + ".style.display");
		if(ord1 < total_rpt_order) var tmp_ord1_icon_down = eval("document.all.IMG_DOWN_" + ord1 + ".style.display");

		var tmp_ord2_checked = eval("document.all.RPTORD_ORDER_" + ord2 + ".checked");
		var tmp_ord2_disabled = eval("document.all.RPTORD_ORDER_" + ord2 + ".disabled");
		var tmp_ord2_value = eval("document.all.RPTORD_ORDER_" + ord2 + ".value");
		var tmp_ord2_label = eval("document.all.RPTORD_LABEL_" + ord2 + ".innerText");
		var tmp_ord2_class = eval("document.all.RPTORD_ROW_" + ord2 + ".className");
		if(ord2 > 1) var tmp_ord2_icon_up = eval("document.all.IMG_UP_" + ord2 + ".style.display");
		if(ord2 < total_rpt_order) var tmp_ord2_icon_down = eval("document.all.IMG_DOWN_" + ord2 + ".style.display");
		
		eval("document.all.RPTORD_ORDER_" + ord1 + ".checked = " + tmp_ord2_checked);
		eval("document.all.RPTORD_ORDER_" + ord1 + ".disabled = " + tmp_ord2_disabled);
		eval("document.all.RPTORD_ORDER_" + ord1 + ".value = '" + tmp_ord2_value + "'");
		eval("document.all.RPTORD_LABEL_" + ord1 + ".innerText = '" + tmp_ord2_label + "'");
		eval("document.all.RPTORD_ROW_" + ord1 + ".className = '" + tmp_ord2_class + "'");
		if(ord1 > 1 && ord2 > 1) eval("document.all.IMG_UP_" + ord1 + ".style.display = '" + tmp_ord2_icon_up + "'");
		if(ord1 > 1 && ord2 == 1) eval("document.all.IMG_UP_" + ord1 + ".style.display = '" + tmp_ord2_icon_down + "'");
		if(ord1 < total_rpt_order && ord2 < total_rpt_order) eval("document.all.IMG_DOWN_" + ord1 + ".style.display = '" + tmp_ord2_icon_down + "'");
		if(ord1 < total_rpt_order && ord2 == total_rpt_order) eval("document.all.IMG_DOWN_" + ord1 + ".style.display = '" + tmp_ord2_icon_up + "'");

		eval("document.all.RPTORD_ORDER_" + ord2 + ".checked = " + tmp_ord1_checked);
		eval("document.all.RPTORD_ORDER_" + ord2 + ".disabled = " + tmp_ord1_disabled);
		eval("document.all.RPTORD_ORDER_" + ord2 + ".value = '" + tmp_ord1_value + "'");
		eval("document.all.RPTORD_LABEL_" + ord2 + ".innerText = '" + tmp_ord1_label + "'");
		eval("document.all.RPTORD_ROW_" + ord2 + ".className = '" + tmp_ord1_class + "'");
		if(ord2 > 1 && ord1 > 1) eval("document.all.IMG_UP_" + ord2 + ".style.display = '" + tmp_ord1_icon_up + "'");
		if(ord2 > 1 && ord1 == 1) eval("document.all.IMG_UP_" + ord2 + ".style.display = '" + tmp_ord1_icon_down + "'");
		if(ord2 < total_rpt_order && ord1 < total_rpt_order) eval("document.all.IMG_DOWN_" + ord2 + ".style.display = '" + tmp_ord1_icon_down + "'");
		if(ord2 < total_rpt_order && ord1 == total_rpt_order) eval("document.all.IMG_DOWN_" + ord2 + ".style.display = '" + tmp_ord1_icon_up + "'");
	} 
	
	function move_order(type, order){
		if(type == 1){
			// move it up
			var upper_order = order - 1;
			if(upper_order > 0) swap_order(order, upper_order);
		}else if(type == 2){
			// move it down
			var lower_order = order + 1;
			if(lower_order <= total_rpt_order) swap_order(order, lower_order);
		} 
	} 
	
	function  control_order(isChecked, order){
		if(isChecked){
			eval("document.all.RPTORD_ROW_" + order + ".className='table_body';");
		}else{
			eval("document.all.RPTORD_ROW_" + order + ".className='table_body_3';");
		}
	}
	
	function control_checkbox(list_type){
		if(list_type=="PER_MGT"){
			for(var i=1; i<=total_rpt_order; i++){
				if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="LINE"){ 
					eval("document.all.RPTORD_ORDER_" + i + ".disabled = true");
					eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body_3';");
					if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'none';");
					if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'none';");
				} // end if
				if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG_1" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG_2" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="PROVINCE"){ 
					eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
					if(eval("document.all.RPTORD_ORDER_" + i + ".checked")) eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body';");
					if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'block';");
					if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'block';");
				} // end if
			} // end for
		}else{
			for(var i=1; i<=total_rpt_order; i++){
				if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG_1" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG_2" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="LINE" || eval("document.all.RPTORD_ORDER_" + i + ".value")=="PROVINCE"){ 
					eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
					if(eval("document.all.RPTORD_ORDER_" + i + ".checked")) eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body';");
					if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'block';");
					if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'block';");
				} // end if
			} // end for
		} // end if
		var RPTORD_LIST = "";
		for(var i=1; i<=total_rpt_order; i++){
			if(eval("document.all.RPTORD_ORDER_" + i + ".checked") && !eval("document.all.RPTORD_ORDER_" + i + ".disabled")){
				if(RPTORD_LIST) RPTORD_LIST += "|";
				RPTORD_LIST += eval("document.all.RPTORD_ORDER_" + i + ".value");
			}
		}	

		if(RPTORD_LIST == ""){
			if(list_type=="PER_MGT"){
				for(var i=1; i<=total_rpt_order; i++){
					if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG"){ 
						eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
						eval("document.all.RPTORD_ORDER_" + i + ".checked = true");
						eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body';");
						if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'block';");
						if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'block';");
					} // end if
				} // end for
			} // end if
		} // end if
	}
	
	function form_initialize(){
		for(var i=1; i<=total_rpt_order; i++) eval("document.all.RPTORD_ROW_" + i + ".className='table_body';");
		document.all.RPTORD_ORDER_1.disabled = false;
		document.all.RPTORD_ORDER_1.value = "MINISTRY";
		document.all.RPTORD_LABEL_1.innerText = "<?=$MINISTRY_TITLE?>";
		document.all.RPTORD_ROW_1.className = "table_body";
		document.all.IMG_DOWN_1.style.display = "block";

		document.all.RPTORD_ORDER_2.disabled = false;
		document.all.RPTORD_ORDER_2.value = "DEPARTMENT";
		document.all.RPTORD_LABEL_2.innerText = "<?=$DEPARTMENT_TITLE?>";
		document.all.RPTORD_ROW_2.className = "table_body_3";
		document.all.IMG_UP_2.style.display = "block";
		document.all.IMG_DOWN_2.style.display = "block";

		document.all.RPTORD_ORDER_3.disabled = false;
		document.all.RPTORD_ORDER_3.value = "ORG";
		document.all.RPTORD_LABEL_3.innerText = "<?=$ORG_TITLE?>";
		document.all.RPTORD_ROW_3.className = "table_body_3";
		document.all.IMG_UP_3.style.display = "block";
		document.all.IMG_DOWN_3.style.display = "block";

		document.all.RPTORD_ORDER_4.disabled = false;
		document.all.RPTORD_ORDER_4.value = "LINE";
		document.all.RPTORD_LABEL_4.innerText = "<?=$PL_TITLE?>";
		document.all.RPTORD_ROW_4.className = "table_body_3";
		document.all.IMG_UP_4.style.display = "block";
//		document.all.IMG_DOWN_4.style.display = "block";

//		document.all.SEARCH_PER_ORG_ASS.style.display='none';
//		document.all.SEARCH_PER_ORG.style.display='block';
	}
	
	function disable_field(disable_flag){
		if(disable_flag){
//			document.all.SEARCH_PER_ORG.style.display='none';
//			document.all.SEARCH_PER_ORG_ASS.style.display='block';
			
			for(var i=1; i<=total_rpt_order; i++){ 
				if(eval("document.all.RPTORD_ORDER_" + i + ".value") == "ORG_1"){ 
					eval("document.all.RPTORD_ORDER_" + i + ".disabled = true");
					eval("document.all.RPTORD_ORDER_" + i + ".checked = false");
					eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body_3'");
				} // end if
				if(eval("document.all.RPTORD_ORDER_" + i + ".value") == "ORG_2"){ 
					eval("document.all.RPTORD_ORDER_" + i + ".disabled = true");
					eval("document.all.RPTORD_ORDER_" + i + ".checked = false");
					eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body_3'");
				} // end if
			} // end for
		}else{
//			document.all.SEARCH_PER_ORG_ASS.style.display='none';
//			document.all.SEARCH_PER_ORG.style.display='block';

			for(var i=1; i<=total_rpt_order; i++){ 
				if(eval("document.all.RPTORD_ORDER_" + i + ".value") == "ORG_1") eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
				if(eval("document.all.RPTORD_ORDER_" + i + ".value") == "ORG_2") eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
			} // end for
		} // end if
	}
	
	function returnFrom(src, returnValue){
//		alert("src="+src+"("+returnValue+")");
		if  (src.indexOf("rpt_column_adjust") > -1) {
			if(returnValue){
				form1.COLUMN_FORMAT.value = returnValue;
	//			alert(form1.COLUMN_FORMAT.value);
			} // end if
		} else if  (src.indexOf("search_province") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_pv_code.value = arrValue[0];
				form1.search_pv_name.value = arrValue[1];
				if(document.getElementById("list_type7"))	document.getElementById("list_type7").checked=true;
	
				if(document.getElementById("list_type7").checked){
					for(var i=1; i<=total_rpt_order; i++){
						if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="PROVINCE"){ 
							eval("document.all.RPTORD_ORDER_" + i + ".disabled = true");
							eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body_3';");
							if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'none';");
							if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'none';");
						} // end if
					} // end for
				} // end if
	
				var RPTORD_LIST = "";
				for(var i=1; i<=total_rpt_order; i++){
					if(eval("document.all.RPTORD_ORDER_" + i + ".checked") && !eval("document.all.RPTORD_ORDER_" + i + ".disabled")){
						if(RPTORD_LIST) RPTORD_LIST += "|";
						RPTORD_LIST += eval("document.all.RPTORD_ORDER_" + i + ".value");
					}
				}
				
				if(RPTORD_LIST == ""){				
					for(var i=1; i<=total_rpt_order; i++){
						if(eval("document.all.RPTORD_ORDER_" + i + ".value")=="ORG"){ 
							eval("document.all.RPTORD_ORDER_" + i + ".disabled = false");
							eval("document.all.RPTORD_ORDER_" + i + ".checked = true");
							eval("document.all.RPTORD_ROW_" + i + ".className = 'table_body';");
							if(i != 1) eval("document.all.IMG_UP_" + i + ".style.display = 'block';");
							if(i != total_rpt_order) eval("document.all.IMG_DOWN_" + i + ".style.display = 'block';");
						} // end if
					} // end for
				} // end if
			} // end if
		} else if  (src.indexOf("search_country") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_ct_code.value = arrValue[0];
				form1.search_ct_name.value = arrValue[1];
				form1.search_pv_code.value = "";
				form1.search_pv_name.value = "";
				if(document.getElementById("list_type7"))	document.getElementById("list_type7").checked=true;
			} // end if
		} else if  (src.indexOf("search_perline") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_pl_code.value = arrValue[0];
				form1.search_pl_name.value = arrValue[1];
				if(document.getElementById("list_type2"))	document.getElementById("list_type2").checked=true;
			} // end if
		} else if  (src.indexOf("search_pos_name") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_pn_code.value = arrValue[0];
				form1.search_pn_name.value = arrValue[1];
				if(document.getElementById("list_type2"))	document.getElementById("list_type2").checked=true;
			} // end if
		} else if  (src.indexOf("search_empser_pos_name") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_ep_code.value = arrValue[0];
				form1.search_ep_name.value = arrValue[1];
				if(document.getElementById("list_type2"))	document.getElementById("list_type2").checked=true;
			} // end if
		} else if  (src.indexOf("search_temp_pos_name") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.search_tp_code.value = arrValue[0];
				form1.search_tp_name.value = arrValue[1];
				if(document.getElementById("list_type2"))	document.getElementById("list_type2").checked=true;
			} // end if
		}
//		$( "#d_frame" )[0].src="";
//		alert("returnValue="+tt.value);
		tt.value = returnValue;
	} // end if
	
</script>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE=" &gt; ดูข้อมูล";
		include("current_location.html");
?>
	  </td>
	</tr>
  	<tr>
    	<td align="center" valign="top">
		<form name="form1" method="post" action="rpt_R010035.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="RPTORD_LIST" value="">
		  <input type="hidden" name="export_type" value="">
          <input type="hidden" name="report" value="<?=$report?>">
		  <input type="hidden" name="COLUMN_FORMAT" value="<?=$COLUMN_FORMAT?>">
		&nbsp;
		<table width="100%"  border="0" cellspacing="0" cellpadding="0">
		  <tr>
			<td align="center">
	<? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn2" type="button" class="button" style="width:150" value="<?=$PDF_TITLE?>" onClick="call_report('report',0);">
              <?  } else { ?>
              <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$PDF_TITLE?>" onClick="call_report('report',0);">
              <? } echo "&nbsp;";?>
              <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn3" type="button" class="button" style="width:130" value="<?=$EXCEL_TITLE?>" onClick="call_report('report',1);">
              <?  } else { ?>
              <img src="images/doc_icon_excel.jpg" border="0" alt="<?=$EXCEL_TITLE?>" onClick="call_report('report',1);">
              <? } echo "&nbsp;"; ?>
              <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn4" type="reset" class="button" value="<?=$CLEAR_TITLE?>" onClick="form_initialize();">
              <?  } else { ?>
              <img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="30" height="30" border="0" onClick="form_initialize(); form1.reset();">
              <? } echo "&nbsp;"; ?>
			<input type="radio" name="NUMBER_DISPLAY" value="1" <?=($NUMBER_DISPLAY==1)?"checked":""?>>เลขอารบิค
			  <input type="radio" name="NUMBER_DISPLAY" value="2" <?=($NUMBER_DISPLAY==2)?"checked":""?>>เลขไทย
		  	<select name="CH_PRINT_FONT" class="selectbox">
					<?  foreach($ARR_PRINT_FONT as $key=>$value){  ?><option value="<?=$key; ?>"<?=($PRINT_FONT==$key)?"selected":""?> ><?=$value; ?></option><?  } ?>
			</select>
		</td>
	</tr>
<!-- กำหนดให้ $PAGE_AUTH_GRAPH=="A" เพื่อให้มันไม่แสดงส่วน graph -->
<?if($PAGE_AUTH_GRAPH=="A"){?>	
		  <tr>
			<td align="center">
	  <select name="Graph" size="1" >
	  <option selected value="JavaScript:call_report('graph',1);">กราฟแท่ง</option>
	  <option value="JavaScript:call_report('graph',2);">กราฟแท่ง สลับกลุ่มข้อมูล</option>
	  <option value="JavaScript:call_report('graph',3);">กราฟเส้น</option>
	  <option value="JavaScript:call_report('graph',4);">กราฟเส้น สลับกลุ่มข้อมูล</option>
	  <option value="JavaScript:call_report('graph',5);">กราฟวงกลม</option>
	  <option value="JavaScript:call_report('graph',6);">กราฟวงกลม สลับกลุ่มข้อมูล</option>
	  <option value="JavaScript:call_report('graph',7);">กราฟชั้น</option>
	  <option value="JavaScript:call_report('graph',8);">กราฟชั้น สลับกลุ่มข้อมูล</option>
	  </select>
            &nbsp;&nbsp;สูง
            <input type="text" name="GRAPH_HIGH" value="600" style="width:50" class="textbox" onKeyPress='NumOnly();'>
            &nbsp;&nbsp;กว้าง
            <input type="text" name="GRAPH_WIDE" value="800" style="width:50" class="textbox" onKeyPress='NumOnly();'>
            &nbsp;&nbsp;ชื่อย่อ
            <input name="short_name" type="checkbox" id="short_name" value="y">
	  <? if ($BUTTON_DISPLAY==1) { ?>
      <input name="button" type="button" onClick="location=document.form1.Graph.options[document.form1.Graph.selectedIndex].value" value="<?=$SHOW_GRAPH_TITLE?>">
<? } else { ?>
<img src="images/show.gif" alt="<?=$SHOW_GRAPH_TITLE?>" width="30" height="30" border="0" onClick="location=document.form1.Graph.options[document.form1.Graph.selectedIndex].value">
<? } ?>
		</td>
	</tr>
    <?}//f($PAGE_AUTH_GRAPH=="Y"){?>
		</table>  
		&nbsp;
		<table width="95%" align="center" cellpadding="0" cellspacing="0" height="150">
    	  <tr>
		  	<td width="30%" align="center" valign="top"><table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
              <tr>
                <td align="center" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                    <tr>
                      <td height="22" colspan="2" align="center" class="table_head"><?=$REPORT_CONDITION?></td>
                      </tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
                    <tr>
                      <td height="22" align="right">&nbsp;<? $styleORG[$SESS_ORG_STRUCTURE]="display:block;";
					  if($SESS_ORG_STRUCTURE==1){ $select_org_structure=1; $styleORG[0]="display:none;"; }else{ $styleORG[1]="display:none;";	} ?></td>
                      <td><input name="select_org_structure" type="radio" value="0" <?=($SESS_ORG_STRUCTURE==1)?"disabled":"" ?> <?=($select_org_structure==0)?"checked":""?> onClick="disable_field(false);">                        <?=$LAW_STRUCTURE_TITLE?></td>
                    </tr>
                    <tr>
                      <td height="22" align="right">&nbsp;</td>
                      <td><input name="select_org_structure" type="radio" value="1" <?=($SESS_ORG_STRUCTURE==0 || ($SESS_ORG_STRUCTURE==2&&$ORG_ID))?"disabled":"" ?> <?=($select_org_structure==1)?"checked":""?> onClick="disable_field(true);">                        <?=$ASSIGN_STRUCTURE_TITLE?></td>
                    </tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
                    <tr>
                      <td height="22" align="right">&nbsp;</td>
                      <td>
					  	<?=$YEAR_TITLE?>&nbsp;&nbsp;&nbsp;
                      	<input name="search_budget_year" type="text" class="textbox" size="5" value="<?=($search_budget_year)?>" onKeyPress="return DigitOnly();">
					  </td>
                    </tr>
                    <tr>
                      <td height="7" colspan="2" align="right"></td>
                      </tr>
                </table></td>
              </tr>
            </table></td>
      		<td align="center" valign="top" height="150">
			<table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
			  <tr>
			  	<td align="center" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                  <tr>
                    <td height="22" colspan="2" align="center" class="table_head"><?=$REPORT_FORMAT ?></td>
                    </tr>
                  <tr>
                    <td width="5%" align="center" valign="top"><input type="checkbox" id="list_type0" name="list_type[]" value="ALL" checked onClick="control_checkbox(this.value);"></td>
                    <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td width="30%">&nbsp;<?=$ALL_REPORT_TITLE?></td>
                        <td>&nbsp;</td>
                      </tr>
                      <? if($CTRL_TYPE == 2 || ($SESS_USERGROUP_LEVEL == 2 && $BKK_FLAG != 1)){ ?>
                      <tr>
                        <td>&nbsp;<?=$PV_TITLE?></td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                            <tr>
                              <td width="75%"><input type="text" name="PROVINCE_NAME" value="<?=$PROVINCE_NAME?>" style="width:99%" class="textbox"  readonly="true">
                              </td>
                              <td><input type="hidden" name="PROVINCE_ID" value="<?=$PROVINCE_ID?>">
                                &nbsp;</td>
                            </tr>
                        </table></td>
                      </tr>
                      <? } // end if ?>
                      <tr>
                        <td>&nbsp;<?=$MINISTRY_TITLE?></td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                            <tr>
                              <td width="75%"><input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:99%" class="textbox"  readonly="true">
                              </td>
                              <td><? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3){ ?>
                                  <input type="button" name="btn_ministry" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_ministry()">
                                  <input name="image2" type="image" onClick="form1.MINISTRY_NAME.value=''; form1.MINISTRY_ID.value=''; form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
                                  <? }else{ echo "&nbsp;"; } // end if ?>
                                  <input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>"></td>
                            </tr>
                        </table></td>
                      </tr>
                      <tr>
                        <td>&nbsp;<?=$DEPARTMENT_TITLE?></td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                            <tr>
                              <td width="75%"><input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:99%" class="textbox"  readonly="true">
                              </td>
                              <td><? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4){ ?>
                                  <input type="button" name="btn_department" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_department()">
                                  <input name="image2" type="image" onClick="form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
                                  <? }else{ echo "&nbsp;"; } // end if ?>
                                  <input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>"></td>
                            </tr>
                        </table></td>
                      </tr>
                    </table></td>
                  </tr>
                  <tr>
                    <td align="center" valign="top"><input type="checkbox" id="list_type1" name="list_type[]" value="PER_MGT" onClick="control_checkbox(this.value);"></td>
                    <td>
					<div id="SEARCH_PER_MGT" style="display:block">
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td width="30%">&nbsp;<?=$PL_TITLE?></td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                          <tr>
                            <td width="75%">
							  <input type="text" name="search_PM_NAME" value="<?=$search_PM_NAME?>" style="width:99%" class="textbox"  readonly="true">
							</td>
                            <td>
							  <input type="button" name="btn_perline" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_perline()">
							  <input name="image" type="image" onClick="form1.search_PM_NAME.value=''; form1.search_PM_CODE.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <input type="hidden" name="search_PM_CODE" value="<?=$search_PM_CODE?>">
							</td>
                          </tr>
                        </table></td>
                      </tr>
					</table>
					</div>
					<div id="SEARCH_POS_NAME" style="display:none">
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td width="30%">&nbsp;&nbsp;ตำแหน่งลูกจ้าง</td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                          <tr>
                            <td width="75%">
							  <input type="text" name="search_pn_name" value="<?=$search_pn_name?>" style="width:99%" class="textbox"  readonly="true">
							</td>
                            <td>
							  <input type="button" name="btn_pos_name" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_pos_name()">
							  <input name="image" type="image" onClick="form1.search_pn_name.value=''; form1.search_pn_code.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <input type="hidden" name="search_pn_code" value="<?=$search_pn_code?>">
							</td>
                          </tr>
                        </table></td>
                      </tr>
                    </table>
					</div>
					<div id="SEARCH_EMPSER_POS_NAME" style="display:none">
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td width="30%">&nbsp;&nbsp;ตำแหน่งพนักงานฯ</td>
                        <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
                          <tr>
                            <td width="75%">
							  <input type="text" name="search_ep_name" value="<?=$search_ep_name?>" style="width:99%" class="textbox"  readonly="true">
							</td>
                            <td>
							  <input type="button" name="btn_empser_pos_name" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_empser_pos_name()">
							  <input name="image" type="image" onClick="form1.search_ep_name.value=''; form1.search_ep_code.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">
							  <input type="hidden" name="search_ep_code" value="<?=$search_ep_code?>">
							</td>
                          </tr>
                        </table></td>
                      </tr>
                    </table>
					</div>
					</td>
                  </tr>
                </table></td>
			  </tr>
			</table>
			</td>
			<td width="25%" align="center" valign="top" height="150">
			<table width="98%" height="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
			  <tr>
			  	<td align="center" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                  <tr class="table_head">
                    <td>
                    <table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                      <tr class="table_head">
                        <td width="5%" height="22" align="center">&nbsp;</td>
<!--					<td align="center"><?=$REPORT_ORDER?></td>-->
                        <td align="center">ระดับตำแหน่ง</td>
                        <td width="5%" align="center">&nbsp;</td>
                        <td width="5%" align="center">&nbsp;</td>
                      </tr>
					</table>
					</td>
				  </tr>
                  <tr><td colspan="4" align="center">
					<select name="nlevel" size="5" >
<?
                        if ($ISCS_FLAG==1) 
                            $ARR_LEVEL_GROUP = array("M", "D", "K");
                        else
                            $ARR_LEVEL_GROUP = array("M", "D", "K", "O");
                        $ARR_LEVEL_GROUP_NAME["M"] = "บริหาร";
                        $ARR_LEVEL_GROUP_NAME["D"] = "อำนวยการ";
                        $ARR_LEVEL_GROUP_NAME["K"] = "วิชาการ";
                        if ($ISCS_FLAG!=1) 
                            $ARR_LEVEL_GROUP_NAME["O"] = "ทั่วไป";
                    
                        $ARR_LEVEL["M"] = array("M2", "M1");
                        $ARR_LEVEL["D"] = array("D2", "D1");
                        if ($ISCS_FLAG==1) 
                            $ARR_LEVEL["K"] = array("K5", "K4");
                        else
                            $ARR_LEVEL["K"] = array("K5", "K4", "K3", "K2", "K1");
                        if ($ISCS_FLAG!=1) 
                            if ($NOT_LEVEL_NO_O4=="Y") 
                                $ARR_LEVEL["O"] = array("O3", "O2", "O1");
                            else
                                $ARR_LEVEL["O"] = array("O4", "O3", "O2", "O1");
						$ARR_LEVEL_NAME = (array) null;
						$ARR_LEVEL_NAME["M2"] = "บริหารระดับสูง";
                        $ARR_LEVEL_NAME["M1"] = "บริหารระดับต้น";
                        $ARR_LEVEL_NAME["D2"] = "อำนวยการระดับสูง";
                        $ARR_LEVEL_NAME["D1"] = "อำนวยการระดับต้น";
                        $ARR_LEVEL_NAME["K5"] = "วิชาการทรงคุณวุฒิ";
                        $ARR_LEVEL_NAME["K4"] = "วิชาการเชี่ยวชาญ";
                        $ARR_LEVEL_NAME["K3"] = "วิชาการชำนาญการพิเศษ";
                        $ARR_LEVEL_NAME["K2"] = "วิชาการชำนาญการ";
                        $ARR_LEVEL_NAME["K1"] = "วิชาการปฏิบัติการ";
						$ARR_LEVEL_NAME["O4"] = "ทั่วไปทักษะพิเศษ";
						$ARR_LEVEL_NAME["O3"] = "ทั่วไปอาวุโส";
						$ARR_LEVEL_NAME["O2"] = "ทั่วไปชำนาญงาน";
						$ARR_LEVEL_NAME["O1"] = "ทั่วไปปฏิบัติงาน";

//						for($i=0; $i<count($ARR_LEVEL_GROUP); $i++){
//							$LEVEL_GROUP = $ARR_LEVEL_GROUP[$i];
//							for($j=0; $j<count($ARR_LEVEL[$LEVEL_GROUP]); $j++){
//								$LEVEL_NO = $ARR_LEVEL[$LEVEL_GROUP][$j];
//								$selected = "";
//								if ($nlevel==$LEVEL_NO) $selected = "selected";
?>
<!--							<option <?=$selected?> value="<?=$LEVEL_NO?>" ><?=$ARR_LEVEL_NAME[$LEVEL_NO]?></option>-->
<!--							<tr><td colspan="4">[<?=$LEVEL_NO?>]<?=$ARR_LEVEL_NAME[$LEVEL_NO]?>&nbsp;&nbsp;</td></tr>-->
<?
//							} // loop for
//						} // loop for
?>
						<option selected value="ALL" >ทั้งหมด</option>
<?
                        for($i=0; $i<count($ARR_LEVEL_GROUP); $i++){
                            $LEVEL_GROUP = $ARR_LEVEL_GROUP[$i];
							$selected = "";
							if ($nlevel==$LEVEL_GROUP) $selected = "selected";
?>
							<option <?=$selected?> value="<?=$LEVEL_GROUP?>" ><?=$ARR_LEVEL_GROUP_NAME[$LEVEL_GROUP]?></option>
<?
                        } // loop for
?>
				  	</select>
                </table></td>
			  </tr>
			</table>
			</td>
    	  </tr>
  		</table>
		&nbsp;
	  </form>	
	  </td>
	</tr>
</table>
<?
	include("jqModalDialog.html");
?>
</body>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
</html>
