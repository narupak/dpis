<?
	include("../php_scripts/connect_database.php");

	if($VIEW=="" && $_GET['VIEW']!="")		$VIEW = $_GET['VIEW'];
	if($UPD=="" && $_GET['UPD']!="")		$UPD = $_GET['UPD'];
	
	if($_GET['VIEW_DTL'])	$VIEW_DTL = $_GET['VIEW_DTL'];
	if($VIEW_DTL && $_GET['VIEW_DTL']==0)	$VIEW_DTL = "";		
	if($_GET['UPD_DTL'])	$UPD_DTL = $_GET['UPD_DTL'];
	if($CH_ADD=="" && $_POST['CH_ADD']!="")				$CH_ADD = $_POST['CH_ADD'];

	if(!isset($show_topic)) $show_topic = 1;
	if($show_topic==1){
		include("php_scripts/data_improve_position.php");
	}elseif($show_topic==2){
		include("php_scripts/data_improve_position_desc.php");
	}
//	print("<pre> POST : "); 	print_r($_POST);  print("</hr> GET : ");	print_r($_GET); print("</pre>");

	if(!$print_order_by) $print_order_by=1;
	$PER_TYPE = (trim($PER_TYPE))? $PER_TYPE : 1;
	//----------------------------------------------------------------------------------------------------------------------------------------------
	
	switch($CTRL_TYPE){
		case 2 :
			$PV_CODE = $PROVINCE_CODE;
			$PV_NAME = $PROVINCE_NAME;
			break;
		case 3 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			break;
		case 4 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			break;
	} // end switch case

	$COM_SEND_STATUS = "";
	switch($SESS_USERGROUP_LEVEL){
		case 2 :
			$PV_CODE = $PROVINCE_CODE;
			$PV_NAME = $PROVINCE_NAME;
			break;
		case 3 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			break;
		case 4 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			break;
		case 5 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$COM_SEND_STATUS = "S";
			break;
		case 6 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$COM_SEND_STATUS = "S";
			break;
	} // end switch case
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/>
</head>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script>
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript">
	var FName = new Array('form0','form1');	//form ทั้งหมด
	function change_current_page_data(page,formName){
		eval(formName).current_page.value = page;
		//alert(formName);
		eval(formName).submit(); 
	}

//-------------------------------จาก   data_req_command.html
	function changedateformat(name,str) {
		var arr = str.split('/');
		if((str) && (str != arr[0]+'/'+arr[1]+'/'+arr[2])){
			name.value = str.substr(0,2) + "/" + str.substr(2,2) + "/"  + str.substr(4,4) ;
		}
		chk_date(name, "BDH");
	}
	
	function confirm_delete(data_id , data_label){
		if(confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่ [ " + data_label + " ]?")){
			form0.command.value = "DELETE";
			form0.ORD_ID.value = data_id;
			form0.submit();
		} // end if
	}

	function confirm_delete_dtl(data_id , data_label){
		if(confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่ [ " + data_label + " ]?")){
			form1.command.value = "DELETE";
			form1.ORD_SEQ.value = data_id;
			form1.submit();
		} // end if
	}

	function call_select_ministry () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&send_by=select_ministry&OL_CODE=01&PV_CODE=" + PROVINCE_CODE;
	    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MINISTRY_TITLE?>");		
	}

	function call_select_department () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MINISTRY_ID":"form0.MINISTRY_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=select_department&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form0.btn_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_search_ministry () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&send_by=search_ministry&OL_CODE=01&PV_CODE=" + PROVINCE_CODE;
	    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MINISTRY_TITLE?>");		
	}

	function call_search_department () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$search_ministry_id":"form0.search_ministry_id.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=search_department&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form0.btn_search_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_select_ministry1 () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&send_by=search_ministry1&OL_CODE=01&PV_CODE=" + PROVINCE_CODE;
	    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MINISTRY_TITLE?>");		
	}

	function call_select_department1 () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MINISTRY_ID":"form1.MINISTRY_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=search_department1&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form1.btn_ministry.focus();
			<? } ?>
		} // end if
	}

	function show_all_command () {
		form0.search_ord_year_min.value = "";
		form0.search_ord_year_max.value = "";
		form0.search_ord_no_min.value = "";
		form0.search_ord_no_max.value = "";
		form0.search_ord_title.value = "";
		form0.search_ord_date_min.value = "";
		form0.search_ord_date_max.value = "";
		<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3){ ?>	
		form0.search_ministry_id.value = "";
		form0.search_ministry_name.value = "";
		<? } // end if ?>
		<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4){ ?>	
		form0.search_department_id.value = "";
		form0.search_department_name.value = "";
		<? } // end if ?>
		form0.submit();
	}
	
	function call_sort(flag) {
		form0.order_by.value=flag;		form0.sort_by.value=flag;
		if(form0.sort_type.value==flag+":asc"){
			form0.sort_type.value=flag+":desc";
		}else{ //desc
			form0.sort_type.value=flag+":asc";
		}		
		form0.command.value='SEARCH';
		form0.submit();
	} // end function call_sort
//-------------------------------
	function confirm_command() {
		if (confirm("ต้องการยืนยันคำสั่งปรับปรุงตำแหน่ง ใช่หรือไม่?")) {
			form0.command.value = "CONFIRMCOMMAND";
			form0.current_page.value = 1;
			return true;			
		} else {
			return false;
		}
	}	
	
//----จาก data_improve_position_desc.html
	function verify_data(command){
		if(document.form0.ORD_YEAR.value.trim()==""){			
			alert('ระบุ<?=$YEAR_TITLE?>');
			document.form0.ORD_YEAR.focus();
			return false;
		}
		if(document.form0.ORD_NO.value.trim()==""){			
			alert('ระบุเลขที่คำสั่ง');
			document.form0.ORD_NO.focus();
			return false;
		}
		if(document.form0.ORD_DATE.value.trim()==""){			
			alert('ระบุคำสั่งลงวันที่');
			document.form0.ORD_DATE.focus();
			return false;
		}
		
		document.form0.command.value = command;
//		document.form0.submit();
		return true;
	}
	
	function check_valid_date() {
		if(form0.search_ord_date_min.value && form0.search_ord_date_max.value){
			intMinDate = Date.parse(form0.search_ord_date_min.value);
			intMaxDate = Date.parse(form0.search_ord_date_max.value);
			if(intMaxDate < intMinDate){
				alert("กำหนดช่วงวันที่ ไม่ถูกต้อง");
				form0.search_ord_date_max.focus();
				return false;
			} else  			
		form0.command.value='SEARCH';
		return true; 
		}
	}

	function call_search_position () {	
//		parameter = "&isLock=1&LOCK_MINISTRY_ID=" + form0.MINISTRY_ID.value + "&LOCK_DEPARTMENT_ID=" + form0.DEPARTMENT_ID.value;
		parameter = "";
	    call_openDialog("search_position.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$POSITION_TITLE?>");		
	}
	
	function disable_form_button (value) {
		document.all.btn_off_type.disabled = value;
		document.all.btn_line.disabled = value;
		document.all.btn_mgt.disabled = value;
		document.all.btn_co_level.disabled = value;
		if(document.all.btn_per_type)	document.all.btn_per_type.disabled = value;
		document.all.btn_skill_group.disabled = value;
		document.all.btn_skill.disabled = value;
		document.all.btn_condition.disabled = value;
		document.all.btn_org.disabled = value;
		document.all.btn_org_1.disabled = value;
		document.all.btn_org_2.disabled = value;
	}

	function call_search_off_type () {	
		parameter = "";
	    call_openDialog("search_offtype.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$OFF_TYPE_TITLE?>");		
	}

	function call_search_perline () {	
		parameter = "";
	    call_openDialog("search_perline.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$PL_TITLE?>");		
	}

	function call_search_mgt () {	
		parameter = "";
	    call_openDialog("search_mgt.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$PM_TITLE?>");		
	}

	function call_search_co_level () {	
		parameter = "";
	    call_openDialog("search_co_level.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$CL_TITLE?>");		
	}

	function call_search_level () {	
		parameter = "";
	    call_openDialog("search_level.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$LEVEL_TITLE?>");		
	}

	function call_search_skill_group () {	
		parameter = "";
//		if(form1.PL_CODE.value != "") parameter = "&PL_CODE=" + form1.PL_CODE.value;
	    call_openDialog("search_skill_group.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$SG_TITLE?>");		
	}

	function call_search_skill () {	
		parameter = "";
		if(form1.SG_CODE.value != "") parameter = "&SG_CODE=" + form1.SG_CODE.value;
	    call_openDialog("search_skill.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$SKILL_TITLE?>");		
	}

	function call_search_org () {	
		var DEPARTMENT_ID = <?=(($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4)?"$DEPARTMENT_ID":"form1.DEPARTMENT_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(DEPARTMENT_ID != ""){
			parameter = "&send_by=search_org&OL_CODE=03&ORG_ID_REF=" + DEPARTMENT_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
			alert('<?=$DEPARTMENT_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$DEPARTMENT_ALERT?>');
			form1.btn_department.focus();
			<? } ?>
		} // end if
	}

	function call_search_org_1 () {	
		if(form1.ORG_ID.value != ""){
			parameter = "&send_by=search_org_1&OL_CODE=04&ORG_ID_REF=" + form1.ORG_ID.value;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE1?>");		
		}else{
			alert('<?=$ORG_ALERT?>');
			form1.btn_org.focus();
		} // end if
	}

	function call_search_org_2 () {	
		if(form1.ORG_ID_1.value != ""){
			parameter = "&send_by=search_org_2&OL_CODE=05&ORG_ID_REF=" + form1.ORG_ID_1.value;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE2?>");		
		}else{
			alert('<?=$ORG1_ALERT?>');
			form1.btn_org_1.focus();
		} // end if
	}

	function call_search_org_3 () {	
		if(form1.ORG_ID_2.value != ""){
			parameter = "&send_by=search_org_3&OL_CODE=06&ORG_ID_REF=" + form1.ORG_ID_2.value;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE3?>");		
		}else{
			alert('<?=$ORG2_ALERT?>');
			form1.btn_org_2.focus();
		} // end if
	}

	function call_search_org_4 () {	
		if(form1.ORG_ID_3.value != ""){
			parameter = "&send_by=search_org_4&OL_CODE=07&ORG_ID_REF=" + form1.ORG_ID_3.value;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE4?>");		
		}else{
			alert('<?=$ORG3_ALERT?>');
			form1.btn_org_3.focus();
		} // end if
	}

	function call_search_org_5 () {	
		if(form1.ORG_ID_4.value != ""){
			parameter = "&send_by=search_org_5&OL_CODE=08&ORG_ID_REF=" + form1.ORG_ID_4.value;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$ORG_TITLE5?>");		
		}else{
			alert('<?=$ORG4_ALERT?>');
			form1.btn_org_4.focus();
		} // end if
	}

	function call_search_type () {	
		parameter = "";
		call_openDialog("search_type.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$PT_TITLE?>");		
	}

	function call_search_condition () {	
		var parameter = "";
		call_openDialog("search_condition.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,800,"<?=$PC_TITLE?>");		
	}

	function call_rtf_pdf_report(report_type) {
	    var report_type
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "การปรับปรุงการกำหนดตำแหน่ง<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")))?>";
		document.form1.target = "_blank";
	    if (report_type==1){
		document.form1.action = "report/rpt_data_improve_position_desc.php?report_title=" + report_title + "&ORD_ID=<?=$ORD_ID?>&UTC" + rptDate+"&FLAG_RTF=1";
		}else if (report_type==0){ 
		document.form1.action = "report/rpt_data_improve_position_desc.php?report_title=" + report_title + "&ORD_ID=<?=$ORD_ID?>&UTC" + rptDate+"&FLAG_RTF=0";
		}
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "data_improve_position_desc.html";
	} 
	
	function call_export_file() {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "การปรับปรุงการกำหนดตำแหน่ง<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")))?>";
		document.form1.target = "_blank";
		document.form1.action = "report/rpt_data_improve_position_desc_xls.php?report_title=" + report_title + "&ORD_ID=<?=$ORD_ID?>&UTC" + rptDate;
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "data_improve_position_desc.html";
	}	

//----	
	function change_div(div_id){	
		if(div_id==2 && (!form1.ORD_ID.value)){
			alert("เลือกรายการที่ต้องการดูรายละเอียดก่อน");
		} else {
			for(var i=0; i < FName.length; i++){
				eval("document.all.DIV_TOPIC_" + eval(FName[i]).show_topic.value + ".style.display='none'");
				eval("document.all.DIV_TOPIC_" + div_id + ".style.display='block'");
	
				eval("document.all.CELL_TOPIC_" + eval(FName[i]).show_topic.value + ".className='table_body'");
				eval("document.all.CELL_TOPIC_" + div_id + ".className='table_body_3'");
				eval(FName[i]).show_topic.value = div_id;
				// eval(FName[i]).submit();
			}
		}
		if(div_id==1){
			form0.submit();
		}else if(div_id==2){
			if (form1.ORD_ID.value)
				form1.submit();
		}
	}
	
	function returnFrom(src, returnValue){
//		alert("src="+src+"("+returnValue+")");
		 if  (src.indexOf("search_org") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				if (arrValue[7]=="select_ministry") {
					form0.MINISTRY_ID.value = arrValue[0];
					form0.MINISTRY_NAME.value = arrValue[1];
					form0.DEPARTMENT_ID.value = "";
					form0.DEPARTMENT_NAME.value = "";
				} else if (arrValue[7]=="select_department") {
					form0.DEPARTMENT_ID.value = arrValue[0];
					form0.DEPARTMENT_NAME.value = arrValue[1];
				} else if (arrValue[7]=="search_ministry") {
					form0.search_ministry_id.value = arrValue[0];
					form0.search_ministry_name.value = arrValue[1];
					form0.search_department_id.value = "";
					form0.search_department_name.value = "";
				} else if (arrValue[7]=="search_department") {
					form0.search_department_id.value = arrValue[0];
					form0.search_department_name.value = arrValue[1];
				} else if (arrValue[7]=="search_ministry1") {
					form1.MINISTRY_ID.value = arrValue[0];
					form1.MINISTRY_NAME.value = arrValue[1];
					form1.DEPARTMENT_ID.value = "";
					form1.DEPARTMENT_NAME.value = "";
					form1.ORG_ID.value = ''; 
					form1.ORG_NAME.value = ''; 
					form1.ORG_ID_1.value = ''; 
					form1.ORG_NAME_1.value = ''; 
					form1.ORG_ID_2.value = ''; 
					form1.ORG_NAME_2.value = ''; 
					form1.ORG_ID_3.value = ''; 
					form1.ORG_NAME_3.value = ''; 
					form1.ORG_ID_4.value = ''; 
					form1.ORG_NAME_4.value = ''; 
					form1.ORG_ID_5.value = ''; 
					form1.ORG_NAME_5.value = '';
				} else if (arrValue[7]=="search_department1") {
					form1.DEPARTMENT_ID.value = arrValue[0];
					form1.DEPARTMENT_NAME.value = arrValue[1];
					form1.ORG_ID.value = ''; 
					form1.ORG_NAME.value = ''; 
					form1.ORG_ID_1.value = ''; 
					form1.ORG_NAME_1.value = ''; 
					form1.ORG_ID_2.value = ''; 
					form1.ORG_NAME_2.value = ''; 
					form1.ORG_ID_3.value = ''; 
					form1.ORG_NAME_3.value = ''; 
					form1.ORG_ID_4.value = ''; 
					form1.ORG_NAME_4.value = ''; 
					form1.ORG_ID_5.value = ''; 
					form1.ORG_NAME_5.value = '';
				} else if (arrValue[7]=="search_org") {
					form1.ORG_ID.value = arrValue[0];
					form1.ORG_NAME.value = arrValue[1];
					form1.ORG_ID_1.value = "";
					form1.ORG_NAME_1.value = "";
					form1.ORG_ID_2.value = "";
					form1.ORG_NAME_2.value = "";
			<? if($SESS_ORG_SETLEVEL==5) { ?>
					form1.ORG_ID_3.value = "";
					form1.ORG_NAME_3.value = "";
					form1.ORG_ID_4.value = "";
					form1.ORG_NAME_4.value = "";
					form1.ORG_ID_5.value = "";
					form1.ORG_NAME_5.value = "";
			<? } ?>
	
					if(arrValue[0] != "")
						document.all.PROCESS_IFRAME.src = "find_per_country.html?ORG_ID=" + arrValue[0] + "&RETURN_VAR[PV_CODE]=PV_CODE&RETURN_VAR[PV_NAME]=PV_NAME&RETURN_VAR[CT_CODE]=CT_CODE&RETURN_VAR[CT_NAME]=CT_NAME&RETURN_VAR[AP_CODE]=AP_CODE&RETURN_VAR[AP_NAME]=AP_NAME&RETURN_VAR[OT_CODE]=ORG_OT_CODE&RETURN_VAR[OT_NAME]=ORG_OT_NAME";
				} else if (arrValue[7]=="search_org_1") {
					form1.ORG_ID_1.value = arrValue[0];
					form1.ORG_NAME_1.value = arrValue[1];
					form1.ORG_ID_2.value = "";
					form1.ORG_NAME_2.value = "";
			<? if($SESS_ORG_SETLEVEL==5) { ?>	
					form1.ORG_ID_3.value = "";
					form1.ORG_NAME_3.value = "";
					form1.ORG_ID_4.value = "";
					form1.ORG_NAME_4.value = "";
					form1.ORG_ID_5.value = "";
					form1.ORG_NAME_5.value = ""; 
			<? } ?>
				} else if (arrValue[7]=="search_org_2") {
					form1.ORG_ID_2.value = arrValue[0];
					form1.ORG_NAME_2.value = arrValue[1];
				<? if($SESS_ORG_SETLEVEL==5) { ?>	
					form1.ORG_ID_3.value = "";
					form1.ORG_NAME_3.value = "";
					form1.ORG_ID_4.value = "";
					form1.ORG_NAME_4.value = "";
					form1.ORG_ID_5.value = "";
					form1.ORG_NAME_5.value = ""; 
				<? } ?>
				} else if (arrValue[7]=="search_org_3") {
					form1.ORG_ID_3.value = arrValue[0];
					form1.ORG_NAME_3.value = arrValue[1];
					form1.ORG_ID_4.value = "";
					form1.ORG_NAME_4.value = "";
					form1.ORG_ID_5.value = "";
					form1.ORG_NAME_5.value = "";
				} else if (arrValue[7]=="search_org_4") {
					form1.ORG_ID_4.value = arrValue[0];
					form1.ORG_NAME_4.value = arrValue[1];
					form1.ORG_ID_5.value = "";
					form1.ORG_NAME_5.value = "";
				} else if (arrValue[7]=="search_org_5") {
					form1.ORG_ID_5.value = arrValue[0];
					form1.ORG_NAME_5.value = arrValue[1];
				}
			} // end if
		} else if  (src.indexOf("search_position") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.POS_ID_OLD.value = arrValue[0];
				form1.ORD_POS_NO.value = arrValue[1];
				<? if ($POSITION_NO_CHAR=="Y") { ?>form1.ORD_POS_NO_NAME.value = arrValue[6];<? } ?>
			
				document.all.PROCESS_IFRAME.src = "find_command_position.html?POS_ID=" + arrValue[0] + "&var_prefix=ORD&copydata=1";
			} // end if
		} else if  (src.indexOf("search_offtype") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.OT_CODE.value = arrValue[0];
				form1.OT_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_perline") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.PL_CODE.value = arrValue[0];
				form1.PL_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_mgt") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.PM_CODE.value = arrValue[0];
				form1.PM_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_co_level") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.CL_CODE.value = arrValue[0];
				form1.CL_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_level") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.LEVEL_NO.value = arrValue[0];
				form1.LEVEL_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_skill_group") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.SG_CODE.value = arrValue[0];
				form1.SG_NAME.value = arrValue[1];
				
				form1.SKILL_CODE.value = "";
				form1.SKILL_NAME.value = "";
			} // end if
		} else if  (src.indexOf("search_skill") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.SKILL_CODE.value = arrValue[0];
				form1.SKILL_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_type") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				<? if ($BKK_FLAG==1) { ?>
				form1.PT_CODE.value = arrValue[0];
				form1.PT_NAME.value = arrValue[1];
				<? } ?>
			} // end if
		} else if  (src.indexOf("search_condition") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form1.PC_CODE.value = arrValue[0];
				form1.PC_NAME.value = arrValue[1];
			} // end if
		} 		
//		$( "#d_frame" )[0].src="";
//		alert("returnValue="+tt.value);
		tt.value = returnValue;
	} // end if
	
	setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
	/*<?=$alert_adding_command?>*/
</script>
<span id="defaultTheme"></span>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
<? if (!$HEAD_HIDE) { ?>
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE.=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE.=" &gt; ดูข้อมูล";
		include("current_location.html");
?>		</td>
	</tr>
<? } ?>
  	<tr>
    	<td align="left" valign="top"><table width="95%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="30%" cellpadding="1" cellspacing="1" class="input_table" style="border-style:solid;" border="1">  
		  <tr>
		  	<td id="CELL_TOPIC_1" nowrap="nowrap" height="22" align="center" class="<?=($show_topic==1)?"table_body_3":"table_body"?>"><span style="cursor:hand;" onClick="change_div(1);"> <?=$SEARCH_TITLE?>บัญชี</span></td>
			<td  id="CELL_TOPIC_2" nowrap="nowrap" height="22" align="center" class="<?=($show_topic==2)?"table_body_3":"table_body"?>"><span style="cursor:hand;"  onClick="change_div(2);"><!---<? if($VIEW_DTL){ echo "ดู"; }else if($UPD_DTL){ echo "แก้ไข"; }else{ echo "เพิ่ม"; } ?>--->รายละเอียด</span><!-- ($VIEW)?"ดู":"เพิ่ม" --></td>
		  </tr>
	  </table></td>
	</tr>
</table>
<!---SEARCH DTL--->
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
  	<tr>
    	<td align="left" valign="top"><form name="form0" method="post" action="data_improve_position.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="ORD_ID" value="<?=$ORD_ID?>">
          <input type="hidden" name="ORD_CONFIRM" value="<?=$ORD_CONFIRM?>">
		  <input type="hidden" name="show_topic" value="<?=$show_topic?>">
<div id="DIV_TOPIC_1" style="display:<?=($show_topic==1)?"block":"none"?>;"> 
	<? if($err_text){ ?>
<table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<tr><td colspan="4" height="22" align="center" class="label_alert"><?=$err_text?></td></tr>
</table>
	<? } // end if ?>
<table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<tr>
	  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td height="22" align="right"><span class="label_alert">*</span>&nbsp;<?=$MINISTRY_TITLE;?>&nbsp;:&nbsp;</td>
                        <td>
			   	<input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:75%" class="textbox" readonly>
				<input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>">
				<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$UPD){ ?>
				<input type="button" name="btn_ministry" class="button" value="<?=$SELECT_TITLE?>" title="<?=$MINISTRY_SELECT?>" onClick="call_select_ministry();">
             <input name="image" type="image" onClick="form0.MINISTRY_ID.value=''; form0.MINISTRY_NAME.value=''; form0.DEPARTMENT_ID.value=''; form0.DEPARTMENT_NAME.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">                  
				<? } // end if ?>
			   </td>
                        <td align="right"><span class="label_alert">*</span>&nbsp;<?=$DEPARTMENT_TITLE;?>&nbsp;:&nbsp;</td>
                        <td>
			   	<input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:75%" class="textbox" readonly>
				<input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>">
				<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$UPD){ ?>
				<input type="button" name="btn_department" class="button" value="<?=$SELECT_TITLE?>" title="<?=$DEPARTMENT_SELECT?>" onClick="call_select_department();">
                <input name="image" type="image" onClick="form0.DEPARTMENT_ID.value=''; form0.DEPARTMENT_NAME.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">                            
				<? } // end if ?>
			   </td>
                      </tr>
                      <tr> 
                        <td width="11%" height="22" align="right"><span class="label_alert">*</span>&nbsp;<?=$YEAR_TITLE?>&nbsp;:&nbsp;</td>
                        <td width="31%"><input type="text" name="ORD_YEAR" value="<?=$ORD_YEAR?>" class="textbox" onKeyPress="return DigitOnly();" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW)?"":"readonly"?>></td>
                        <td width="11%" align="right"><span class="label_alert">*</span>&nbsp;ครั้งที่&nbsp;:&nbsp;</td>
                        <td width="31%"><input type="text" name="ORD_NO" value="<?=$ORD_NO?>" class="textbox" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW)?"":"readonly"?>></td>
                      </tr>				  
                      <tr> 
                        <td align="right">เรื่อง&nbsp;:&nbsp;</td>
                        <td><input name="ORD_TITLE" type="text" class="textbox" style="width:100%" value="<?=$ORD_TITLE?>" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW)?"":"readonly"?>> </td>
                        <td align="right"><span class="label_alert">*</span>&nbsp;<?=$DOCDATE_TITLE;?>&nbsp;:&nbsp;</td>
                        <td><input name="ORD_DATE" type="text" class="textbox" id="ORD_DATE" value="<?=$ORD_DATE?>" onKeyPress="return DateOnly();" onBlur="changedateformat(form0.ORD_DATE,this.value)" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW)?"":"readonly"?>> 
                          <? if(!$VIEW){ ?>&nbsp;&nbsp; <input type="reset" class="button" onClick="return showCalendar('ORD_DATE', 'dd/mm/y', '<?=$SESS_HOLIDAY?>', 'confirm');" value="<?=$SELECT_TITLE?>"><? } // end if ?>                        </td>
                      </tr>
					  <? if($UPD || $VIEW){ ?>
                      <tr> 
					  	<td></td>
						<td colspan="3">
							<? if ($ORD_CONFIRM==1) {
                            		echo "&nbsp;&nbsp;<font color='red'><B>ยืนยันคำสั่ง</B></font>";
								 } else {
                                 	echo "&nbsp;&nbsp;<font color='#8888FF'>ยังไม่มีการยืนยันคำสั่ง</font>";
								}
							?>
						</td>
                      </tr>
					  <? } // end if ?>   
            <tr>
              <td align="right"><?=$UPDATE_USER_TITLE?>&nbsp;:&nbsp;</td>
              <td><input name="SHOW_UPDATE_USER" type="text" style="width:70%" class="textbox" value="<?=$SHOW_UPDATE_USER?>" readonly></td>
              <td align="right"><?=$UPDATE_DATE_TITLE?>&nbsp;:&nbsp;</td>
              <td><input name="SHOW_UPDATE_DATE" type="text" class="textbox" value="<?=$SHOW_UPDATE_DATE?>" readonly></td>
            </tr>
           <tr align="center">
             <td height="30" colspan="4">
<? if ($ORD_CONFIRM != 1) { ?>
<? if ($UPD || $VIEW) { ?>
		<? if ($PAGE_AUTH["edit"]=="Y" && !$VIEW) {?>
        	<? if ($BUTTON_DISPLAY==1) { ?>
			 	<input name="Submit22" type="submit" class="button" onClick="if(!verify_data('UPDATE')){ return false; }" value="<?=$EDIT_TITLE?>"> 
			 <? } else { ?>
            	<input name="image" type="image" onClick="if(!verify_data('UPDATE')){ return false; }" src="images/save.png" alt="<?=$EDIT_TITLE?>" border="0">
            		&nbsp;&nbsp;&nbsp;
			<? } ?>
			<? if ($BUTTON_DISPLAY==1) { ?>
					<input name="Submit8" style="width:70" type="submit" class="button" onClick="return confirm_command();" value="<?=$COM_CONFIRM_TITLE?>" alt="<?=$COM_CONFIRM_TITLE?>" title="<?=$COM_CONFIRM_TITLE?>">
			<? } else { ?>
					<input name="image2" type="image" onClick="return confirm_command();" src="images/ok.gif" alt="<?=$COM_CONFIRM_TITLE?>">
			<? } echo "&nbsp; &nbsp;"; ?>
		<? } ?> 
		<? if($PAGE_AUTH["del"]=="Y" && !$VIEW) {?>
				<? if ($BUTTON_DISPLAY==1) { ?>
			  		<input name="Submit22" type="button" class="button" onClick="confirm_delete(<?=$ORD_ID?> , '<?="$ORD_YEAR - $ORD_NO - $ORD_TITLE"?>');" value="<?=$DEL_TITLE?>">
				<? } else { ?>
            		<img src="images/delete.gif" alt="<?=$DEL_TITLE?>" width="32" height="32" border="0" onClick="confirm_delete(<?=$ORD_ID?> , '<?="$ORD_YEAR - $ORD_NO - $ORD_TITLE"?>');">
            		&nbsp;&nbsp;&nbsp;
				<?}?> 
		<?}?>
		<? if ($BUTTON_DISPLAY==1) { ?><!--form1.command.value='CANCEL';-->
              <input type="submit" name="Reset2" value="<?=$CANCEL_TITLE?>" onClick="javascript:parent.refresh_opener('1<::><::><::><::>');" class="button" >
		<? } else { ?>
            <input name="image" type="image" onClick="javascript:parent.refresh_opener('1<::><::><::><::>');" src="images/cancel.gif" alt="<?=$CANCEL_TITLE?>" border="0">&nbsp;&nbsp;&nbsp;
        <? }?>
<? } else { ?>
		<? if($PAGE_AUTH["add"]=="Y"){?>
        	<? if ($BUTTON_DISPLAY==1) { ?>
			 	<input name="Submit2" type="submit" class="button" onClick="if(!verify_data('ADD')){ return false; }" value="<?=$ADD_TITLE?>"> 
			 <? } else { ?>
            	<input name="image" type="image" onClick="if(!verify_data('ADD')){ return false; }" src="images/save.png" alt="<?=$ADD_TITLE?>" border="0">
            		&nbsp;&nbsp;&nbsp;
			<?}?> 
		<?}?> 
		<? if ($BUTTON_DISPLAY==1) { ?>
      		  <input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>">  
		<? } else { ?>
            	<img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="32" height="32" border="0" onClick="form1.reset();">&nbsp;&nbsp;&nbsp;
		<? }?>
<? } ?>
<? } ?>
			 </td>
           </tr>
         </table></td>
	</tr>
</table>
        &nbsp;
<?	
	
	$search_condition_bkk_department  = "";
	if ($BKK_FLAG==1 || $MFA_FLAG==1){
		$search_condition_bkk_department = " or DEPARTMENT_ID IS NULL";
	}
	if($search_department_id){
		$arr_search_condition[] = "(DEPARTMENT_ID = $search_department_id)";
	}elseif($search_ministry_id){
		$cmd = " select ORG_ID from PER_ORG where ORG_ID_REF=$search_ministry_id ";
		$db_dpis->send_cmd($cmd);
		while($data = $db_dpis->get_array()) $arr_org[] = $data[ORG_ID];
		$arr_search_condition[] = "(DEPARTMENT_ID in (". implode(",", $arr_org) .") $search_condition_bkk_department )";
	}elseif($PV_CODE){
		$cmd  = " select distinct ORG_ID_REF from PER_ORG where OL_CODE='03' and PV_CODE='$PV_CODE' ";
		$db_dpis->send_cmd($cmd);
		while($data = $db_dpis->get_array()) $arr_org[] = $data[ORG_ID_REF];
		$arr_search_condition[] = "(DEPARTMENT_ID in (". implode(",", $arr_org) .") $search_condition_bkk_department )";
	} // end if

  	if(trim($search_ord_year_min)) $arr_search_condition[] = "(ORD_YEAR >= '$search_ord_year_min')";
  	if(trim($search_ord_year_max)) $arr_search_condition[] = "(ORD_YEAR <= '$search_ord_year_max')";
  	if(trim($search_ord_no_min)) $arr_search_condition[] = "(ORD_NO >= '$search_ord_no_min')";
  	if(trim($search_ord_no_max)) $arr_search_condition[] = "(ORD_NO <= '$search_ord_no_max')";
  	if(trim($search_ord_title)) $arr_search_condition[] = "(ORD_TITLE like '%$search_ord_title%')";
  	if(trim($search_ord_date_min)){ 
		$search_ord_date_min =  save_date($search_ord_date_min);
		if($DPISDB=="oci8") $arr_search_condition[] = "(trim(ORD_DATE) >= '$search_ord_date_min')";
		elseif($DPISDB=="odbc") $arr_search_condition[] = "(trim(ORD_DATE) >= '$search_ord_date_min')";
		elseif($DPISDB=="mysql") $arr_search_condition[] = "(trim(ORD_DATE) >= '$search_ord_date_min')";
		$search_ord_date_min = show_date_format($search_ord_date_min, 1);
	}
  	if(trim($search_ord_date_max)){ 
		$search_ord_date_max =  save_date($search_ord_date_max);
		if($DPISDB=="oci8") $arr_search_condition[] = "(trim(ORD_DATE) <= '$search_ord_date_max')";
		elseif($DPISDB=="odbc") $arr_search_condition[] = "(trim(ORD_DATE) <= '$search_ord_date_max')";
		elseif($DPISDB=="mysql") $arr_search_condition[] = "(trim(ORD_DATE) <= '$search_ord_date_max')";
		$search_ord_date_max = show_date_format($search_ord_date_max, 1);
	}
	$search_condition = "";
	if(count($arr_search_condition)) $search_condition = " where " . implode(" and ", $arr_search_condition);

	$cmd =" select 		count(ORD_ID) as count_data 
					from 		PER_ORDER_POS
					$search_condition
				   ";
	$db_dpis->send_cmd($cmd);
	//$db_dpis->show_error();
	$data = $db_dpis->get_array();
	$data = array_change_key_case($data, CASE_LOWER);
	$count_data = $data[count_data];	
//	echo "$count_data";
?>
<table width="95%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="15%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body"><?=$SEARCH_TITLE?></td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
        <table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
    <tr>
      <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
        <tr>
          <td height="22" align="center"><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                      <tr>
                        <td height="22" align="right"><?=$MINISTRY_TITLE;?>&nbsp;:&nbsp;</td>
                        <td>
			   	<input type="text" name="search_ministry_name" value="<?=$search_ministry_name?>" style="width:75%" class="textbox" readonly>
				<input type="hidden" name="search_ministry_id" value="<?=$search_ministry_id?>">
				<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3){ ?>
				<input type="button" name="btn_search_ministry" class="button" value="<?=$SELECT_TITLE?>" title="<?=$MINISTRY_SELECT?>" onClick="call_search_ministry();">
             <input name="image" type="image" onClick="form0.search_ministry_id.value=''; form0.search_ministry_name.value=''; form0.search_department_id.value=''; form0.search_department_name.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">                  
				<? } // end if ?>
			   </td>
                        <td align="right"><?=$DEPARTMENT_TITLE;?>&nbsp;:&nbsp;</td>
                        <td>
			   	<input type="text" name="search_department_name" value="<?=$search_department_name?>" style="width:75%" class="textbox" readonly>
				<input type="hidden" name="search_department_id" value="<?=$search_department_id?>">
				<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4){ ?>
				<input type="button" name="btn_search_department" class="button" value="<?=$SELECT_TITLE?>" title="<?=$DEPARTMENT_SELECT?>" onClick="call_search_department();">
                <input name="image" type="image" onClick="form0.search_department_id.value=''; form0.search_department_name.value=''; return false;" src="images/icon_clear.gif" alt="ล้างค่า" align="center" width="22" height="22">                  
				<? } // end if ?>
			   </td>
                      </tr>
                      <tr> 
                        <td width="11%" height="22" align="right"><?=$YEAR_TITLE?>&nbsp;:&nbsp;</td>
                        <td width="31%">
						  <input type="text" name="search_ord_year_min" value="<?=$search_ord_year_min?>" size="15" class="textbox" onKeyPress="return DigitOnly();">
						  &nbsp;ถึง&nbsp;
                          <input type="text" name="search_ord_year_max" value="<?=$search_ord_year_max?>" size="15" class="textbox" onKeyPress="return DigitOnly();">						</td>
                        <td width="11%" align="right">ครั้งที่&nbsp;:&nbsp;</td>
                        <td width="31%">
						<input type="text" name="search_ord_no_min" value="<?=$search_ord_no_min?>" size="15" class="textbox">
						&nbsp;ถึง&nbsp;
                        <input type="text" name="search_ord_no_max" value="<?=$search_ord_no_max?>" size="15" class="textbox">						</td>
                      </tr>					  
                      <tr> 
                        <td height="22" align="right">เรื่อง&nbsp;:&nbsp;</td>
                        <td><input name="search_ord_title" type="text" class="textbox" style="width:100%" value="<?=$search_ord_title?>"></td>
                        <td align="right"><?=$DOCDATE_TITLE;?>&nbsp;:&nbsp;</td>
                        <td>
						<input type="text" name="search_ord_date_min" id="search_ord_date_min" value="<?=$search_ord_date_min?>" size="12" class="textbox" onKeyPress="return DateOnly();" onBlur="changedateformat(form0.search_ord_date_min,this.value)"> 
                        &nbsp;&nbsp; <input type="reset" class="button" onClick="return showCalendar('search_ord_date_min', 'dd/mm/y');" value="<?=$SELECT_TITLE?>">
						&nbsp;&nbsp;ถึง&nbsp;&nbsp;
						<input type="text" name="search_ord_date_max" id="search_ord_date_max" value="<?=$search_ord_date_max?>" size="12" class="textbox" onKeyPress="return DateOnly();" onBlur="changedateformat(form0.search_ord_date_max,this.value)"> 
                        &nbsp;&nbsp; <input type="reset" class="button" onClick="return showCalendar('search_ord_date_max', 'dd/mm/y');" value="<?=$SELECT_TITLE?>">                        </td>
                      </tr>
                      <tr> 
                        <td height="22" colspan="4" align="center"><? if ($BUTTON_DISPLAY==1) { ?>
						<input name="Submit3" type="submit" class="button" onClick="return check_valid_date();" value="<?=$SEARCH_TITLE?>">
						<input name="Submit4" type="submit" class="button" onClick="show_all_command();" value="<?=$SHOW_ALL_TITLE?>">
						<? } else { ?>
                <input name="image2" type="image" onClick="return check_valid_date();" src="images/search.png" alt="<?=$SEARCH_TITLE?>">
                &nbsp;&nbsp;&nbsp;
                <input name="image2" type="image" onClick="show_all_command();" src="images/showall.png" alt="<?=$SHOW_ALL_TITLE?>">
                <?}?></td>
                      </tr>
                    </table></td>
        </tr>
      </table></td>
    </tr>
  </table>
<table width="95%" align="center"  border="0" cellspacing="0" cellpadding="0">
    <tr><td>
	<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td><input type="hidden" name="order_by" value="<?=$order_by?>">
    <input type="hidden" name="sort_by" value="<?=$sort_by;?>">
    <input type="hidden" name="sort_type" value="<?=$sort_type?>">
<?=$SORT_TITLE?></td>
</tr>
</table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_body_3">
            <tr>
              <!--td width="15%" height="22"><? if($PAGE_AUTH["print"]=="Y"){ ?><input name="btn_report" type="button" class="button" value="ดูรายงาน" onClick="call_pdf_report();"><? }else{ echo "&nbsp;"; } ?></td-->
              <td align="center" height="22">พบข้อมูล<?=$MENU_TITLE_LV2?>ทั้งสิ้น <?=($count_data + 0)?> รายการ</td>
              <!--td width="15%" align="right"><? if($PAGE_AUTH["print"]=="Y"){ ?><input name="btn_export" type="button" class="button" value="ส่งออกไฟล์" onClick="call_export_file();"><? }else{ echo "&nbsp;"; } ?></td-->
            </tr>
          </table>  
	</td></tr>
</table>
<?

	if(!$sort_by) $sort_by=1;
	if(!$sort_type){	if ($PER_ORDER_BY==1) { $sort_type = "1:asc"; } else {  $sort_type = "1:desc"; }	}
	$arrSort=explode(":",$sort_type);
	$SortType[$arrSort[0]]	=$arrSort[1];
	if(!$order_by) $order_by=1;

	if($order_by==1){	
		$order_str = "ORDER BY ORD_YEAR  ".$SortType[$order_by];
  	}elseif($order_by==2) {	//เลขที่คำสั่ง
		$order_str = "ORDER BY ORD_NO   ".$SortType[$order_by];
  	} elseif($order_by==3) {	//เรื่อง
		$order_str =  "ORDER BY ORD_TITLE   ".$SortType[$order_by];
	}elseif($order_by==4) {	//ลงวันที่
		$order_str = "ORDER BY ORD_DATE ".$SortType[$order_by];
	}elseif($order_by==5) {	//วันที่มีผล
				$order_str = "ORDER BY FML_CARDNO ".$SortType[$order_by];
	}elseif($order_by==6) {	//ยืนยันคำสั่ง
				$order_str = "ORDER BY ORD_CONFIRM ".$SortType[$order_by];
	}

	$total_page = ceil( $count_data / $data_per_page );
	$page_link = create_link_page($total_page, $current_page);
	$limit_data = "";

	if($current_page > 1){
		if($DPISDB=="odbc"){
			$cmd = " select top $start_record ORD_ID from PER_ORDER_POS order by ORD_YEAR, ORD_NO ";
			$db_dpis->send_cmd($cmd);
			while($data = $db_dpis->get_array()) $arr_exclude[] = $data[ORD_ID];
			$limit_data = " and ORD_ID not in (". implode(", ", $arr_exclude) .")";
		} // end if
	} // end if 

	if($DPISDB=="odbc"){
		$cmd = "	select		top $data_per_page 
							ORD_ID, ORD_YEAR, ORD_NO, ORD_TITLE, ORD_DATE, ORD_CONFIRM, DEPARTMENT_ID
							from		PER_ORDER_POS
							$search_condition
							$limit_data
							$order_str
				 	  ";	
	}elseif($DPISDB=="oci8"){
		$min_rownum = (($current_page - 1) * $data_per_page) + 1;
		$max_rownum = $current_page * $data_per_page;

		$cmd = "select 		temp2.* 
						from (
							select 		rownum as rnum, temp1.* 
							from (	
								select		ORD_ID, ORD_YEAR, ORD_NO, ORD_TITLE, ORD_DATE, ORD_CONFIRM, DEPARTMENT_ID
								from		PER_ORDER_POS
								$search_condition
								$order_str 
							) temp1
							where rownum <= $max_rownum
						) temp2 
						where rnum between $min_rownum and $max_rownum
					  ";						
	}elseif($DPISDB=="mysql"){
		$cmd = "	select		ORD_ID, ORD_YEAR, ORD_NO, ORD_TITLE, ORD_DATE, ORD_CONFIRM, DEPARTMENT_ID
							from		PER_ORDER_POS
							$search_condition
							$order_str
							$limit_data
				 	  ";	
	} // end if
	
	$count_page_data = $db_dpis->send_cmd($cmd);
//	echo "cmd=$cmd<br>";
//	$db_dpis->show_error();
	if ($count_page_data) {
?>

  <table width="95%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
    <tr align="center" class="table_head">
	  <td width="5%" height="21"><strong><?=$SEQ_NO_TITLE;?></strong></td>
      <td width="10%" onClick="call_sort(1);"><strong>
        <? if($order_by==1&&$sort_by==1){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
        <?=$YEAR_TITLE?></strong></td>
      <td width="10%" onClick="call_sort(2);"><strong>
        <? if($order_by==2&&$sort_by==2){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
      </strong>        ครั้งที่</td>
      <td onClick="call_sort(3);"><strong>
        <? if($order_by==3&&$sort_by==3){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
        เรื่อง</strong></td>
	  <td width="10%" onClick="call_sort(4);"><strong>
	    <? if($order_by==4&&$sort_by==4){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
	    <?=$DOCDATE_TITLE;?></strong></td>
	  <td width="10%" ><strong><?=$POH_EFFECTIVEDATE_TITLE;?></strong></td>
      <td width="6%" onClick="call_sort(6);"><strong>
        <? if($order_by==6&&$sort_by==6){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
      </strong>        <?=$COM_CONFIRM_TITLE?></td>      
      <td width="4%"><?=$DETAIL_TITLE?></td>      
      <td width="4%"><?=$INQ_TITLE;?></td>
      <?if($PAGE_AUTH["edit"]=="Y"){?>
      <td width="4%"><?=$EDIT_TITLE;?></td>
      <?}?>
      <?if($PAGE_AUTH["del"]=="Y"){?>
      <td width="4%"><?=$DEL_TITLE;?></td>
      <?}?>	  
    </tr>
    <?
	$current_list = "";
	$data_count = 0;
	while ($data = $db_dpis->get_array()) {
		$data_count++;
		if($data_count > $data_per_page) break;
		$TMP_ORD_ID = $data[ORD_ID];
		$current_list .= ((trim($current_list))?",":"") . $TMP_ORD_ID;
		$TMP_ORD_NO = $data[ORD_NO];
		$TMP_ORD_YEAR = $data[ORD_YEAR];
		$TMP_ORD_TITLE = $data[ORD_TITLE];
		$TMP_ORD_DATE = show_date_format($data[ORD_DATE], $DATE_DISPLAY);
		$TMP_ORD_CONFIRM = $data[ORD_CONFIRM];

		$TMP_DEPARTMENT_ID = $data[DEPARTMENT_ID];
		$cmd = " select ORG_ID_REF from PER_ORG where ORG_ID=$TMP_DEPARTMENT_ID ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$TMP_MINISTRY_ID = $data2[ORG_ID_REF];
		
		$cmd = " select ORD_EFF_DATE from PER_ORDER_POS_DTL where ORD_ID=$TMP_ORD_ID ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$TMP_ORD_EFF_DATE = show_date_format($data[ORD_EFF_DATE], $DATE_DISPLAY);

		$returnValue = "$TMP_ORD_ID<::><::>$TMP_ORD_CONFIRM";

		$cmd = "select count(ORD_ID) as COUNT_ORDER_DTL from PER_ORDER_POS_DTL where ORD_ID=$TMP_ORD_ID ";
		$count_comdtl = $db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$TMP_COUNT_ORDER_DTL = trim($data2[COUNT_ORDER_DTL]);

		$class = "table_body";
		$onmouse_event = " onMouseOver=\"this.className='table_body_over';\" onMouseOut=\"this.className='table_body';\" ";
		if($ORD_ID==$TMP_ORD_ID){ 
			$class = "table_body_over";
			$onmouse_event = "";
		} // end if		
?>
          <tr class="<?=$class?>" <?=$onmouse_event?>> 
             <td height="25" align="center"><?=$data_count?></td>
			<td align="center"><?=$TMP_ORD_YEAR?></td>
    	  	<td>&nbsp;<?=$TMP_ORD_NO?></td>
			<td>&nbsp;<?=$TMP_ORD_TITLE?></td>
			<td align="center"><?=$TMP_ORD_DATE?></td>
			<td align="center"><?=$TMP_ORD_EFF_DATE?></td>
			<td align="center">
<!--            	<input type="checkbox" name="list_confirm_id[]" value="<?=$TMP_ORD_ID?>" <?=($TMP_ORD_CONFIRM==1)?"checked disabled":"disabled"?>>-->
					<? if ($TMP_ORD_CONFIRM==1) { ?> <img src="images/true.gif" border="0"> 
					<? } else { ?> <img src="images/false.gif" border="0"> <? } ?>
			&nbsp;(<?=$TMP_COUNT_ORDER_DTL?>)
			</td>
	  	<? $returnValueA=""; $UPD='?UPD=1';	$returnValueA="2<::>".$returnValue."<::>$UPD<::>"; ?>
      	<td align="center"><a href="<?=("javascript:form1.action+='?UPD_DTL=1';form1.ORD_ID.value='$TMP_ORD_ID';form1.ORD_CONFIRM.value='$TMP_ORD_CONFIRM';form1.ORD_SEQ.value='1';form1.ORD_POS_NO.value='$ORD_POS_NO';form1.current_page.value=1;form1.show_topic.value=2;form1.submit()")?>"><img src="images/desc.gif" alt="ดูรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่ง" width="24" height="24" border="0"></a></td>     
	  	<? $returnValueA=""; $VIEW='?VIEW=1';	$returnValueA="1<::>".$returnValue."<::>$VIEW<::>!"; ?>
      <td align="center"><a href="<?=("javascript:form0.action+='?VIEW=1';form0.ORD_ID.value='$TMP_ORD_ID';form0.ORD_CONFIRM.value='$TMP_ORD_CONFIRM';form0.current_page.value=1;form0.show_topic.value=1;form0.submit()")?>"><img src="images/icon_eye.gif" alt="ดูข้อมูลบัญชีคำสั่งปรับปรุงตำแหน่ง" width="16" height="16" border="0"></a></td> 
	  <?if($PAGE_AUTH["edit"]=="Y"){?>
      <td align="center">
	  &nbsp;
	  <? if(!$TMP_ORD_CONFIRM){ ?>
		<? $returnValueA="";  $UPD='?UPD=1';	$returnValueA="1<::>".$returnValue."<::>$UPD<::>!";  ?>
	  <a href="<?=("javascript:form0.action+='?UPD=1';form0.ORD_ID.value='$TMP_ORD_ID';form0.ORD_CONFIRM.value='$TMP_ORD_CONFIRM';form0.current_page.value=1;form0.show_topic.value=1;form0.submit()")?>"><img src="images/b_edit.png" border="0" alt="แก้ไขข้อมูล"></a>
	  <? } // end if ?>	  </td>
	  <?}?>
	  <?if($PAGE_AUTH["del"]=="Y"){?>
      <td align="center">
	  &nbsp;
	  <? if(!$TMP_ORD_CONFIRM){ ?>
	  <a href="<?=("javascript:confirm_delete(".$TMP_ORD_ID.", '$TMP_ORD_YEAR - $TMP_ORD_NO - $TMP_ORD_TITLE')")?>"><img src="images/b_drop.png" border="0" alt="ลบข้อมูล"></a>
	  <? } // end if ?>	  </td>
	  <?}?>
			
	  </tr>
    <? } ?>
	<?if($PAGE_AUTH["edit"]=="Y"){?>
    <tr class="table_footer" height="21">
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td align="center"><!--input name="Submit3" type="button" class="button" onClick="confirm_data();" value="ยืนยัน"--></td>
      <td>&nbsp;</td>     
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <?if($PAGE_AUTH["edit"]=="Y"){?><td>&nbsp;</td><?}?>
      <?if($PAGE_AUTH["del"]=="Y"){?><td>&nbsp;</td><?}?>	  	  
    </tr>
	<?}?>
  </table>
  <? if($total_page > 1) : ?>
  <table width="95%" border="0" align="center" cellpadding="2" cellspacing="2" class="label_normal">
    <tr>
      <td align="center"><?=$page_link?></td>
    </tr>
  </table>
        <? endif; ?>
        &nbsp; 
        <? } // if  count show ?>
        <input type="hidden" name="current_list" value="<?=$current_list?>">
        </div>
        </form>	
		</td>
	</tr>
</table>
<!---ADD DTL--->
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="data_improve_position.html" enctype="multipart/form-data" onSubmit="return check(this);">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="ORD_ID" value="<?=$ORD_ID?>">
          <input type="hidden" name="ORD_CONFIRM" value="<?=$ORD_CONFIRM?>">
          <input type="hidden" name="POS_ID_OLD" value="<?=$POS_ID_OLD?>">
		   <input type="hidden" name="show_topic" value="<?=$show_topic?>">
 
		<input type="hidden" name="VIEW_DTL" value="<?=$VIEW_DTL?>">
		<input type="hidden" name="UPD_DTL" value="<?=$UPD_DTL?>">
<div id="DIV_TOPIC_2" style="display:<?=($show_topic==2)?"block":"none" ?>">
   <table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<? if($err_text){ ?>
	<tr><td colspan="4" height="22" align="center" class="label_alert"><?=$err_text?></td></tr>
	<? } // end if ?>
	<tr>
		<td width="20%" align="right"><span class="label_alert">*</span>&nbsp;<?=$SEQ_NO_TITLE?>&nbsp;:&nbsp;</td>
		<td width="30%"><input type="text" class="textbox" name="ORD_SEQ" value="<?=$ORD_SEQ?>" readonly></td>
		<td width="20%" align="right"><span class="label_alert">*</span>&nbsp;<?=$POS_NO_TITLE?>&nbsp;:&nbsp;</td>
		<td width="30%">
		<? if ($POSITION_NO_CHAR=="Y") { ?>
		<input type="text" name="ORD_POS_NO_NAME" value="<?=$ORD_POS_NO_NAME; ?>" style="width:20%"  readonly="true">
		<? } ?>
		<input type="text" class="textbox" name="ORD_POS_NO" value="<?=$ORD_POS_NO?>" style="width:60%"  readonly="true">
		
		  <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		  <input type="button" name="Input" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_position()">
		  <? } // end if ?>        </td>
	</tr>
	<tr>
		<td width="20%" align="right">ผลการพิจารณาของคณะกรรมการ&nbsp;:&nbsp;</td>
		<td width="30%">
		<? $ORD_RESULT = (!isset($ORD_RESULT))?  $ORD_RESULT : 1; ?>
			<input type="checkbox" name="ORD_RESULT" value="1" onClick="if(this.checked){ form1.ORD_RESULT[1].checked = false; }" <?=($ORD_RESULT==1 && $ORD_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;ผ่าน&nbsp;&nbsp;
			<input type="checkbox" name="ORD_RESULT" value="0" onClick="if(this.checked){ form1.ORD_RESULT[0].checked = false; }" <?=($ORD_RESULT==0 && $ORD_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;ไม่ผ่าน		</td>
		<td width="20%" align="right">ผลการพิจารณาของ อ.ก.พ. กระทรวง&nbsp;:&nbsp;</td>
		<td width="30%">
		<? $ORD_DTL_RESULT = (!isset($ORD_DTL_RESULT))?  $ORD_DTL_RESULT : 1; ?>
			<input type="checkbox" name="ORD_DTL_RESULT" value="1" onClick="if(this.checked){ form1.ORD_DTL_RESULT[1].checked = false; }" <?=($ORD_DTL_RESULT==1 && $ORD_DTL_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;อนุมัติ&nbsp;&nbsp;
			<input type="checkbox" name="ORD_DTL_RESULT" value="0" onClick="if(this.checked){ form1.ORD_DTL_RESULT[0].checked = false; }" <?=($ORD_DTL_RESULT==0 && $ORD_DTL_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;ไม่อนุมัติ		</td>
	</tr>
	<tr>
		<td width="20%" align="right">ครั้งที่&nbsp;:&nbsp;</td>
		<td width="30%">
			<input type="text" class="textbox" name="ORD_DTL_NO" id="ORD_DTL_NO" value="<?=$ORD_DTL_NO?>" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>>
					</td>
		<td width="20%" align="right">วันที่&nbsp;:&nbsp;</td>
		<td width="30%">
			<input type="text" class="textbox" name="ORD_DTL_DATE" id="ORD_DTL_DATE" value="<?=$ORD_DTL_DATE?>" onKeyPress="return DateOnly();" onBlur="changedateformat(form1.ORD_EFF_DATE,this.value)" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>>
			<? if(!$VIEW_DTL && !$ORD_CONFIRM){ ?>&nbsp;&nbsp;<input type="button" class="button" value="<?=$SELECT_TITLE?>" onClick="return showCalendar('ORD_DTL_DATE', 'dd/mm/y', '<?=$SESS_HOLIDAY?>', 'confirm');"><? } // end if ?>		</td>
	</tr>
    <tr>
     <td height="5" colspan="4" align="center"><iframe src="javascript:;" id="PROCESS_IFRAME" frameborder="0" height="5" scrolling="no">PROCESS IFRAME</iframe></td>
    </tr>
	<tr>
	  <td height="22" colspan="4" align="center">
        <? if($VIEW_DTL){ ?>
        <?}?>
		<? if(!$ORD_CONFIRM){ ?>
		<? if($UPD_DTL || $VIEW_DTL){ ?>
		  <? if($PAGE_AUTH["edit"]=="Y" && !$VIEW_DTL){?>
		  <?	if ($BUTTON_DISPLAY==1) { ?>
		       <input name="Submit22" type="submit" class="button" onClick="form1.command.value='UPDATE';" value="<?=$EDIT_TITLE?>">
		  <? } else { ?>
          	   <input name="image" type="image" onClick="form1.command.value='UPDATE'" src="images/save.png" alt="<?=$EDIT_TITLE?>" border="0">
            	&nbsp;&nbsp;&nbsp;
           <?}?>
		<?}?>
		<?if($PAGE_AUTH["del"]=="Y" && !$VIEW_DTL){?>
		<?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Submit22" type="button" class="button" onClick="confirm_delete_dtl(<?=$ORD_SEQ?> , '<?="$ORD_POS_NO - $ORD_PL_NAME"?>');" value="<?=$DEL_TITLE?>">
		<? } else { ?>
	  	<img src="images/delete.gif" alt="<?=$DEL_TITLE?>" width="32" height="32" border="0" onClick="confirm_delete_dtl(<?=$ORD_SEQ?> , '<?="$ORD_POS_NO - $ORD_PL_NAME"?>');">&nbsp;&nbsp;&nbsp;
		<? } ?>
		<?}?>
           <? if ($BUTTON_DISPLAY==1) { ?>
		<input type="button" name="Reset2" value="<?=$CANCEL_TITLE?>" onClick="form1.command.value='CANCEL'; form1.ORD_SEQ.value=''; form1.UPD_DTL.value=''; form1.VIEW_DTL.value=''; form1.show_topic.value='2'; form1.submit();" class="button" >
		   <? } else { ?>
            <input name="image" type="image" onClick="form1.command.value='CANCEL'; form1.ORD_SEQ.value=''; form1.UPD_DTL.value=''; form1.VIEW_DTL.value=''; form1.show_topic.value='2'; form1.submit();" src="images/cancel.gif" alt="<?=$CANCEL_TITLE?>" border="0">
            &nbsp;&nbsp;&nbsp;
          <? }?>
		<? }else{ ?>
		<?if($PAGE_AUTH["add"]=="Y"){?>
		<?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Submit2" type="submit" class="button" onClick="form1.command.value='ADD';" value="<?=$ADD_TITLE?>">
		<? } else { ?>
            		<input name="image" type="image" onClick="form1.command.value='ADD'" src="images/save.png" alt="<?=$ADD_TITLE?>" border="0">
            		&nbsp;&nbsp;&nbsp;
	  		  		<?}?> 
		<?}?>
		<?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>" onClick="disable_form_button(true);">
		<? } else { ?>
            	<img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="32" height="32" border="0" onClick="disable_form_button(true); form1.reset();">&nbsp;&nbsp;&nbsp;
				<?}?>
		<? } // end if ?>
		<? } // end if ?>	  </td>
	  </tr>	
	</table>	
	
	<div id="POSITION_DETAIL" style="display:<?=($UPD_DTL || $VIEW_DTL)?"block":"none"?>">
	<table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<tr>
	  <td width="20%" height="22" align="right">&nbsp;</td>
	  <td width="40%" align="center" class="table_body">ตำแหน่งก่อนปรับปรุง</td>
	  <td align="center" class="table_body_2">ตำแหน่งหลังปรับปรุง</td>
	</tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$OFF_TYPE_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_OT_NAME" value="<?=$OLD_OT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="OT_NAME" value="<?=$OT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_off_type" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_off_type()">\
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OT_NAME.value=''; form1.OT_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="OT_CODE" value="<?=$OT_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$PL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PL_NAME" value="<?=$OLD_PL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PL_NAME" value="<?=$PL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_line" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_perline()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PL_NAME.value=''; form1.PL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="PL_CODE" value="<?=$PL_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PM_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PM_NAME" value="<?=$OLD_PM_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PM_NAME" value="<?=$PM_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_mgt" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_mgt()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PM_NAME.value=''; form1.PM_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="PM_CODE" value="<?=$PM_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$CL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_CL_NAME" value="<?=$OLD_CL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="CL_NAME" value="<?=$CL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_co_level" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_co_level()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.CL_NAME.value=''; form1.CL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="CL_CODE" value="<?=$CL_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$LEVEL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_LEVEL_NAME" value="<?=$OLD_LEVEL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
				<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM) { ?>
		        <input type="hidden" name="LEVEL_NAME" value="<?=$LEVEL_NAME?>">
				<select class="selectbox" name="LEVEL_NO">
				  <option value="" <?=($LEVEL_NO=="")?"selected":""?>>== <?=$LEVEL_TITLE?> ==</option>
				  <?
				  if ($ISCS_FLAG==1) $where = "and LEVEL_NO in $LIST_LEVEL_NO"; 
				  	$cmd = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where PER_TYPE = 1 and LEVEL_ACTIVE = 1 $where order by LEVEL_SEQ_NO ";
					$db_dpis->send_cmd($cmd);
					while($data = $db_dpis->get_array()){					
						$TMP_LEVEL_NO = $data[LEVEL_NO];
						$TMP_LEVEL_NAME = $data[LEVEL_NAME];
				  ?>
				  <option value="<?=$TMP_LEVEL_NO?>" <?=(trim($LEVEL_NO)==trim($TMP_LEVEL_NO))?"selected":""?>><?=$TMP_LEVEL_NAME?></option>
				  <?
				  	} // end while
				  ?>
				</select> 
				<? } else { ?>
				<input type="text" name="LEVEL_NAME" value="<?=$LEVEL_NAME?>" style="width:80%" class="textbox" readonly>
				<? } ?>			  
			  </td>
	  </tr>
		<? if ($BKK_FLAG==1) { ?>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$PT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PT_NAME" value="<?=$OLD_PT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PT_NAME" value="<?=$PT_NAME?>" style="width:80%" class="textbox"  readonly="true"><input type="hidden" name="PT_CODE" value="<?=$PT_CODE?>">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_per_type" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_type()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PT_NAME.value=''; form1.PT_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		</td>
	  </tr>
			<? } ?>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$SG_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_SG_NAME" value="<?=$OLD_SG_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="SG_NAME" value="<?=$SG_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_skill_group" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_skill_group()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.SG_NAME.value=''; form1.SG_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="SG_CODE" value="<?=$SG_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$SKILL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_SKILL_NAME" value="<?=$OLD_SKILL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="SKILL_NAME" value="<?=$SKILL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_skill" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_skill()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.SKILL_NAME.value=''; form1.SKILL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="SKILL_CODE" value="<?=$SKILL_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PC_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PC_NAME" value="<?=$OLD_PC_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PC_NAME" value="<?=$PC_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_condition" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_condition()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PC_NAME.value=''; form1.PC_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
        <input type="hidden" name="PC_CODE" value="<?=$PC_CODE?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3">&nbsp;</td>
	  <td><textarea name="OLD_POS_CONDITION" rows="3" class="selectbox" style="width:90%" readonly="true"><?=$OLD_POS_CONDITION?></textarea></td>
	  <td><textarea name="ORD_CONDITION" rows="3" class="selectbox" style="width:80%" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>><?=$ORD_CONDITION?></textarea></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$SALARY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_POS_SALARY" value="<?=$OLD_POS_SALARY?>" style="width:90%" class="textbox" readonly="true"></td>
	  <td><input type="text" name="ORD_SALARY" value="<?=$ORD_SALARY?>" style="width:80%" class="textbox" onKeyPress="return NumOnly();" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$MGTSALARY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_POS_MGTSALARY" value="<?=$OLD_POS_MGTSALARY?>" style="width:90%" class="textbox" readonly="true"></td>
	  <td><input type="text" name="ORD_MGTSALARY" value="<?=$ORD_MGTSALARY?>" style="width:80%" class="textbox" onKeyPress="return NumOnly();" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$MINISTRY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_MINISTRY_NAME" value="<?=$OLD_MINISTRY_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_ministry" value="<?=$SELECT_TITLE?>" class="button" onClick="call_select_ministry1()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.MINISTRY_NAME.value=''; form1.MINISTRY_ID.value=''; form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value=''; form1.ORG_NAME.value=''; form1.ORG_ID.value='';  form1.ORG_NAME_1.value=''; form1.ORG_ID_1.value=''; form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">  
		<? } // end if ?>
		<input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>">			  
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$DEPARTMENT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_DEPARTMENT_NAME" value="<?=$OLD_DEPARTMENT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_department" value="<?=$SELECT_TITLE?>" class="button" onClick="call_select_department1()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.DEPARTMENT_NAME.value=''; form1.DEPARTMENT_ID.value='';form1.ORG_NAME.value=''; form1.ORG_ID.value=''; form1.ORG_NAME_1.value=''; form1.ORG_ID_1.value=''; form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">  
		<? } // end if ?>
		<input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>">			 
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME" value="<?=$OLD_ORG_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME" value="<?=$ORG_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($SESS_USERGROUP_LEVEL < 5 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME.value=''; form1.ORG_ID.value=''; form1.ORG_NAME_1.value=''; form1.ORG_ID_1.value=''; form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; return false;" align="center" alt="ล้างค่า">  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID" value="<?=$ORG_ID?>">	
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE1?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_1" value="<?=$OLD_ORG_NAME_1?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_1" value="<?=$ORG_NAME_1?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org_1" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_1()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_1.value=''; form1.ORG_ID_1.value=''; form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID_1" value="<?=$ORG_ID_1?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE2?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_2" value="<?=$OLD_ORG_NAME_2?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_2" value="<?=$ORG_NAME_2?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org_2" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_2()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID_2" value="<?=$ORG_ID_2?>">
		</td>
	  </tr>
<? if($SESS_ORG_SETLEVEL==5) { ?>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE3?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_3" value="<?=$OLD_ORG_NAME_3?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_3" value="<?=$ORG_NAME_3?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org_3" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_3()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID_3" value="<?=$ORG_ID_3?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE4?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_4" value="<?=$OLD_ORG_NAME_4?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_4" value="<?=$ORG_NAME_4?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org_4" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_4()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID_4" value="<?=$ORG_ID_4?>">
		</td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE5?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_5" value="<?=$OLD_ORG_NAME_5?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_5" value="<?=$ORG_NAME_5?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM){ ?>
		<input type="button" name="btn_org_5" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_5()">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  
		<? } // end if ?>
		<input type="hidden" name="ORG_ID_5" value="<?=$ORG_ID_5?>">
		</td>
	  </tr>
<? } ?>				
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$CT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_CT_NAME" value="<?=$OLD_CT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="CT_NAME" value="<?=$CT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="CT_CODE" value="<?=$CT_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PV_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PV_NAME" value="<?=$OLD_PV_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PV_NAME" value="<?=$PV_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="PV_CODE" value="<?=$PV_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$AP_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_AP_NAME" value="<?=$OLD_AP_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="AP_NAME" value="<?=$AP_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="AP_CODE" value="<?=$AP_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3">สังกัด&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_OT_NAME" value="<?=$OLD_ORG_OT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_OT_NAME" value="<?=$ORG_OT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="ORG_OT_CODE" value="<?=$ORG_OT_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$REMARK_TITLE?>&nbsp;:&nbsp;</td>
	  <td><textarea name="OLD_POS_REMARK" rows="3" class="selectbox" style="width:90%" readonly="true"><?=$OLD_POS_REMARK?></textarea></td>
	  <td><textarea name="ORD_REMARK" rows="3" class="selectbox" style="width:80%" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW_DTL && !$ORD_CONFIRM)?"":"readonly"?>><?=$ORD_REMARK?></textarea></td>
	  </tr>
            <tr>
              <td align="right"><?=$UPDATE_USER_TITLE?>&nbsp;:&nbsp;</td>
              <td><input name="SHOW_UPDATE_USER" type="text" style="width:70%" class="textbox" value="<?=$SHOW_UPDATE_USER?>" readonly></td>
              <td align="left"><?=$UPDATE_DATE_TITLE?>&nbsp;:&nbsp;
              <input name="SHOW_UPDATE_DATE" type="text" class="textbox" value="<?=$SHOW_UPDATE_DATE?>" readonly></td>
            </tr>
	</table>
	</div>
<?
	$cmd =" select 		count(ORD_SEQ) as count_data
					from 		PER_ORDER_POS_DTL
					where		ORD_ID=$ORD_ID ";
	$db_dpis->send_cmd($cmd);
//	$db_dpis->show_error();
	$data = $db_dpis->get_array();
	$data = array_change_key_case($data, CASE_LOWER);
	$count_data = $data[count_data];	
//echo "$count_data :: $cmd";
?>
<table width="95%" border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td><input type="hidden" name="order_by" value="<?=$order_by?>"><input type="hidden" name="sort_by" value="<?=$sort_by;?>">
<input type="hidden" name="sort_type" value="<?=$sort_type?>">
<?=$SORT_TITLE?></td>
</tr>
</table>
    <table width="95%" align="center"  border="0" cellspacing="0" cellpadding="0">
	<tr><td align="right"></td></tr>
    <tr><td>
	<table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_body_3">
            <tr>
              <td width="25%" height="22">
			  	<? if($PAGE_AUTH["print"]=="Y"){ ?>
                 <? if ($BUTTON_DISPLAY==1) { ?>
              <input name="btn_report" type="button" class="button" style="width:150" value="<?=$PDF_TITLE?>" onClick="call_rtf_pdf_report(0);">
			                        <? if ($RTF_FLAG==1) { ?>
			    <input name="btn21" type="button" class="button" style="width:150" value="<?=$RTF_TITLE?>" onClick="call_rtf_pdf_report(1);">    
				                      <? } ?>    
              <?  } else { ?>
               <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$PDF_TITLE?>" onClick="call_rtf_pdf_report(0);">
			                      <? if ($RTF_FLAG==1) { ?>
				<img src="images/doc_icon_word.jpg" border="0" alt="<?=$RTF_TITLE?>" onClick="call_rtf_pdf_report(1);">    
				                  <? } ?>    
               <? } ?>    
	          <? }else{ echo "&nbsp;"; } ?></td>
              <td align="center" height="22">พบข้อมูลรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่งทั้งสิ้น <?=($count_data + 0)?> รายการ</td>
              <td width="25%" align="right">
			  	<? if($PAGE_AUTH["print"]=="Y"){ ?>
			  	<? if ($BUTTON_DISPLAY==1) { ?>
                <input name="btn_export" type="button" class="button" style="width:130" value="<?=$EXCEL_TITLE?>" onClick="call_export_file();">
                <?  } else { ?>
                <img src="images/doc_icon_excel.jpg" border="0" alt="<?=$EXCEL_TITLE?>" onClick="call_export_file();">
                <? } ?>                <? }else{ echo "&nbsp;"; } ?>              </td>
			</tr>
          </table>  
	</td></tr>
</table>   
<?
	$order_str = "";
	$sort_by = (isset($sort_by))?  $sort_by : 1;
	$sort_type = (isset($sort_type))?  $sort_type : "1:asc";
	$arrSort=explode(":",$sort_type);
	$SortType[$arrSort[0]]	=$arrSort[1];
  	$order_by = (isset($order_by))?  $order_by : 1;
	if($order_by==1){	// เลขที่ตำแหน่ง
	if($DPISDB=="odbc"){  $order_str = "order by  IIf(IsNull(ORD_POS_NO), 0, CLng(ORD_POS_NO)) $SortType[$order_by]";
	}elseif($DPISDB=="oci8"){ $order_str = "order by  to_number(replace(ORD_POS_NO,'-','')) $SortType[$order_by]"; }
	}elseif($order_by==2) {	//ตำแหน่งในสายงาน
		$order_str = "order by  PL_CODE ".$SortType[$order_by];
  	} elseif($order_by==3) {	//ตำแหน่งในการบริหารงาน
		$order_str = "order by  PM_CODE $SortType[$order_by]";
  	}elseif($order_by==4) {	//ลำดับที่
		$order_str = "order by  ORD_SEQ $SortType[$order_by]";
  	}

	$total_page = ceil( $count_data / $data_per_page );
	$page_link = create_link_page($total_page, $current_page);
	$limit_data = "";

	if($current_page > 1){
		if($DPISDB=="odbc"){
			$cmd = " select top $start_record ORD_SEQ from PER_ORDER_POS_DTL where ORD_ID=$ORD_ID order by ORD_SEQ ";
			$db_dpis->send_cmd($cmd);
			while($data = $db_dpis->get_array()) $arr_exclude[] = $data[ORD_SEQ];
			$limit_data = " and ORD_SEQ not in (". implode(", ", $arr_exclude) .")";
		}elseif($DPISDB=="mysql"){
			$limit_data = " limit " . (($current_page - 1) * $data_per_page) . ", " . $data_per_page;
		} // end if
	} // end if 

	if($DPISDB=="odbc"){
		$cmd = " select		top $data_per_page 
										ORD_SEQ, ORD_POS_NO_NAME, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT, LEVEL_NO, POS_ID_OLD 
						from		PER_ORDER_POS_DTL
						where		ORD_ID=$ORD_ID
										$limit_data
							$order_str 	";	
	}elseif($DPISDB=="oci8"){
		$min_rownum = (($current_page - 1) * $data_per_page) + 1;
		$max_rownum = $current_page * $data_per_page;

		$cmd = "select 		temp2.* 
						from (
							select 		rownum as rnum, temp1.*
							from (	
								select		ORD_SEQ, ORD_POS_NO_NAME, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT, LEVEL_NO, POS_ID_OLD 
								from		PER_ORDER_POS_DTL
								where		ORD_ID=$ORD_ID
									$order_str  
							) temp1
							where rownum <= $max_rownum
						) temp2
						where rnum between $min_rownum and $max_rownum   ";						
	}elseif($DPISDB=="mysql"){
		$cmd = " select		ORD_SEQ, ORD_POS_NO_NAME, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT, LEVEL_NO, POS_ID_OLD 
						from		PER_ORDER_POS_DTL
						where		ORD_ID=$ORD_ID
										$limit_data
							$order_str 	";	
	} // end if
	
	$count_page_data = $db_dpis->send_cmd($cmd);
//	$db_dpis->show_error();
	if ($count_page_data) {
?>
        <table width="95%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
          <tr align="center" class="table_head"> 
            <td width="7%" height="25" onClick="call_sort(4);"><strong>
              <? if($order_by==4&&$sort_by==4){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$SEQ_NO_TITLE?></strong></td>
            <td height="25" onClick="call_sort(1);"><strong>
              <? if($order_by==1&&$sort_by==1){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$POS_NO_TITLE?></strong></td>
            <td width="32%" onClick="call_sort(2);"><strong>
              <? if($order_by==2&&$sort_by==2){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            ตำแหน่งก่อนปรับปรุง</strong></td>
            <td width="32%" onClick="call_sort(3);"><strong>
              <? if($order_by==3&&$sort_by==3){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            ตำแหน่งหลังปรับปรุง</strong></td>
	     <td width="4%"><?=$INQ_TITLE?></td>
	       <?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?>
	       <td width="4%"><?=$EDIT_TITLE?></td>
	       <?}?>
      		<?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?>
      		<td width="4%"><?=$DEL_TITLE?></td>
      		<?}?>
          </tr>
          <?
	$current_list = "";
	$data_count = 0;
	while ($data = $db_dpis->get_array()) {
		$data_count++;
		if($data_count > $data_per_page) break;
		$TMP_ORD_SEQ = $data[ORD_SEQ];
		$current_list .= ((trim($current_list))?",":"") . $TMP_ORD_SEQ;
		$TMP_ORD_POS_NO = $data[ORD_POS_NO_NAME].$data[ORD_POS_NO];

		$TMP_PL_CODE = $data[PL_CODE];
		if($TMP_PL_CODE){
			$cmd = " select PL_NAME from PER_LINE where PL_CODE='$TMP_PL_CODE' ";
			$db_dpis2->send_cmd($cmd);
			$data2 = $db_dpis2->get_array();
			$TMP_PL_NAME = $data2[PL_NAME];
		} // end if
		
		$TMP_PM_CODE = $data[PM_CODE];
		if($TMP_PM_CODE){
			$cmd = " select PM_NAME from PER_MGT where PM_CODE='$TMP_PM_CODE' ";
			$db_dpis2->send_cmd($cmd);
			$data2 = $db_dpis2->get_array();
			$TMP_PM_NAME = $data2[PM_NAME];
		} // end if

		$TMP_LEVEL_NO = $data[LEVEL_NO];
		if($TMP_LEVEL_NO){
			$cmd = " select POSITION_LEVEL from PER_LEVEL where LEVEL_NO='$TMP_LEVEL_NO' ";
			$db_dpis2->send_cmd($cmd);
			$data2 = $db_dpis2->get_array();
			$TMP_LEVEL_NAME = $data2[POSITION_LEVEL];
		}

		$TMP_ORD_RESULT = $data[ORD_RESULT];
		$TMP_POS_ID_OLD = $data[POS_ID_OLD];
		
		$cmd = " select 	PL_CODE, PM_CODE, LEVEL_NO
						 from 		PER_POSITION 
						 where 	POS_ID=$TMP_POS_ID_OLD ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();

		$OLD_PL_CODE = $data2[PL_CODE];
		$OLD_PM_CODE = $data2[PM_CODE];
		$OLD_LEVEL_NO = $data2[LEVEL_NO];
		$cmd = " select PL_NAME from PER_LINE where PL_CODE='$OLD_PL_CODE' ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$OLD_PL_NAME = $data2[PL_NAME];

		$cmd = " select PM_NAME from PER_MGT where PM_CODE='$OLD_PM_CODE' ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$OLD_PM_NAME = $data2[PM_NAME];

		$cmd = " select POSITION_LEVEL from PER_LEVEL where LEVEL_NO='$OLD_LEVEL_NO' ";
		$db_dpis2->send_cmd($cmd);
		$data2 = $db_dpis2->get_array();
		$OLD_LEVEL_NAME = $data2[POSITION_LEVEL];

		$class = "table_body";
		$onmouse_event = " onMouseOver=\"this.className='table_body_over';\" onMouseOut=\"this.className='table_body';\" ";
		if($ORD_SEQ==$TMP_ORD_SEQ){ 
			$class = "table_body_over";
			$onmouse_event = "";
		} // end if		
?>
          <tr class="<?=$class?>" <?=$onmouse_event?>> 
            <td height="25" align="center"><?=$TMP_ORD_SEQ?></td>
            <td>&nbsp;<?=$TMP_ORD_POS_NO?></td>
            <td>&nbsp;
              <?=$OLD_PL_NAME.$OLD_LEVEL_NAME?><br>&nbsp;<?=$OLD_PM_NAME?></td>
            <td>&nbsp;<?=$TMP_PL_NAME.$TMP_LEVEL_NAME?><br>&nbsp;<?=$TMP_PM_NAME?></td>  
			  <td align="center">&nbsp; <a href="<?=("javascript:form1.action+='?VIEW_DTL=1';form1.ORD_SEQ.value='$TMP_ORD_SEQ';form1.ORD_POS_NO.value='$TMP_ORD_POS_NO';form1.current_page.value=1;form1.show_topic.value=2;form1.submit()")?>"><img src="images/icon_eye.gif" alt="ดูรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่ง" width="16" height="16" border="0"></a>
<!--			<a href="<?="javascript:parent.refresh_opener('2<::>!<::>$TMP_ORD_SEQ<::>!<::>!<::>?VIEW_DTL=1');"?>"><img src="images/icon_eye.gif" alt="ดูรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่ง" width="16" height="16" border="0"></a>-->			  </td>
			<?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?>
			  <td align="center">&nbsp; <a href="<?=("javascript:form1.action+='?UPD_DTL=1';form1.ORD_SEQ.value='$TMP_ORD_SEQ';form1.ORD_POS_NO.value='$TMP_ORD_POS_NO';form1.current_page.value=1;form1.show_topic.value=2;form1.submit()")?>"><img src="images/b_edit.png" border="0" alt="แก้ไขข้อมูล"></a>
<!--		<a href="<?="javascript:parent.refresh_opener('2<::>!<::>$TMP_ORD_SEQ<::>!<::>!<::>?UPD_DTL=1');"?>"><img src="images/b_edit.png" border="0" alt="แก้ไขข้อมูล"></a>-->              </td>
	  		<?}?>
	  		<?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?>
      			<td align="center">&nbsp;<a href="<?="javascript:confirm_delete_dtl($TMP_ORD_SEQ,'$TMP_ORD_POS_NO - $TMP_PL_NAME')"?>"><img src="images/b_drop.png" border="0" alt="ลบข้อมูล"></td>
	  		<?}?>
          </tr>
    <? } ?>
    <?if($PAGE_AUTH["edit"]=="Y"){?>
          <tr class="table_footer"> 
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
	      <?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?><td>&nbsp;</td><?}?>
	      <?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?><td>&nbsp;</td><?}?>	     
          </tr>
    <?}?>
    </table>
  <? if($total_page > 1) : ?>
  <table width="95%" border="0" align="center" cellpadding="2" cellspacing="2" class="label_normal">
    <tr>
      <td align="center"><?=$page_link?></td>
    </tr>
  </table>
  <? endif; ?>
&nbsp; 
	<? } // if  count show ?>
 </div>
<input type="hidden" name="current_list" value="<?=$current_list?>">
</form>
<table id="id_shwpersons_move_req_command" width="95%" align="center" cellpadding="0" cellspacing="0" style="<?=$shwpersons_move_req_command; ?>">
<tr>
<td>
</td>
</tr>
</table>
<?
	include("jqModalDialog.html");
?>
</body>
</html>
