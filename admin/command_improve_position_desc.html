<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/command_improve_position_desc.php");
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/>
</head>
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script> 
<script language="JavaScript" src="java_scripts/function_utility.js"></script>
<script language="JavaScript">
	function change_current_page( page ){
		form1.current_page.value = page;
		form1.submit();
	}
	
	function changedateformat(name,str) {
		var arr = str.split('/');
		if((str) && (str != arr[0]+'/'+arr[1]+'/'+arr[2])){
			name.value = str.substr(0,2) + "/" + str.substr(2,2) + "/"  + str.substr(4,4) ;
		}
		chk_date(name, "BDH");
	}
	
	function confirm_delete(data_id , data_label){
		if(confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่ [ " + data_label + " ]?")){
			form1.command.value = "DELETE";
			form1.ORD_SEQ.value = data_id;
			form1.submit();
		} // end if
	}
	
	function MM_openBrWindow(theURL,winName,features) { //v2.0
	  window.open(theURL,winName,features);
	}
	
	function call_more_editor (fieldname) {
		var getdate = new Date();
		MM_openBrWindow("maximize_editor.html?fieldname="+fieldname+"&gatedate="+getdate,'moreeditor','toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=550,height=590')
	}
	
	function call_search_position () {	
		parameter = "&isLock=1&LOCK_MINISTRY_ID=" + form1.MINISTRY_ID.value + "&LOCK_DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value;
		childReturn = window.showModalDialog("search_position_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.POS_ID_OLD.value = arrValue[0];
			form1.ORD_POS_NO.value = arrValue[1];
			<? if ($POSITION_NO_CHAR=="Y") { ?>form1.ORD_POS_NAME.value = arrValue[6];<? } ?>
		
			document.all.PROCESS_IFRAME.src = "find_command_position.html?POS_ID=" + arrValue[0] + "&var_prefix=ORD&copydata=1";
		} // end if
	}
	
	function copy_position_data () {
		form1.OLD_OT_NAME.value = form1.OT_NAME.value;
		form1.OLD_PL_NAME.value = form1.PL_NAME.value;
		form1.OLD_PM_NAME.value = form1.PM_NAME.value;
		form1.OLD_CL_NAME.value = form1.CL_NAME.value;
		form1.OLD_LEVEL_NAME.value = form1.LEVEL_NAME.value;
		form1.OLD_PT_NAME.value = form1.PT_NAME.value;
		form1.OLD_SG_NAME.value = form1.SG_NAME.value;
		form1.OLD_SKILL_NAME.value = form1.SKILL_NAME.value;
		form1.OLD_PC_NAME.value = form1.PC_NAME.value;
		form1.OLD_POS_CONDITION.value = form1.ORD_CONDITION.value;
		form1.OLD_POS_SALARY.value = form1.ORD_SALARY.value;
		form1.OLD_POS_MGTSALARY.value = form1.ORD_MGTSALARY.value;
		form1.OLD_MINISTRY_NAME.value = form1.MINISTRY_NAME.value;
		form1.OLD_DEPARTMENT_NAME.value = form1.DEPARTMENT_NAME.value;
		form1.OLD_ORG_NAME.value = form1.ORG_NAME.value;
		form1.OLD_ORG_NAME_1.value = form1.ORG_NAME_1.value;
		form1.OLD_ORG_NAME_2.value = form1.ORG_NAME_2.value;
		form1.OLD_CT_NAME.value = form1.CT_NAME.value;
		form1.OLD_PV_NAME.value = form1.PV_NAME.value;
		form1.OLD_AP_NAME.value = form1.AP_NAME.value;
		form1.OLD_ORG_OT_NAME.value = form1.ORG_OT_NAME.value;
		form1.OLD_POS_REMARK.value = form1.ORD_REMARK.value;
		
		document.all.POSITION_DETAIL.style.display = 'block';	
		disable_form_button(false);
	} 

	function disable_form_button (value) {
		document.all.btn_off_type.disabled = value;
		document.all.btn_line.disabled = value;
		document.all.btn_mgt.disabled = value;
		document.all.btn_co_level.disabled = value;
		document.all.btn_per_type.disabled = value;
		document.all.btn_skill_group.disabled = value;
		document.all.btn_skill.disabled = value;
		document.all.btn_condition.disabled = value;
		document.all.btn_org.disabled = value;
		document.all.btn_org_1.disabled = value;
		document.all.btn_org_2.disabled = value;
	}

	function call_search_off_type () {	
		parameter = "";
		childReturn = window.showModalDialog("search_offtype_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.OT_CODE.value = arrValue[0];
			form1.OT_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_perline () {	
		parameter = "";
		childReturn = window.showModalDialog("search_perline_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.PL_CODE.value = arrValue[0];
			form1.PL_NAME.value = arrValue[1];

//			form1.SG_CODE.value = "";
//			form1.SG_NAME.value = "";
		} // end if
	}

	function call_search_mgt () {	
		parameter = "";
		childReturn = window.showModalDialog("search_mgt_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.PM_CODE.value = arrValue[0];
			form1.PM_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_co_level () {	
		parameter = "";
		childReturn = window.showModalDialog("search_co_level_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.CL_CODE.value = arrValue[0];
			form1.CL_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_level () {	
		parameter = "";
		childReturn = window.showModalDialog("search_level_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.LEVEL_NO.value = arrValue[0];
			form1.LEVEL_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_skill_group () {	
		parameter = "";
//		if(form1.PL_CODE.value != "") parameter = "&PL_CODE=" + form1.PL_CODE.value;
		childReturn = window.showModalDialog("search_skill_group_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.SG_CODE.value = arrValue[0];
			form1.SG_NAME.value = arrValue[1];
			
			form1.SKILL_CODE.value = "";
			form1.SKILL_NAME.value = "";
		} // end if
	}

	function call_search_skill () {	
		parameter = "";
		if(form1.SG_CODE.value != "") parameter = "&SG_CODE=" + form1.SG_CODE.value;
		childReturn = window.showModalDialog("search_skill_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.SKILL_CODE.value = arrValue[0];
			form1.SKILL_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_org () {	
		var DEPARTMENT_ID = <?=(($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4)?"$DEPARTMENT_ID":"form1.DEPARTMENT_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(DEPARTMENT_ID != ""){
			parameter = "&OL_CODE=03&ORG_ID_REF=" + DEPARTMENT_ID + "&PV_CODE=" + PROVINCE_CODE;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID.value = arrValue[0];
				form1.ORG_NAME.value = arrValue[1];
				form1.ORG_ID_1.value = "";
				form1.ORG_NAME_1.value = "";
				form1.ORG_ID_2.value = "";
				form1.ORG_NAME_2.value = "";
		<? if($SESS_ORG_SETLEVEL==5) { ?>
				form1.ORG_ID_3.value = "";
				form1.ORG_NAME_3.value = "";
				form1.ORG_ID_4.value = "";
				form1.ORG_NAME_4.value = "";
				form1.ORG_ID_5.value = "";
				form1.ORG_NAME_5.value = "";
		<? } ?>

				if(arrValue[0] != "")
					document.all.PROCESS_IFRAME.src = "find_per_country.html?ORG_ID=" + arrValue[0] + "&RETURN_VAR[PV_CODE]=PV_CODE&RETURN_VAR[PV_NAME]=PV_NAME&RETURN_VAR[CT_CODE]=CT_CODE&RETURN_VAR[CT_NAME]=CT_NAME&RETURN_VAR[AP_CODE]=AP_CODE&RETURN_VAR[AP_NAME]=AP_NAME&RETURN_VAR[OT_CODE]=ORG_OT_CODE&RETURN_VAR[OT_NAME]=ORG_OT_NAME";
			} // end if
		}else{
			<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
			alert('<?=$DEPARTMENT_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$DEPARTMENT_ALERT?>');
			form1.btn_department.focus();
			<? } ?>
		} // end if
	}

	function call_search_org_1 () {	
		if(form1.ORG_ID.value != ""){
			parameter = "&OL_CODE=04&ORG_ID_REF=" + form1.ORG_ID.value;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID_1.value = arrValue[0];
				form1.ORG_NAME_1.value = arrValue[1];
				form1.ORG_ID_2.value = "";
				form1.ORG_NAME_2.value = "";
		<? if($SESS_ORG_SETLEVEL==5) { ?>	
				form1.ORG_ID_3.value = "";
				form1.ORG_NAME_3.value = "";
				form1.ORG_ID_4.value = "";
				form1.ORG_NAME_4.value = "";
				form1.ORG_ID_5.value = "";
				form1.ORG_NAME_5.value = ""; 
		<? } ?>
			} // end if
		}else{
			alert('<?=$ORG_ALERT?>');
			form1.btn_org.focus();
		} // end if
	}

	function call_search_org_2 () {	
		if(form1.ORG_ID_1.value != ""){
			parameter = "&OL_CODE=05&ORG_ID_REF=" + form1.ORG_ID_1.value;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID_2.value = arrValue[0];
				form1.ORG_NAME_2.value = arrValue[1];
			<? if($SESS_ORG_SETLEVEL==5) { ?>	
				form1.ORG_ID_3.value = "";
				form1.ORG_NAME_3.value = "";
				form1.ORG_ID_4.value = "";
				form1.ORG_NAME_4.value = "";
				form1.ORG_ID_5.value = "";
				form1.ORG_NAME_5.value = ""; 
			<? } ?>
			} // end if
		}else{
			alert('<?=$ORG1_ALERT?>');
			form1.btn_org_1.focus();
		} // end if
	}

	function call_search_org_3 () {	
		if(form1.ORG_ID_2.value != ""){
			parameter = "&OL_CODE=06&ORG_ID_REF=" + form1.ORG_ID_2.value;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID_3.value = arrValue[0];
				form1.ORG_NAME_3.value = arrValue[1];
				form1.ORG_ID_4.value = "";
				form1.ORG_NAME_4.value = "";
				form1.ORG_ID_5.value = "";
				form1.ORG_NAME_5.value = "";
			} // end if
		}else{
			alert('<?=$ORG2_ALERT?>');
			form1.btn_org_2.focus();
		} // end if
	}

	function call_search_org_4 () {	
		if(form1.ORG_ID_3.value != ""){
			parameter = "&OL_CODE=07&ORG_ID_REF=" + form1.ORG_ID_3.value;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID_4.value = arrValue[0];
				form1.ORG_NAME_4.value = arrValue[1];
				form1.ORG_ID_5.value = "";
				form1.ORG_NAME_5.value = "";
			} // end if
		}else{
			alert('<?=$ORG3_ALERT?>');
			form1.btn_org_3.focus();
		} // end if
	}

	function call_search_org_5 () {	
		if(form1.ORG_ID_4.value != ""){
			parameter = "&OL_CODE=08&ORG_ID_REF=" + form1.ORG_ID_4.value;
			childReturn = window.showModalDialog("search_org_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
			if(childReturn){
				arrValue = childReturn.split("<::>");
				form1.ORG_ID_5.value = arrValue[0];
				form1.ORG_NAME_5.value = arrValue[1];
			} // end if
		}else{
			alert('<?=$ORG4_ALERT?>');
			form1.btn_org_4.focus();
		} // end if
	}

	function call_search_type () {	
		parameter = "";
		childReturn = window.showModalDialog("search_type_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");		
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.PT_CODE.value = arrValue[0];
			form1.PT_NAME.value = arrValue[1];
		} // end if
	}

	function call_search_condition () {	
		var parameter = "";
		childReturn = window.showModalDialog("search_condition_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,"","dialogHeight: 800px; dialogWidth: 1100px; status: No; resizable: No; help: No; statusbar: No;");
		if(childReturn){
			arrValue = childReturn.split("<::>");
			form1.PC_CODE.value = arrValue[0];
			form1.PC_NAME.value = arrValue[1];
		} // end if
	}

	function call_pdf_report() {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "การปรับปรุงการกำหนดตำแหน่ง<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")))?>";
		document.form1.target = "_blank";
		document.form1.action = "report/rpt_command_improve_position_desc.php?report_title=" + report_title + "&ORD_ID=<?=$ORD_ID?>&UTC" + rptDate;
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "command_improve_position_desc.html";
	} 
	
	function call_export_file() {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "การปรับปรุงการกำหนดตำแหน่ง<?=($MENU_ID_LV3)?$MENU_TITLE_LV3:(($MENU_ID_LV2)?$MENU_TITLE_LV2:(($MENU_ID_LV1)?$MENU_TITLE_LV1:(($MENU_ID_LV0)?$MENU_TITLE_LV0:"")))?>";
		document.form1.target = "_blank";
		document.form1.action = "report/rpt_command_improve_position_desc_xls.php?report_title=" + report_title + "&ORD_ID=<?=$ORD_ID?>&UTC" + rptDate;
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "command_improve_position_desc.html";
	}	
</script>

<script type="text/javascript" language="JavaScript">
function check(f) {
	if(f.ORD_SEQ.value=="") {
		alert("กรุณาระบุ ลำดับที่");
		f.ORD_SEQ.focus();
		return false;
		} 
		else if(f.ORD_POS_NO.value=="") {
		alert("กรุณาระบุ ตำแหน่งเลขที่");
		f.ORD_POS_NO.focus();
		return false;
		}
		else  return true;
		}
		
function call_sort(flag) {
		if (flag==1) {
			form1.order_by.value="1";		form1.sort_by.value="1";
			if(form1.sort_type.value=="1:asc"){
				form1.sort_type.value="1:desc";
			}else{ //desc
				form1.sort_type.value="1:asc";
			}
		} else if (flag==2) {
			form1.order_by.value="2";		form1.sort_by.value="2";
			if(form1.sort_type.value=="2:asc"){
				form1.sort_type.value="2:desc";
			}else{ //desc
				form1.sort_type.value="2:asc";
			}
		} else if (flag==3) {
			form1.order_by.value="3";		form1.sort_by.value="3";
			if(form1.sort_type.value=="3:asc"){
				form1.sort_type.value="3:desc";
			}else{ //desc
				form1.sort_type.value="3:asc";
			}
		} else if (flag==4) {
			form1.order_by.value="4";		form1.sort_by.value="4";
			if(form1.sort_type.value=="4:asc"){
				form1.sort_type.value="4:desc";
			}else{ //desc
				form1.sort_type.value="4:asc";
			}
		}
		form1.command.value='SEARCH';
		form1.submit();
	} // end function call_sort
</script>


<span id="defaultTheme"></span>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="command_improve_position_desc.html" enctype="multipart/form-data" onSubmit="return check(this);">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="ORD_ID" value="<?=$ORD_ID?>">
          <input type="hidden" name="POS_ID_OLD" value="<?=$POS_ID_OLD?>">
    &nbsp;
    <table width="96%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<? if($err_text){ ?>
	<tr><td colspan="4" height="22" align="center" class="label_alert"><?=$err_text?></td></tr>
	<? } // end if ?>
	<tr>
		<td width="20%" align="right"><span class="label_alert">*</span>&nbsp;<?=$SEQ_NO_TITLE?>&nbsp;:&nbsp;</td>
		<td width="30%"><input type="text" class="textbox" name="ORD_SEQ" value="<?=$ORD_SEQ?>" readonly></td>
		<td width="20%" align="right"><span class="label_alert">*</span>&nbsp;<?=$POS_NO_TITLE?>&nbsp;:&nbsp;</td>
		<td width="30%">
		<? if ($POSITION_NO_CHAR=="Y") { ?>
		<input type="text" name="ORD_POS_NAME" value="<?=$ORD_POS_NAME; ?>" style="width:20%"  readonly="true">
		<? } ?>
		<input type="text" class="textbox" name="ORD_POS_NO" value="<?=$ORD_POS_NO?>" style="width:60%"  readonly="true">
		
		  <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?>
		  <input type="button" name="Input" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_position()">
		  <? } // end if ?>        </td>
	</tr>
	<tr>
		<td width="20%" align="right">ให้มีผลบังคับวันที่&nbsp;:&nbsp;</td>
		<td width="30%">
			<input type="text" class="textbox" name="ORD_EFF_DATE" id="ORD_EFF_DATE" value="<?=$ORD_EFF_DATE?>" onKeyPress="DateOnly();" onBlur="changedateformat(form1.ORD_EFF_DATE,this.value)" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"readonly"?>>
			<? if(!$VIEW && !$ORD_CONFIRM){ ?>&nbsp;&nbsp;<input type="button" class="button" value="<?=$SELECT_TITLE?>" onClick="return showCalendar('ORD_EFF_DATE', 'dd/mm/y', '<?=$SESS_HOLIDAY?>', 'confirm');"><? } // end if ?>		</td>
		<td width="20%" align="right">ผลการตรวจสอบคำสั่ง&nbsp;:&nbsp;</td>
		<td width="30%">
		<? $ORD_RESULT = (!isset($ORD_RESULT))?  $ORD_RESULT : 1; ?>
			<input type="checkbox" name="ORD_RESULT" value="1" onClick="if(this.checked){ form1.ORD_RESULT[1].checked = false; }" <?=($ORD_RESULT==1 && $ORD_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;ถูกต้อง&nbsp;&nbsp;
			<input type="checkbox" name="ORD_RESULT" value="0" onClick="if(this.checked){ form1.ORD_RESULT[0].checked = false; }" <?=($ORD_RESULT==0 && $ORD_RESULT!="")?"checked":""?> <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"disabled"?>>&nbsp;&nbsp;ไม่ถูกต้อง		</td>
	</tr>
    <tr>
     <td height="5" colspan="4" align="center"><iframe src="javascript:;" id="PROCESS_IFRAME" frameborder="0" height="5" scrolling="no">PROCESS IFRAME</iframe></td>
    </tr>
	<tr>
	  <td height="22" colspan="4" align="center"><? if($VIEW){ ?>
            <?}?>
		<? if(!$ORD_CONFIRM){ ?>
		<? if($UPD || $VIEW){ ?><?	if ($BUTTON_DISPLAY==1) { ?>
		<input type="button" name="Reset2" value="<?=$CANCEL_TITLE?>" onClick="form1.command.value='CANCEL'; parent.refresh_opener('2<::>!<::><::>!<::>!<::>');" class="button" >
		<? } else { ?>
            <input name="image" type="image" onClick="form1.command.value='CANCEL'; parent.refresh_opener('2<::>!<::><::>!<::>!<::>');" src="images/cancel.gif" alt="<?=$CANCEL_TITLE?>" border="0">
            &nbsp;&nbsp;&nbsp;
            <?}?>
		<?if($PAGE_AUTH["edit"]=="Y" && !$VIEW){?><?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Submit22" type="submit" class="button" onClick="form1.command.value='UPDATE';" value="<?=$EDIT_TITLE?>">
		<? } else { ?>
            		 <input name="image" type="image" onClick="form1.command.value='UPDATE'" src="images/save.png" alt="<?=$EDIT_TITLE?>" border="0">
            		 &nbsp;&nbsp;&nbsp;
            		<?}?>
		<?}?>
		<?if($PAGE_AUTH["del"]=="Y" && !$VIEW){?><?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Submit22" type="button" class="button" onClick="confirm_delete(<?=$ORD_SEQ?> , '<?="$ORD_POS_NO - $ORD_PL_NAME"?>');" value="<?=$DEL_TITLE?>">
		<? } else { ?>
	  	<img src="images/delete.gif" alt="<?=$DEL_TITLE?>" width="32" height="32" border="0" onClick="confirm_delete(<?=$ORD_SEQ?> , '<?="$ORD_POS_NO - $ORD_PL_NAME"?>');">&nbsp;&nbsp;&nbsp;
		<? } ?>
		<?}?>
		<? }else{ ?><?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>" onClick="disable_form_button(true);">
		<? } else { ?>
            	<img src="images/default.jpg" alt="<?=$CLEAR_TITLE?>" width="32" height="32" border="0" onClick="disable_form_button(true); form1.reset();">&nbsp;&nbsp;&nbsp;
				<?}?>
		<?if($PAGE_AUTH["add"]=="Y"){?><?	if ($BUTTON_DISPLAY==1) { ?>
		<input name="Submit2" type="submit" class="button" onClick="form1.command.value='ADD';" value="<?=$ADD_TITLE?>">
		<? } else { ?>
            		<input name="image" type="image" onClick="form1.command.value='ADD'" src="images/save.png" alt="<?=$ADD_TITLE?>" border="0">
            		&nbsp;&nbsp;&nbsp;
	  		  		<?}?> 
		<?}?>
		<? } // end if ?>
		<? } // end if ?>	  </td>
	  </tr>	
	</table>	
	
	<div id="POSITION_DETAIL" style="display:<?=($UPD || $VIEW)?"block":"none"?>">
	<table width="96%" align="center" cellpadding="0" cellspacing="0" class="input_table">
	<tr>
	  <td width="20%" height="22" align="right">&nbsp;</td>
	  <td width="40%" align="center" class="table_body">ตำแหน่งก่อนปรับปรุง</td>
	  <td align="center" class="table_body_2">ตำแหน่งหลังปรับปรุง</td>
	</tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$OFF_TYPE_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_OT_NAME" value="<?=$OLD_OT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="OT_NAME" value="<?=$OT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_off_type" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_off_type()"><? } // end if ?>
		<input type="hidden" name="OT_CODE" value="<?=$OT_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.OT_NAME.value=''; form1.OT_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$PL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PL_NAME" value="<?=$OLD_PL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PL_NAME" value="<?=$PL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_line" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_perline()"><? } // end if ?>
        <input type="hidden" name="PL_CODE" value="<?=$PL_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PL_NAME.value=''; form1.PL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PM_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PM_NAME" value="<?=$OLD_PM_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PM_NAME" value="<?=$PM_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_mgt" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_mgt()"><? } // end if ?>
        <input type="hidden" name="PM_CODE" value="<?=$PM_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PM_NAME.value=''; form1.PM_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$CL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_CL_NAME" value="<?=$OLD_CL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="CL_NAME" value="<?=$CL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_co_level" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_co_level()"><? } // end if ?>
        <input type="hidden" name="CL_CODE" value="<?=$CL_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.CL_NAME.value=''; form1.CL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$LEVEL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_LEVEL_NAME" value="<?=$OLD_LEVEL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
				<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM) { ?>
		        <input type="hidden" name="LEVEL_NAME" value="<?=$LEVEL_NAME?>">
				<select class="selectbox" name="LEVEL_NO">
				  <option value="" <?=($LEVEL_NO=="")?"selected":""?>>== <?=$LEVEL_TITLE?> ==</option>
				  <?
				  if ($ISCS_FLAG==1) $where = "and LEVEL_NO in $LIST_LEVEL_NO"; 
				  	$cmd = " select LEVEL_NO, LEVEL_NAME from PER_LEVEL where PER_TYPE = 1 and LEVEL_ACTIVE = 1 $where order by LEVEL_SEQ_NO ";
					$db_dpis->send_cmd($cmd);
					while($data = $db_dpis->get_array()){					
						$TMP_LEVEL_NO = $data[LEVEL_NO];
						$TMP_LEVEL_NAME = $data[LEVEL_NAME];
				  ?>
				  <option value="<?=$TMP_LEVEL_NO?>" <?=(trim($LEVEL_NO)==trim($TMP_LEVEL_NO))?"selected":""?>><?=$TMP_LEVEL_NAME?></option>
				  <?
				  	} // end while
				  ?>
				</select> 
				<? } else { ?>
				<input type="text" name="LEVEL_NAME" value="<?=$LEVEL_NAME?>" style="width:80%" class="textbox" readonly>
				<? } ?>			  
			  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$PT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PT_NAME" value="<?=$OLD_PT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PT_NAME" value="<?=$PT_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_per_type" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_type()"><? } // end if ?>
        <input type="hidden" name="PT_CODE" value="<?=$PT_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PT_NAME.value=''; form1.PT_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$SG_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_SG_NAME" value="<?=$OLD_SG_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="SG_NAME" value="<?=$SG_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_skill_group" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_skill_group()"><? } // end if ?>
        <input type="hidden" name="SG_CODE" value="<?=$SG_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.SG_NAME.value=''; form1.SG_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$SKILL_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_SKILL_NAME" value="<?=$OLD_SKILL_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="SKILL_NAME" value="<?=$SKILL_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_skill" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_skill()"><? } // end if ?>
        <input type="hidden" name="SKILL_CODE" value="<?=$SKILL_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.SKILL_NAME.value=''; form1.SKILL_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PC_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PC_NAME" value="<?=$OLD_PC_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PC_NAME" value="<?=$PC_NAME?>" style="width:80%" class="textbox"  readonly="true">
        <? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_condition" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_condition()"><? } // end if ?>
        <input type="hidden" name="PC_CODE" value="<?=$PC_CODE?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.PC_NAME.value=''; form1.PC_CODE.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3">&nbsp;</td>
	  <td><textarea name="OLD_POS_CONDITION" rows="3" class="selectbox" style="width:90%" readonly="true"><?=$OLD_POS_CONDITION?></textarea></td>
	  <td><textarea name="ORD_CONDITION" rows="3" class="selectbox" style="width:80%" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"readonly"?>><?=$ORD_CONDITION?></textarea></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$SALARY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_POS_SALARY" value="<?=$OLD_POS_SALARY?>" style="width:90%" class="textbox" readonly="true"></td>
	  <td><input type="text" name="ORD_SALARY" value="<?=$ORD_SALARY?>" style="width:80%" class="textbox" onKeyPress="NumOnly();" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"readonly"?>></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$MGTSALARY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_POS_MGTSALARY" value="<?=$OLD_POS_MGTSALARY?>" style="width:90%" class="textbox" readonly="true"></td>
	  <td><input type="text" name="ORD_MGTSALARY" value="<?=$ORD_MGTSALARY?>" style="width:80%" class="textbox" onKeyPress="NumOnly();" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"readonly"?>></td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$MINISTRY_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_MINISTRY_NAME" value="<?=$OLD_MINISTRY_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><!--input type="button" name="btn_ministry" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_ministry()"--><? } // end if ?>
		<input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>">			  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$DEPARTMENT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_DEPARTMENT_NAME" value="<?=$OLD_DEPARTMENT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><!--input type="button" name="btn_department" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_department()"--><? } // end if ?>
		<input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>">			  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><span class="label_alert">*</span>&nbsp;<?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME" value="<?=$OLD_ORG_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME" value="<?=$ORG_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<? if($SESS_USERGROUP_LEVEL < 5 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org()"><? } // end if ?>
		<input type="hidden" name="ORG_ID" value="<?=$ORG_ID?>">	
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME.value=''; form1.ORG_ID.value=''; return false;" align="center" alt="ล้างค่า">  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE1?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_1" value="<?=$OLD_ORG_NAME_1?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_1" value="<?=$ORG_NAME_1?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org_1" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_1()"><? } // end if ?>
		<input type="hidden" name="ORG_ID_1" value="<?=$ORG_ID_1?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_1.value=''; form1.ORG_ID_1.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE2?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_2" value="<?=$OLD_ORG_NAME_2?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_2" value="<?=$ORG_NAME_2?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org_2" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_2()"><? } // end if ?>
		<input type="hidden" name="ORG_ID_2" value="<?=$ORG_ID_2?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_2.value=''; form1.ORG_ID_2.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
<? if($SESS_ORG_SETLEVEL==5) { ?>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE3?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_3" value="<?=$OLD_ORG_NAME_3?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_3" value="<?=$ORG_NAME_3?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org_3" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_3()"><? } // end if ?>
		<input type="hidden" name="ORG_ID_3" value="<?=$ORG_ID_3?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_3.value=''; form1.ORG_ID_3.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE4?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_4" value="<?=$OLD_ORG_NAME_4?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_4" value="<?=$ORG_NAME_4?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org_4" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_4()"><? } // end if ?>
		<input type="hidden" name="ORG_ID_4" value="<?=$ORG_ID_4?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_4.value=''; form1.ORG_ID_4.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$ORG_TITLE5?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_NAME_5" value="<?=$OLD_ORG_NAME_5?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_NAME_5" value="<?=$ORG_NAME_5?>" style="width:80%" class="textbox"  readonly="true">
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM){ ?><input type="button" name="btn_org_5" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org_5()"><? } // end if ?>
		<input type="hidden" name="ORG_ID_5" value="<?=$ORG_ID_5?>">
		<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME_5.value=''; form1.ORG_ID_5.value=''; return false;" align="center" alt="ล้างค่า">	  </td>
	  </tr>
<? } ?>				
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$CT_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_CT_NAME" value="<?=$OLD_CT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="CT_NAME" value="<?=$CT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="CT_CODE" value="<?=$CT_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$PV_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_PV_NAME" value="<?=$OLD_PV_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="PV_NAME" value="<?=$PV_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="PV_CODE" value="<?=$PV_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$AP_TITLE?>&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_AP_NAME" value="<?=$OLD_AP_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="AP_NAME" value="<?=$AP_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="AP_CODE" value="<?=$AP_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3">สังกัด&nbsp;:&nbsp;</td>
	  <td><input type="text" name="OLD_ORG_OT_NAME" value="<?=$OLD_ORG_OT_NAME?>" style="width:90%" class="textbox"  readonly="true"></td>
	  <td>
	  	<input type="text" name="ORG_OT_NAME" value="<?=$ORG_OT_NAME?>" style="width:80%" class="textbox"  readonly="true">
		<input type="hidden" name="ORG_OT_CODE" value="<?=$ORG_OT_CODE?>">	  </td>
	  </tr>
	<tr>
	  <td height="21" align="right" class="table_body_3"><?=$REMARK_TITLE?>&nbsp;:&nbsp;</td>
	  <td><textarea name="OLD_POS_REMARK" rows="3" class="selectbox" style="width:90%" readonly="true"><?=$OLD_POS_REMARK?></textarea></td>
	  <td><textarea name="ORD_REMARK" rows="3" class="selectbox" style="width:80%" <?=(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW && !$ORD_CONFIRM)?"":"readonly"?>><?=$ORD_REMARK?></textarea></td>
	  </tr>
	</table>
	</div>
<?
	$cmd =" select 		count(ORD_SEQ) as count_data
					from 		PER_ORDER_DTL
					where		ORD_ID=$ORD_ID ";
	$db_dpis->send_cmd($cmd);
//	$db_dpis->show_error();
	$data = $db_dpis->get_array();
	$data = array_change_key_case($data, CASE_LOWER);
	$count_data = $data[count_data];	
//	echo "$count_data";
?>
<table width="96%" border="0" align="center" cellpadding="0" cellspacing="0">
<tr><td><input type="hidden" name="order_by" value="<?=$order_by?>"><input type="hidden" name="sort_by" value="<?=$sort_by;?>">
<input type="hidden" name="sort_type" value="<?=$sort_type?>">
<?=$SORT_TITLE?></td>
</tr>
</table>
    <table width="96%" align="center"  border="0" cellspacing="0" cellpadding="0">
	<tr><td align="right"></td></tr>
    <tr><td>
	<table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_body_3">
            <tr>
              <td width="25%" height="22">
			  	<? if($PAGE_AUTH["print"]=="Y"){ ?>
                <? if ($BUTTON_DISPLAY==1) { ?>
                <input name="btn_report" type="button" class="button" style="width:150" value="<?=$PDF_TITLE?>" onClick="call_pdf_report();">
                <?  } else { ?>
                <img src="images/doc_icon_pdf.jpg" border="0" alt="<?=$PDF_TITLE?>" onClick="call_pdf_report();">
                <? } ?>                <? }else{ echo "&nbsp;"; } ?></td>
              <td align="center" height="22">พบข้อมูลรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่งทั้งสิ้น <?=($count_data + 0)?> รายการ</td>
              <td width="25%" align="right">
			  	<? if($PAGE_AUTH["print"]=="Y"){ ?>
			  	<? if ($BUTTON_DISPLAY==1) { ?>
                <input name="btn_export" type="button" class="button" style="width:130" value="<?=$EXCEL_TITLE?>" onClick="call_export_file();">
                <?  } else { ?>
                <img src="images/doc_icon_excel.jpg" border="0" alt="<?=$EXCEL_TITLE?>" onClick="call_export_file();">
                <? } ?>                <? }else{ echo "&nbsp;"; } ?>              </td>
			</tr>
          </table>  
	</td></tr>
</table>   
<?
$sort_by = (isset($sort_by))?  $sort_by : 1;
	$sort_type = (isset($sort_type))?  $sort_type : "1:asc";
	$arrSort=explode(":",$sort_type);
	$SortType[$arrSort[0]]	=$arrSort[1];
  	$order_by = (isset($order_by))?  $order_by : 1;
	if($order_by==1){	// เลขที่ตำแหน่ง
	if($DPISDB=="odbc"){  $order_str = "order by  IIf(IsNull(ORD_POS_NO), 0, CLng(ORD_POS_NO)) $SortType[$order_by]";
	}elseif($DPISDB=="oci8"){ $order_str = "order by  TO_NUMBER(ORD_POS_NO) $SortType[$order_by]"; }
	}elseif($order_by==2) {	//ตำแหน่งในสายงาน
		$order_str = "order by  PL_CODE ".$SortType[$order_by];
  	} elseif($order_by==3) {	//ตำแหน่งในการบริหารงาน
		$order_str = "order by  PM_CODE $SortType[$order_by]";
  	}elseif($order_by==4) {	//ลำดับที่
		$order_str = "order by  ORD_SEQ $SortType[$order_by]";
  	}

	$total_page = ceil( $count_data / $data_per_page );
	$page_link = create_link_page($total_page, $current_page);
	$limit_data = "";

	if($current_page > 1){
		if($DPISDB=="odbc"){
			$cmd = " select top $start_record ORD_SEQ from PER_ORDER_DTL where ORD_ID=$ORD_ID order by ORD_SEQ ";
			$db_dpis->send_cmd($cmd);
			while($data = $db_dpis->get_array()) $arr_exclude[] = $data[ORD_SEQ];
			$limit_data = " and ORD_SEQ not in (". implode(", ", $arr_exclude) .")";
		}elseif($DPISDB=="mysql"){
			$limit_data = " limit " . (($current_page - 1) * $data_per_page) . ", " . $data_per_page;
		} // end if
	} // end if 

	if($DPISDB=="odbc"){
		$cmd = " select		top $data_per_page 
										ORD_SEQ, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT 
						from		PER_ORDER_DTL
						where		ORD_ID=$ORD_ID
										$limit_data
							$order_str 	";	
	}elseif($DPISDB=="oci8"){
		$min_rownum = (($current_page - 1) * $data_per_page) + 1;
		$max_rownum = $current_page * $data_per_page;

		$cmd = "select 		temp2.* 
						from (
							select 		rownum as rnum, temp1.*
							from (	
								select		ORD_SEQ, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT 
								from		PER_ORDER_DTL
								where		ORD_ID=$ORD_ID
									$order_str  
							) temp1
							where rownum <= $max_rownum
						) temp2
						where rnum between $min_rownum and $max_rownum   ";						
	}elseif($DPISDB=="mysql"){
		$cmd = " select		ORD_SEQ, ORD_POS_NO, PL_CODE, PM_CODE, ORD_RESULT 
						from		PER_ORDER_DTL
						where		ORD_ID=$ORD_ID
										$limit_data
							$order_str 	";	
	} // end if
	
	$count_page_data = $db_dpis->send_cmd($cmd);
	//$db_dpis->show_error();
	if ($count_page_data) {
?>
        <table width="96%" border="0" align="center" cellpadding="1" cellspacing="1" class="label_normal">
          <tr align="center" class="table_head"> 
            <td width="7%" height="25" onClick="call_sort(4);"><strong>
              <? if($order_by==4&&$sort_by==4){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$SEQ_NO_TITLE?></strong></td>
            <td height="25" onClick="call_sort(1);"><strong>
              <? if($order_by==1&&$sort_by==1){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$POS_NO_TITLE?></strong></td>
            <td width="32%" onClick="call_sort(2);"><strong>
              <? if($order_by==2&&$sort_by==2){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$PL_TITLE?></strong></td>
            <td width="32%" onClick="call_sort(3);"><strong>
              <? if($order_by==3&&$sort_by==3){  if($SortType[$order_by]=="asc"){  echo $SORT_ASC;  }else{ echo $SORT_DESC; } }else{  echo $SORT_CUR;  } ?>
            <?=$PM_TITLE?></strong></td>
	     <td width="4%"><?=$INQ_TITLE?></td>
	       <?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?>
	       <td width="4%"><?=$EDIT_TITLE?></td>
	       <?}?>
      		<?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?>
      		<td width="4%"><?=$DEL_TITLE?></td>
      		<?}?>
          </tr>
          <?
	$current_list = "";
	$data_count = 0;
	while ($data = $db_dpis->get_array()) {
		$data_count++;
		if($data_count > $data_per_page) break;
		$TMP_ORD_SEQ = $data[ORD_SEQ];
		$current_list .= ((trim($current_list))?",":"") . $TMP_ORD_SEQ;
		$ORD_POS_NO = $data[ORD_POS_NO];

		$PL_CODE = $data[PL_CODE];
		if($PL_CODE){
			$cmd = " select PL_NAME from PER_LINE where PL_CODE='$PL_CODE' ";
			$db_dpis2->send_cmd($cmd);
			$data2 = $db_dpis2->get_array();
			$PL_NAME = $data2[PL_NAME];
		} // end if
		
		$PM_CODE = $data[PM_CODE];
		if($PM_CODE){
			$cmd = " select PM_NAME from PER_MGT where PM_CODE='$PM_CODE' ";
			$db_dpis2->send_cmd($cmd);
			$data2 = $db_dpis2->get_array();
			$PM_NAME = $data2[PM_NAME];
		} // end if

		$ORD_RESULT = $data[ORD_RESULT];
		
		$class = "table_body";
		$onmouse_event = " onMouseOver=\"this.className='table_body_over';\" onMouseOut=\"this.className='table_body';\" ";
		if($ORD_SEQ==$TMP_ORD_SEQ){ 
			$class = "table_body_over";
			$onmouse_event = "";
		} // end if		
?>
          <tr class="<?=$class?>" <?=$onmouse_event?>> 
            <td height="25" align="center"><?=$TMP_ORD_SEQ?></td>
            <td>&nbsp;<?=$ORD_POS_NO?></td>
            <td>&nbsp;<?=$PL_NAME?></td>
            <td>&nbsp;<?=$PM_NAME?></td> 
			  <td align="center">&nbsp;<a href="<?="javascript:parent.refresh_opener('2<::>!<::>$TMP_ORD_SEQ<::>!<::>!<::>?VIEW=1');"?>"><img src="images/icon_eye.gif" alt="ดูรายละเอียดบัญชีคำสั่งปรับปรุงตำแหน่ง" width="16" height="16" border="0"></a></td>
			  <?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?>
			  <td align="center">&nbsp;<a href="<?="javascript:parent.refresh_opener('2<::>!<::>$TMP_ORD_SEQ<::>!<::>!<::>?UPD=1');"?>"><img src="images/b_edit.png" border="0" alt="แก้ไขข้อมูล"></a></td>
	  <?}?>
	  <?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?>
      <td align="center">&nbsp;<a href="<?="javascript:confirm_delete($TMP_ORD_SEQ,'$ORD_POS_NO - $PL_NAME')"?>"><img src="images/b_drop.png" border="0" alt="ลบข้อมูล"></td>
	  <?}?>
          </tr>
          <? } ?>
          <?if($PAGE_AUTH["edit"]=="Y"){?>
          <tr class="table_footer"> 
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
	      <?if($PAGE_AUTH["edit"]=="Y" && !$ORD_CONFIRM){?><td>&nbsp;</td><?}?>
	      <?if($PAGE_AUTH["del"]=="Y" && !$ORD_CONFIRM){?><td>&nbsp;</td><?}?>	     
          </tr>
          <?}?>
        </table>
  <? if($total_page > 1) : ?>
  <table width="90%" border="0" align="center" cellpadding="2" cellspacing="2" class="label_normal">
    <tr>
      <td align="center"><?=$page_link?></td>
    </tr>
  </table>
        <? endif; ?>
        &nbsp; 
        <? } // if  count show ?>
        <input type="hidden" name="current_list" value="<?=$current_list?>">
        </form>	
		</td>
	</tr>
</table>
</body>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
<script type="text/javascript">
setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
</script>
</html>
