<? 
	include("../php_scripts/connect_database.php");
	
    echo "PER_ID=$PER_ID, show_topic=$show_topic<br>";
    
	if(!$CARD_NO_FILL && (!$BKK_FLAG && !$ISCS_FLAG)){		// fixed $CARD_NO_FILL สำหรับ หน่วยงานอื่นที่ไม่ใช่ $BKK_FLAG || $ISCS_FLAG เพราะไม่มี checkbox ในหน้า C06 กำหนดค่าโปรแกรม    
		$CARD_NO_FILL = "Y";
	}	
	if(!isset($show_topic)) $show_topic = 1;
	if($show_topic==1){
		include("php_scripts/personal_master.php"); 
	}elseif($show_topic==2){
   		//echo "1..POS_NO=$POS_NO , POS_NO_NAME=$POS_NO_NAME<br>";
		include("php_scripts/personal_master_form.php"); 
        if ($form1command=="personal") {
            $POS_ID = $sendPOS;
	    	//echo "2..POS_NO=$POS_NO , POS_NO_NAME=$POS_NO_NAME<br>";
            include("php_scripts/find_personal_position.php"); 
         	//echo "3..POS_NO=$POS_NO , POS_NO_NAME=$POS_NO_NAME<br>";
        }
	}

	//echo "$BKK_FLAG || $ISCS_FLAG || $CARD_NO_FILL --------- COMMAND : $command // TOPIC : $show_topic // $POS_ID = $sendPOS -----------";
	$db_dpis1 = new connect_dpis($dpisdb_host, $dpisdb_name, $dpisdb_user, $dpisdb_pwd);
	$db_dpis2 = new connect_dpis($dpisdb_host, $dpisdb_name, $dpisdb_user, $dpisdb_pwd);
	$db_dpis3 = new connect_dpis($dpisdb_host, $dpisdb_name, $dpisdb_user, $dpisdb_pwd);
	
	// รวมไว้ที่เดียวเลย
	switch($CTRL_TYPE){
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;
			$PROVINCE_CODE = $PROVINCE_CODE;
			$PROVINCE_NAME = $PROVINCE_NAME;
			break;
		case 3 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			$MAIN_DEPARTMENT_ID = $DEPARTMENT_ID;
			$MAIN_DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
	} // end switch case

	switch($SESS_USERGROUP_LEVEL){								
		case 2 :
			$search_pv_code = $PROVINCE_CODE;
			$search_pv_name = $PROVINCE_NAME;
			$PROVINCE_CODE = $PROVINCE_CODE;
			$PROVINCE_NAME = $PROVINCE_NAME;
			break;
		case 3 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			break;
		case 4 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			$MAIN_DEPARTMENT_ID = $DEPARTMENT_ID;
			$MAIN_DEPARTMENT_NAME = $DEPARTMENT_NAME;
			break;
		case 5 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$search_org_id = $ORG_ID;
			$search_org_name = $ORG_NAME;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			$MAIN_DEPARTMENT_ID = $DEPARTMENT_ID;
			$MAIN_DEPARTMENT_NAME = $DEPARTMENT_NAME;
			$MAIN_ORG_ID = $ORG_ID;
			$MAIN_ORG_NAME = $ORG_NAME;
			break;
		case 6 :
			$search_ministry_id = $MINISTRY_ID;
			$search_ministry_name = $MINISTRY_NAME;
			$search_department_id = $DEPARTMENT_ID;
			$search_department_name = $DEPARTMENT_NAME;
			$search_org_id = $ORG_ID;
			$search_org_name = $ORG_NAME;
			$search_org_id_1 = $ORG_ID_1;
			$search_org_name_1 = $ORG_NAME_1;
			$MAIN_MINISTRY_ID = $MINISTRY_ID;
			$MAIN_MINISTRY_NAME = $MINISTRY_NAME;
			$MAIN_DEPARTMENT_ID = $DEPARTMENT_ID;
			$MAIN_DEPARTMENT_NAME = $DEPARTMENT_NAME;
			$MAIN_ORG_ID = $ORG_ID;
			$MAIN_ORG_NAME = $ORG_NAME;
			break;
	} // end switch case

	//---เพิ่มมาจาก personal_master_form
	if($SESS_PER_TYPE && $SESS_PER_TYPE!=0)	$PER_TYPE=$SESS_PER_TYPE;
	if(!$PER_TYPE){ 	$PER_TYPE=1;  }
	if(!$PER_STATUS){ 	
		$PER_STATUS=0; 
		if ($PER_TYPE==1) $PER_MEMBER=1; 
	}	//default เพิ่มใหม่ รอบรรจุ 
	if(!$PER_DISABILITY){ 	$PER_DISABILITY=1;  }

	$search_per_status = (isset($search_per_status))?  $search_per_status : 2;
	if($DPISDB=="odbc") {
		$POS_NO_NUM = "CLng(POS_NO)";
		$POEM_NO_NUM = "CLng(POEM_NO)";
		$POEMS_NO_NUM = "CLng(POEMS_NO)";
		$POT_NO_NUM = "CLng(POT_NO)";
	} elseif($DPISDB=="oci8") {
		$POS_NO_NUM = "TO_NUMBER(POS_NO)";
		$POEM_NO_NUM = "TO_NUMBER(POEM_NO)";
		$POEMS_NO_NUM = "TO_NUMBER(POEMS_NO)";
		$POT_NO_NUM = "TO_NUMBER(POT_NO)";
	} elseif($DPISDB=="mysql") {
		$POS_NO_NUM = "POS_NO+0";
		$POEM_NO_NUM = "POEM_NO+0";
		$POEMS_NO_NUM = "POEMS_NO+0";
		$POT_NO_NUM = "POT_NO+0";
	} // end if
	
	// ส่วนของการค้นหา จากเงื่อนไขที่เลือกมา //
	if (!$search_cardno || $SESS_USERGROUP!=1) {
		if($search_org_id_1){
			if($select_org_structure==0){
				$arr_search_condition[] = "(c.ORG_ID_1=$search_org_id_1 or d.ORG_ID_1=$search_org_id_1 or 
																e.ORG_ID_1=$search_org_id_1 or g.ORG_ID_1=$search_org_id_1)";
			}else if($select_org_structure==1){
				$arr_search_condition[] = "(a.ORG_ID_1=$search_org_id_1)";
			}
		}elseif($search_org_id){
			if($select_org_structure==0){
				$arr_search_condition[] = "(c.ORG_ID=$search_org_id or d.ORG_ID=$search_org_id or e.ORG_ID=$search_org_id or g.ORG_ID=$search_org_id)";
			}else if($select_org_structure==1){
				$arr_search_condition[] = "(a.ORG_ID=$search_org_id)";
			}
		}elseif($search_department_id){
			$arr_search_condition[] = "(a.DEPARTMENT_ID = $search_department_id)";
		}elseif($search_ministry_id){
			unset($arr_department);
			$cmd = " select ORG_ID from PER_ORG where ORG_ID_REF=$search_ministry_id and OL_CODE='02' ";
			if($SESS_ORG_STRUCTURE==1){	$cmd = str_replace("PER_ORG","PER_ORG_ASS",$cmd); 	}
			$db_dpis->send_cmd($cmd);
			while($data = $db_dpis->get_array()) $arr_department[] = $data[ORG_ID];
			$arr_search_condition[] = "(a.DEPARTMENT_ID in (". implode(",", $arr_department) ."))";
		}elseif($PROVINCE_CODE){
			$cmd = " select distinct ORG_ID_REF from PER_ORG where PV_CODE='$PROVINCE_CODE' and OL_CODE='03' ";
			if($SESS_ORG_STRUCTURE==1){	$cmd = str_replace("PER_ORG","PER_ORG_ASS",$cmd); 	}
			$db_dpis->send_cmd($cmd);
			while($data = $db_dpis->get_array()) $arr_department[] = $data[ORG_ID_REF];
			$arr_search_condition[] = "(a.DEPARTMENT_ID in (". implode(",", $arr_department) ."))";
		} // end if  
	}

	if(!$sort_by) $sort_by=2;
	$sort_type = (isset($sort_type))?  $sort_type : "1:asc";
	$arrSort=explode(":",$sort_type);
	$SortType[$arrSort[0]]	=$arrSort[1];
	if(!$order_by) $order_by=2;
	
	if(trim($search_pl_code)) $arr_search_condition[] = "(trim(PL_CODE) = '". trim($search_pl_code) ."')";
	if(trim($search_pm_code)) $arr_search_condition[] = "(trim(PM_CODE) = '". trim($search_pm_code) ."')";
  	if(trim($search_name))
		if($command == "SEARCH") $arr_search_condition[] = "(PER_NAME like '$search_name%' or UPPER(PER_ENG_NAME) like UPPER('$search_name%'))";
		elseif($command == "SEARCHNAMEHIS") $arr_search_condition[] = "(PER_NAME like '$search_name%' or UPPER(PER_ENG_NAME) like UPPER('$search_name%') or NH_NAME like '$search_name%')";
  	if(trim($search_surname))
		if($command == "SEARCH") $arr_search_condition[] = "(PER_SURNAME like '$search_surname%' or UPPER(PER_ENG_SURNAME) like UPPER('$search_surname%'))";
		elseif($command == "SEARCHNAMEHIS") $arr_search_condition[] = "(PER_SURNAME like '$search_surname%' or UPPER(PER_ENG_SURNAME) like UPPER('$search_surname%') or NH_SURNAME like '$search_surname%')";;
    		
  	if(trim($search_cardno)) 		$arr_search_condition[] = "(a.PER_CARDNO = '$search_cardno')";
  	if(trim($search_offno)) 		$arr_search_condition[] = "(PER_OFFNO = '$search_offno')";
  	if(trim($search_pos_no))  {	
		if ($search_per_type == 1 || $search_per_type==5)
			$arr_search_condition[] = "(trim(POS_NO) = '$search_pos_no')";
		elseif ($search_per_type == 2) 
			$arr_search_condition[] = "(trim(POEM_NO) = '$search_pos_no')";		
		elseif ($search_per_type == 3) 	
			$arr_search_condition[] = "(trim(POEMS_NO) = '$search_pos_no')";
		elseif ($search_per_type == 4) 	
			$arr_search_condition[] = "(trim(POT_NO) = '$search_pos_no')";
		else if ($search_per_type==0)		//ทั้งหมด
			$arr_search_condition[] = "((trim(POS_NO) = '$search_pos_no') or (trim(POEM_NO) = '$search_pos_no') or (trim(POEMS_NO) = '$search_pos_no') or (trim(POT_NO) = '$search_pos_no')) ";
	}
	if(trim($search_pos_no_name)){
		if ($search_per_type == 1 || $search_per_type==5)
			$arr_search_condition[] = "(trim(POS_NO_NAME) like '$search_pos_no_name%')";
		elseif ($search_per_type == 2) 
			$arr_search_condition[] = "(trim(POEM_NO_NAME) like '$search_pos_no_name%')";		
		elseif ($search_per_type == 3) 	
			$arr_search_condition[] = "(trim(POEMS_NO_NAME) like '$search_pos_no_name%')";
		elseif ($search_per_type == 4) 	
			$arr_search_condition[] = "(trim(POT_NO_NAME) like '$search_pos_no_name%')";
		else if ($search_per_type==0)		//ทั้งหมด
			$arr_search_condition[] = "((trim(POS_NO_NAME) like '$search_pos_no_name%') or (trim(POEM_NO_NAME) like '$search_pos_no_name%') or 
			(trim(POEMS_NO_NAME) like '$search_pos_no_name%') or (trim(POT_NO_NAME) like '$search_pos_no_name%')) ";
	}
  	if(trim($search_pay_no))  $arr_search_condition[] = "(trim(POS_NO) = '$search_pay_no' and a.PER_TYPE = 1)";
	if(trim($search_level_no)) $arr_search_condition[] = "(trim(a.LEVEL_NO) = '". trim($search_level_no) ."')";
	if(trim($search_per_type)) 	$arr_search_condition[] = "(a.PER_TYPE = $search_per_type)";
	if(trim($search_per_status) < 5) {
		$temp_per_status = $search_per_status - 1;		
		$arr_search_condition[] = "(PER_STATUS = $temp_per_status)";	
	} 
	$check_condition = "";
	if ($search_data==1) 
		$check_condition = " and (a.PER_ID not in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%1%')) ";
	elseif ($search_data==2) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%2%')) ";
	elseif ($search_data==3) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_POSITIONHIS b where a.PER_ID = b.PER_ID)) ";
	elseif ($search_data==4) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_SALARYHIS b where a.PER_ID = b.PER_ID)) ";
	elseif ($search_data==5) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_DECORATEHIS b where a.PER_ID = b.PER_ID)) ";
	elseif ($search_data==6) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%1%' group by b.PER_ID having count(*) > 1)) ";
	elseif ($search_data==7) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%2%' group by b.PER_ID having count(*) > 1)) ";
	elseif ($search_data==8) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and INS_CODE is NULL and EDU_INSTITUTE is NULL)) ";
	elseif ($search_data==9) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%4%')) ";
	elseif ($search_data==10) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_EDUCATE b where a.PER_ID = b.PER_ID and EDU_TYPE like '%4%' group by b.PER_ID having count(*) > 1)) ";
	elseif ($search_data==11) {
    	// PIC_SIGN ไม่เท่ากับ 1 หรือ = NULL แปลว่า เป็นรูปที่ใช้แสดง และไม่ใช้ลายเซ็น
//		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_PERSONALPIC b where a.PER_ID = b.PER_ID and PIC_SHOW = 1 and (PIC_SIGN <> 1 or PIC_SIGN is NULL))) ";
		$check_condition = "";
	} elseif ($search_data==12)
		$check_condition = " and	(a.ORG_ID is NULL) ";
	elseif ($search_data==13) {
    	// PIC_SIGN = 1 แปลว่า เป็นรูป "ลายเซ็น" ที่ใช้แสดง
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_PERSONALPIC b where a.PER_ID = b.PER_ID and PIC_SHOW = 1 and PIC_SIGN = 1)) ";
		$check_condition = "";
	} elseif ($search_data==14)
		$check_condition = " and (c.PL_CODE in (select d.PL_CODE from PER_LINE d where c.PL_CODE = d.PL_CODE and a.LEVEL_NO not between LEVEL_NO_MIN and LEVEL_NO_MAX)) ";
	elseif ($search_data==15)
		$check_condition = " and	(a.POS_ID in (select POS_ID from PER_PERSONAL where PER_TYPE = 1 and PER_STATUS = 1 group by POS_ID having count(*) > 1)) ";
	elseif ($search_data==16) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_POSITIONHIS b where a.PER_ID = b.PER_ID and b.POH_EFFECTIVEDATE < '$PT_DATE' and (b.LEVEL_NO in ('O1', 'O2', 'O3', 'O4', 'K1', 'K2', 'K3', 'K4', 'K5', 'D1', 'D2', 'M1', 'M2') or b.POH_LEVEL_NO in ('O1', 'O2', 'O3', 'O4', 'K1', 'K2', 'K3', 'K4', 'K5', 'D1', 'D2', 'M1', 'M2')))) ";
	elseif ($search_data==17) 
		$check_condition = " and	(a.PER_ID in (select b.PER_ID from PER_SALARYHIS b where a.PER_ID = b.PER_ID and b.SAH_EFFECTIVEDATE < '$PT_DATE' and b.LEVEL_NO in ('O1', 'O2', 'O3', 'O4', 'K1', 'K2', 'K3', 'K4', 'K5', 'D1', 'D2', 'M1', 'M2'))) ";
	elseif ($search_data==18) 
		$check_condition = " and	(a.PER_ID not in (select b.PER_ID from PER_ABSENTHIS b where a.PER_ID = b.PER_ID)) ";
	$search_condition = "";
	if(count($arr_search_condition)) $search_condition = " where " . implode(" and ", $arr_search_condition);
  	if($order_by==1) {	//ชื่อ
		$order_str = "PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by] ";
	} elseif($order_by==2){	//(ค่าเริ่มต้น) เลขที่ตำแหน่ง
		$org_cond = "";
		if ($POSITION_NO_CHAR=="Y") $org_cond = ", i.ORG_SEQ_NO $SortType[$order_by], i.ORG_CODE $SortType[$order_by]";
		if($DPISDB=="odbc") {
			if ($search_per_type==0 || $search_per_type==1 || $search_per_type==5) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POS_NO_NAME $SortType[$order_by], iif(isnull(POS_NO),0,$POS_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==2) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POEM_NO_NAME $SortType[$order_by], iif(isnull(POEM_NO),0,$POEM_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==3) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POEMS_NO_NAME $SortType[$order_by], iif(isnull(POEMS_NO),0,$POEMS_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==4) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POT_NO_NAME $SortType[$order_by], iif(isnull(POT_NO),0,$POT_NO_NUM) $SortType[$order_by]";
		}elseif($DPISDB=="oci8" || $DPISDB=="mysql"){ 
			if ($search_per_type==0 || $search_per_type==1 || $search_per_type==5) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POS_NO_NAME $SortType[$order_by], $POS_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==2) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POEM_NO_NAME $SortType[$order_by], $POEM_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==3) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POEMS_NO_NAME $SortType[$order_by], $POEMS_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==4) 
				$order_str = "a.DEPARTMENT_ID $SortType[$order_by]".$org_cond.", POT_NO_NAME $SortType[$order_by], $POT_NO_NUM $SortType[$order_by]";
		}
  	} elseif($order_by==3) {//ระดับตำแหน่ง
		if($DPISDB=="odbc") {
			if ($search_per_type==0 || $search_per_type==1 || $search_per_type==5) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], iif(isnull(POS_NO),0,$POS_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==2) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], iif(isnull(POEM_NO),0,$POEM_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==3) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], iif(isnull(POEMS_NO),0,$POEMS_NO_NUM) $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==4) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], iif(isnull(POT_NO),0,$POT_NO_NUM) $SortType[$order_by]";
		}elseif($DPISDB=="oci8" || $DPISDB=="mysql"){ 
			if ($search_per_type==0 || $search_per_type==1 || $search_per_type==5) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], $POS_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==2) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], $POEM_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==3) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], $POEMS_NO_NUM $SortType[$order_by]";
			elseif ($search_per_type==0 || $search_per_type==4) $order_str = "f.LEVEL_SEQ_NO $SortType[$order_by], $POT_NO_NUM $SortType[$order_by]";
		}
	} elseif($order_by==4) {	
		$order_str = "a.DEPARTMENT_ID $SortType[$order_by], PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by]";
	} elseif($order_by==5) {	
		if ($search_per_type==0 || $search_per_type==1 || $search_per_type==5) $order_str = "c.ORG_ID $SortType[$order_by], PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by]";
		elseif ($search_per_type==0 || $search_per_type==2) $order_str = "d.ORG_ID $SortType[$order_by], PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by]";
		elseif ($search_per_type==0 || $search_per_type==3) $order_str = "e.ORG_ID $SortType[$order_by], PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by]";
		elseif ($search_per_type==0 || $search_per_type==4) $order_str = "f.ORG_ID $SortType[$order_by], PER_NAME $SortType[$order_by], PER_SURNAME $SortType[$order_by]";
	} elseif($order_by==6) {	
		if ($SESS_DEPARTMENT_NAME=="กรมวิชาการเกษตร")
			$order_str = "PER_SEQ_NO $SortType[$order_by]";
		else
			$order_str = "PER_FILE_NO $SortType[$order_by]";
	}

	if($command == "SEARCH" || $command == "SEARCHNAMEHIS" || $command == "SEARCHPAY"){
		if($command == "SEARCH" || $command == "SEARCHNAMEHIS") $search_con = "a.POS_ID=c.POS_ID";
		elseif($command == "SEARCHPAY") $search_con = "a.PAY_ID=c.POS_ID";
		if($search_pos_no || $search_pos_no_name) $search_con = "a.POS_ID=c.POS_ID";
		elseif($search_pay_no) $search_con = "a.PAY_ID=c.POS_ID";
        
/* by jerd	 **********************************
		//สำหรับเงื่อนไข check คนที่ไม่มีรูปประจำตัว
		if ($search_data==11){
			if($DPISDB=="odbc"){
				$cmd = " select 	a.PER_CARDNO, a.PER_ID, a.PN_CODE, PER_NAME, PER_SURNAME, NH_NAME, NH_SURNAME
								 from (
								 			(
								 		 		(
													(
														(	
                    	                                	(
																PER_PERSONAL a
																left join PER_POSITION c on ($search_con) 
															) 	left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
														)	left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
													) 	left join PER_LEVEL f on (a.LEVEL_NO=f.LEVEL_NO)
												) 	left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
											) 	left join PER_NAMEHIS h on (a.PER_ID=h.PER_ID)
										) 	left join PER_ORG i on (c.ORG_ID=i.ORG_ID)
								$search_condition $check_condition
								 order by $order_str  ";
			}elseif($DPISDB=="oci8"){
				$search_condition = str_replace(" where ", " and ", $search_condition);
				$cmd = "select 		a.PER_CARDNO, a.PER_ID, a.PN_CODE, PER_NAME, PER_SURNAME, NH_NAME, NH_SURNAME
								from 		PER_PERSONAL a, PER_POSITION c, PER_POS_EMP d, PER_POS_EMPSER e, PER_LEVEL f, PER_POS_TEMP g, PER_NAMEHIS h, PER_ORG i
								where 	$search_con(+) and a.POEM_ID=d.POEM_ID(+) and a.POEMS_ID=e.POEMS_ID(+) and a.LEVEL_NO=f.LEVEL_NO(+) and 
												a.POT_ID=g.POT_ID(+) and a.PER_ID=h.PER_ID(+) and c.ORG_ID=i.ORG_ID(+)
												$search_condition $check_condition
								order by 	$order_str  ";
			}elseif($DPISDB=="mysql"){
				$cmd = " select 	a.PER_CARDNO, a.PER_ID, a.PN_CODE, PER_NAME, PER_SURNAME, NH_NAME, NH_SURNAME
								 from (
								 			(
								 		 		(
													(
														(	
                        	                            	(
																PER_PERSONAL a
																left join PER_POSITION c on ($search_con) 
															) 	left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
														)	left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
													) 	left join PER_LEVEL f on (a.LEVEL_NO=f.LEVEL_NO)
												) 	left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
											) 	left join PER_NAMEHIS h on (a.PER_ID=h.PER_ID)
										) 	left join PER_ORG i on (c.ORG_ID=i.ORG_ID)
												$search_condition $check_condition
										order by $order_str ";
			}
//			echo "$cmd<br>";
			$db_dpis->send_cmd($cmd);
//			$db_dpis->show_error();
			$countNOPIC=0;
			while ($data = $db_dpis->get_array()) {
				$PER_ID= trim($data[PER_ID]);
				$PER_NAME_SHOW = $data[PER_NAME];
				$PER_SURNAME_SHOW = $data[PER_SURNAME];
				$FULLNAME = "$PER_NAME_SHOW $PER_SURNAME_SHOW";
				$FULLNAMEO = "$NH_NAME $NH_SURNAME";
				$PER_CARDNO=trim($data[PER_CARDNO]);
				if(!file_exists("../attachment/pic_personal/".$PER_CARDNO."-001.jpg")){	
					//echo "[ไม่มี] $PER_CARDNO = $PER_ID :: $FULLNAME <br>";
					$arrNOPIC[]="'".$PER_ID."'";
				}else{ //มี
					//echo "[มี] $PER_CARDNO = $PER_ID :: $FULLNAME <br>";
					$arrHAVEPIC[]="'".$PER_ID."'";
				}
			} //end while
			//ใน query IN ต้องมีจำนวน list ไม่มากกว่า 1000 ถ้ามากกว่า มันจะ error
			if(is_array($arrNOPIC)){	
				$countNOPIC=count($arrNOPIC);
				for($i=0; $i < $countNOPIC; $i++){
					if($i%1000==0){
						$aa[]=$i;
					}
				}
				//วน loop เพื่อสร้าง string
				for($i=0; $i<count($aa);$i++){
					if($i==0){	//ตำแหน่งแรก
						//__echo $aa[$i]." < ".$aa[$i+1]."<br>";
						for($j=($aa[$i]); $j<($aa[$i+1]); $j++){	$strfirst.=$arrNOPIC[$j].",";	 }
					}else{
						if($i==count($aa)-1){ //ตำแหน่งสุดท้าย
							//__echo ($aa[$i])." < ".$countNOPIC."<br>";	
							for($j=($aa[$i]); $j<($countNOPIC); $j++){ $strlast.=$arrNOPIC[$j].","; }
						}else{ //ตำแหน่งอื่นๆ ซึ่งมีมากกว่า 1 อัน
							//__echo ($aa[$i])." < ".$aa[$i+1]."<br>";
							$count++;
							for($j=($aa[$i]); $j<($aa[$i+1]); $j++){ $strmid[$count] .=$arrNOPIC[$j].","; }
						}
					}
				} // end for

				//##สร้างเงื่อนไขให้ query (==First==)##
				$strfirst=substr($strfirst,0,-1);
				$check_condition = " and (a.PER_ID in (".$strfirst.") ";
				for($i=1; $i <= count($strmid); $i++){ $arr_strmid[$i]=" or a.PER_ID in ( ".substr($strmid[$i],0,-1).") "; } //end for
 				//==Middle==//
				for($i=1; $i <= count($arr_strmid); $i++){ $check_condition .= $arr_strmid[$i]; } //end for
				//==Last==//
				$strlast=substr($strlast,0,-1);
				$check_condition .= " or a.PER_ID in (".$strlast.")) ";
			} //end if(is_array($arrNOPIC))
			if(is_array($arrHAVEPIC)){	
				$countHAVEPIC=count($arrHAVEPIC);	//$check_condition = " and (a.PER_ID not in (". implode(",", $arrHAVEPIC) .")) ";	//ตัดคนที่มีออก เอาคนที่ไม่มีมา
			}
			//___echo $check_condition."<br><br>";
		}  //end if check คนที่ไม่มีรูปประจำตัว
by jerd ***************************************/

		if($command == "SEARCH") {
			if($DPISDB=="odbc"){
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	((( PER_PERSONAL a
												left join PER_POSITION c on ($search_con) 
											) left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
										) left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
									) left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
								$search_condition $check_condition ";
			}elseif($DPISDB=="oci8"){
				$search_condition = str_replace(" where ", " and ", $search_condition);
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	PER_PERSONAL a, PER_POSITION c, PER_POS_EMP d, PER_POS_EMPSER e, PER_POS_TEMP g
							   where	 $search_con(+) and a.POEM_ID=d.POEM_ID(+) and a.POEMS_ID=e.POEMS_ID(+) and a.POT_ID=g.POT_ID(+) 
								$search_condition $check_condition ";
			}elseif($DPISDB=="mysql"){
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	((( PER_PERSONAL a
												left join PER_POSITION c on ($search_con) 
											) left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
										) left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
									) left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
								$search_condition $check_condition ";
			} // end if
		} elseif($command == "SEARCHNAMEHIS") {
			if($DPISDB=="odbc"){
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	(((( PER_PERSONAL a
												left join PER_POSITION c on ($search_con) 
											) left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
										) left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
									) left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
								) 	left join PER_NAMEHIS h on (a.PER_ID=h.PER_ID)
								$search_condition $check_condition ";
			}elseif($DPISDB=="oci8"){ 
				$search_condition = str_replace(" where ", " and ", $search_condition);
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	PER_PERSONAL a, PER_POSITION c, PER_POS_EMP d, PER_POS_EMPSER e, PER_POS_TEMP g, PER_NAMEHIS h
							   where	 $search_con(+) and a.POEM_ID=d.POEM_ID(+) and a.POEMS_ID=e.POEMS_ID(+) and a.POT_ID=g.POT_ID(+) and a.PER_ID=h.PER_ID(+)
								$search_condition $check_condition ";
			}elseif($DPISDB=="mysql"){
				$cmd = " select 	count(a.PER_ID) as count_data 
								from 	(((( PER_PERSONAL a
												left join PER_POSITION c on ($search_con) 
											) left join PER_POS_EMP d on (a.POEM_ID=d.POEM_ID)
										) left join PER_POS_EMPSER e on (a.POEMS_ID=e.POEMS_ID) 
									) left join PER_POS_TEMP g on (a.POT_ID=g.POT_ID)
								) 	left join PER_NAMEHIS h on (a.PER_ID=h.PER_ID)
								$search_condition $check_condition ";
			} // end if
		} // end if

		$db_dpis->send_cmd($cmd);
//		$db_dpis->show_error();
		$data = $db_dpis->get_array();
		$data = array_change_key_case($data, CASE_LOWER);
		$count_data = $data[count_data];	
//		if(isset($countNOPIC)){	$count_data = $countNOPIC; }
		echo "cmd=$cmd ($count_data)<br>";

        // 	เกี่ยวกับรูปภาพ
		if ($count_data > 0) {
			if ($search_data==11 || $search_data==13) {	// กรณีค้นหา ไม่มีรูปภาพ หรือ ไม่มีลายเซ็น
                $cmd1 = str_replace("count(a.PER_ID) as count_data","a.PER_ID",$cmd);
//				echo "$cmd1<br>";
				$db_dpis1->send_cmd($cmd1);
				$arr_per_id = (array) null;	// select per_id not in $arr_per_id
                $cnt_deduct = 0;
				while ($data1 = $db_dpis1->get_array()) {
					$TMP_PER_ID = $data1[PER_ID];
//					echo "TMP_PER_ID=$TMP_PER_ID<br>";
					if ($TMP_PER_ID) {
						if ($search_data==11) {	// รูปภาพ
	                    	$cmd2 = " select * from PER_PERSONALPIC where PER_ID=$TMP_PER_ID and PIC_SHOW=1 and (PIC_SIGN <> 1 or PIC_SIGN is NULL) order by PER_ID, PER_PICSEQ ";
						} else {	// รูปลายเซ็น $search_data==13
	                    	$cmd2 = " select * from PER_PERSONALPIC where PER_ID=$TMP_PER_ID and PIC_SHOW=1 and PIC_SIGN = 1 order by PER_ID, PER_PICSEQ ";
						}
                        $db_dpis2->send_cmd($cmd2);
//						echo "cmd2=$cmd2<br>";
						$founded = false;
						while ($data2 = $db_dpis2->get_array()) {
							$TMP_PIC_SEQ = $data2[PER_PICSEQ];
//							echo "CARD=".$data2[PER_CARDNO]."-".$TMP_PIC_SEQ."<br>";
							$current_list .= ((trim($current_list))?",":"") . $TMP_PIC_SEQ;
							$T_PIC_SEQ = substr("000",0,3-strlen("$TMP_PIC_SEQ"))."$TMP_PIC_SEQ";
							$TMP_SERVER = $data2[PIC_SERVER_ID];
							$TMP_PIC_SIGN= $data2[PIC_SIGN];

							if ($TMP_SERVER) {
								$cmd3 = " SELECT * FROM OTH_SERVER WHERE SERVER_ID=$TMP_SERVER ";
                                $db_dpis3->send_cmd($cmd3);
                                $data3 = $db_dpis3->get_array();
                                $tmp_SERVER_NAME = trim($data3[SERVER_NAME]);
                                $tmp_ftp_server = trim($data3[FTP_SERVER]);
                                $tmp_ftp_username = trim($data3[FTP_USERNAME]);
                                $tmp_ftp_password = trim($data3[FTP_PASSWORD]);
                                $tmp_main_path = trim($data3[MAIN_PATH]);
                                $tmp_http_server = trim($data3[HTTP_SERVER]);
                            } else {
                                $TMP_SERVER = 0;
                                $tmp_SERVER_NAME = "";
                                $tmp_ftp_server = "";
                                $tmp_ftp_username = "";
                                $tmp_ftp_password = "";
                                $tmp_main_path = "";
                                $tmp_http_server = "";
							}
							$SIGN_NAME = "";
							if($TMP_PIC_SIGN==1){ $SIGN_NAME = "SIGN"; }
							if (trim($data2[PER_CARDNO]) && trim($data2[PER_CARDNO]) != "NULL") {
								$TMP_PIC_NAME = $data2[PER_PICPATH].$data2[PER_CARDNO]."-".$SIGN_NAME.$T_PIC_SEQ.".jpg".($tmp_SERVER_NAME ? " [".$tmp_SERVER_NAME."]" : "");
								$TMP_SHOW_PIC = ($tmp_http_server ? $tmp_http_server."/" : "").$data2[PER_PICPATH].$data2[PER_CARDNO]."-".$SIGN_NAME.$T_PIC_SEQ.".jpg";
							} else {
                                $TMP_PIC_NAME = $data2[PER_PICPATH].$data2[PER_GENNAME]."-".$SIGN_NAME.$T_PIC_SEQ.".jpg".($tmp_SERVER_NAME ? " [".$tmp_SERVER_NAME."]" : "");
                                $TMP_SHOW_PIC = ($tmp_http_server ? $tmp_http_server."/" : "").$data2[PER_PICPATH].$data2[PER_CARDNO]."-".$SIGN_NAME.$T_PIC_SEQ.".jpg";
                            }
                            if (file_exists($TMP_SHOW_PIC)) {
//								echo "$TMP_SHOW_PIC exist<br>"; 
//								$arr_per_id[] = $TMP_PER_ID;
                                $founded = true;
                                break;
//							} else {
//								echo "$TMP_SHOW_PIC not exist<br>";
//								$cnt_deduct++;
							}
						} // end while ($data2 = $db_dpis2->get_array())
                        if ($founded) {
//							echo "$TMP_PER_ID-$TMP_SHOW_PIC exist<br>"; 
                            $arr_per_id[] = $TMP_PER_ID;
                        } else {
//							echo "$TMP_PER_ID-$TMP_SHOW_PIC not exist<br>";
//							$cnt_deduct++;
                        }
                    }
                } // end while
                if (count($arr_per_id) > 0) {
                	$check_condition = " and	(a.PER_ID not in (".implode(",",$arr_per_id).")) ";
					$count_data -= count($arr_per_id);
				}
//				$count_data -= $cnt_deduct;
            } // end if ($search_data==11 || $search_data==13)
        } // end if ($count_data > 0)
        // จบ เกี่ยวกับรูปภาพ

		if ($show_topic!=3) {
			$total_page = ceil( $count_data / $data_per_page );
			$page_link = create_link_page($total_page, $current_page);
			$limit_data = "";	
		}
	} // end if $command == "SEARCH" || $command == "SEARCHNAMEHIS" || $command == "SEARCHPAY"
// 	echo "6.command=$command LEVEL_NO=$LEVEL_NO<br>";
?>

<html>
<head>
<title>test for personal_master</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"> <!--//---เพิ่มมาจาก personal_master_form--->
<META HTTP-EQUIV="Cache-Control" CONTENT="NO-CACHE"> <!--//---เพิ่มมาจาก personal_master_form--->
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/> <!--//---เพิ่มมาจาก personal_master_form--->
</head>
<!-------------------------------------------------------------------------------------------->
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script> 
<!-------------------------------------------------------------------------------------------->
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript">
 
	var age_limit = 61;
	<? if($start_age > 0){ ?>age_limit = <?=$start_age; ?>; <? } ?>
	
	function change_current_page( page ){
		form0.current_page.value = page;
		form0.submit();
	}

	function confirm_delete_main(data_id , data_label){
		if(confirm("คุณต้องการลบ  ข้อมูลบุคคล [ " + data_label + " ] ใช่หรือไม่ ?")){
			form0.command.value = "DELETE";
			form0.PER_ID.value = data_id;
			form0.submit();
		} // end if
	}

	function call_edit_personal (per_id, per_type) {
		if (!per_type||per_type<=0){ per_type=1; }
		parent.refresh_opener("2<::>"+per_id+"<::>"+per_type+"<::>UPD=1<::>");
	}

	function call_view_personal (per_id) {
		parameter = "";
		if(per_id > 0) parameter = "&PER_ID=" + per_id;
	    call_openDialog("personal_master_form.html?VIEW=1&MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1200,700,"ข้อมูลทั่วไป");		
	}

	function call_desc_personal (per_id) {
/*		parameter = "";
		if(per_id > 0) parameter = "&PER_ID=" + per_id;
	    call_openDialog("personal_master_desc.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1200,650,"รายละเอียดข้าราชการ/ลูกจ้างประจำ");		*/
		if (per_id) {
			alert("per_id="+per_id);
			form0.PER_ID.value = per_id;
			alert("222");
//			change_div(3);
			form0.action+='?UPD=1';
			alert("333->"+form0.action);
//			form0.PER_TYPE.value=$TMP_PER_TYPE;
			form0.show_topic.value=3;
			alert("444");
			form0.submit();
		} else {
			alert("ข้อมูลบุคคล ต้องเลือกบุคคลก่อน");
		}
	}	
	
	function call_search_ministry () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&send_by=search_ministry&OL_CODE=01&PV_CODE=" + PROVINCE_CODE;
	    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MINISTRY_TITLE?>");		
	}

	function call_search_department () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MINISTRY_ID":"form0.search_ministry_id.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=search_department&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form0.btn_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_search_org_0 () {	
		var DEPARTMENT_ID = <?=(($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4)?"$DEPARTMENT_ID":"form0.search_department_id.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(DEPARTMENT_ID != ""){
			if(form0.select_org_structure[0].checked) org_search_file ="search_org";
			else if(form0.select_org_structure[1].checked) org_search_file ="search_org_ass"; 
			parameter = "&send_by=search_org_0&OL_CODE=03&ORG_ID_REF=" + DEPARTMENT_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1100,600,"<?=$ORG_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
			alert('<?=$DEPARTMENT_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$DEPARTMENT_ALERT?>');
			form0.btn_department.focus();
			<? } ?>
		} // end if
	}

	function call_search_org1 () {	
		var ORG_ID = form0.search_org_id.value;

		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(ORG_ID != ""){
			if(form0.select_org_structure[0].checked) org_search_file ="search_org";
			else if(form0.select_org_structure[1].checked) org_search_file ="search_org_ass"; 
			parameter = "&send_by=search_org1&OL_CODE=04&ORG_ID_REF=" + ORG_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE1?>");		
		}else{
			<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
			alert('<?=$ORG_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$ORG_ALERT?>');
			form0.btn_org_1.focus();
			<? } ?>
		} // end if
	}

	function call_search_mgt () {	
		var parameter = "";
	    call_openDialog("search_mgt.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$PM_TITLE?>");		
	}

	function call_search_perline () {	
		var parameter = "";
		var PER_TYPE = form0.search_per_type.options[form0.search_per_type.options.selectedIndex].value
		parameter = "&PER_TYPE="+PER_TYPE;
		if(PER_TYPE==1 || PER_TYPE == 0){
		    call_openDialog("search_perline.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$POSITION_TITLE?>");		
		}else if(PER_TYPE==2){
		    call_openDialog("search_pos_name.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$POS_EMP_TITLE?>");		
		}else if(PER_TYPE==3){
		    call_openDialog("search_empser_pos_name.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$POS_EMPSER_TITLE?>");		
		}else if(PER_TYPE==4){
		    call_openDialog("search_temp_pos_name.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$POS_TEMP_TITLE?>");		
		}
	}

	function RedirectSite(per_id){
		var site= form0.SEARCHHIS.options[form0.SEARCHHIS.options.selectedIndex].value+'.html';
//	MENU_ID_LV0   &MENU_ID_LV1=  &MENU_ID_LV2=  &MENU_ID_LV3=
//		var site= "personal_master.html";
		parameter = "&PER_ID="+per_id;
		window.location=site+"?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter;
	}

	function clear_form() {
		form0.search_name.value = "";
		form0.search_surname.value = "";
		form0.search_pos_no.value = "";
		<? if ($POSITION_NO_CHAR=="Y") { ?> form0.search_pos_no_name.value = ""; <? } ?>
		<? if ($SESS_DEPARTMENT_NAME=="กรมการปกครอง") { ?> form0.search_pay_no.value = ""; <? } ?>
		form0.search_cardno.value = "";
		form0.search_offno.value = "";
		form0.search_per_type[form0.search_per_type.length].selected = true;
		form0.search_per_status[0].selected = true;
//		form0.order_by[0].checked = true;
		form0.order_by.value = "1";
		form0.search_pl_name.value = "";
		form0.search_pl_code.value = "";
		form0.search_pm_name.value = "";
		form0.search_pm_code.value = "";
	}
	
	function call_sort(flag) {
/*	
		if (flag==1) {
			form0.order_by.value="1";		form0.sort_by.value="1";
			if(form0.sort_type.value=="1:asc"){
				form0.sort_type.value="1:desc";
			}else{ //desc
				form0.sort_type.value="1:asc";
			}
		} else if (flag==2) {
			form0.order_by.value="2";		form0.sort_by.value="2";
			if(form0.sort_type.value=="2:asc"){
				form0.sort_type.value="2:desc";
			}else{ //desc
				form0.sort_type.value="2:asc";
			}
		} else if (flag==3) {
			form0.order_by.value="3";		form0.sort_by.value="3";
			if(form0.sort_type.value=="3:asc"){
				form0.sort_type.value="3:desc";
			}else{ //desc
				form0.sort_type.value="3:asc";
			}
		} else if (flag==4) {
			form0.order_by.value="4";		form0.sort_by.value="4";
			if(form0.sort_type.value=="4:asc"){
				form0.sort_type.value="4:desc";
			}else{ //desc
				form0.sort_type.value="4:asc";
			}
		} else if (flag==5) {
			form0.order_by.value="5";		form0.sort_by.value="5";
			if(form0.sort_type.value=="5:asc"){
				form0.sort_type.value="5:desc";
			}else{ //desc
				form0.sort_type.value="5:asc";
			}
		} else if (flag==6) {
			form0.order_by.value="6";		form0.sort_by.value="6";
			if(form0.sort_type.value=="6:asc"){
				form0.sort_type.value="6:desc";
			}else{ //desc
				form0.sort_type.value="6:asc";
			}
		} else if (flag==7) {
			form0.order_by.value="7";		form0.sort_by.value="7";
			if(form0.sort_type.value=="7:asc"){
				form0.sort_type.value="7:desc";
			}else{ //desc
				form0.sort_type.value="7:asc";
			}
		} 
		form0.command.value='SEARCH';
		form0.submit();
*/	
		
		form0.order_by.value=flag;		form0.sort_by.value=flag;
		if(form0.sort_type.value==flag+":asc"){
			form0.sort_type.value=flag+":desc";
		}else{ //desc
			form0.sort_type.value=flag+":asc";
		}		
		form0.command.value='SEARCH';
		form0.submit();
	} // end function call_sort

	function dum_change_div(div_id){	
		alert("div_id="+div_id);
	}
	
	function change_div(div_id){	
		alert("div_id="+div_id);
		var formname = new Array('form0','form1','form11');
		alert("formname.length="+formname.length);
		for(var i=0; i < formname.length; i++){
			eval("document.all.DIV_TOPIC_" + eval(formname[i]).show_topic.value + ".style.display='none'");
			eval("document.all.DIV_TOPIC_" + div_id + ".style.display='block'");
	
			eval("document.all.CELL_TOPIC_" + eval(formname[i]).show_topic.value + ".className='table_body'");
			eval("document.all.CELL_TOPIC_" + div_id + ".className='table_body_3'");
			eval(formname[i]).show_topic.value = div_id;
		}
		// เอา input จาก form personal_master ใส่ใน personal_master_form //
/*		if (div_id!=3) {
			if (form1.search_org_name) form1.search_org_name.value = form0.search_org_name.value;
			if (form1.search_org_id) form1.search_org_id.value = form0.search_org_id.value;
			if (form1.search_org_name_1) form1.search_org_name_1.value = form0.search_org_name_1.value;
			if (form1.search_org_id_1) form1.search_org_id_1.value = form0.search_org_id_1.value;
			if (form1.search_name) form1.search_name.value = form0.search_name.value;
			if (form1.search_surname) form1.search_surname.value = form0.search_surname.value;
			if (form1.search_cardno) form1.search_cardno.value = form0.search_cardno.value;
			if (form1.search_offno) form1.search_offno.value = form0.search_offno.value;
			if (form1.search_pos_no) form1.search_pos_no.value = form0.search_pos_no.value;
			<? if ($POSITION_NO_CHAR=="Y") { ?> if(form0.search_pos_no_name.value)	form1.search_pos_no_name.value = form0.search_pos_no_name.value;<? } ?>
			<? if ($SESS_DEPARTMENT_NAME=="กรมการปกครอง") { ?> if(form0.search_pay_no.value)	form1.search_pay_no.value = form0.search_pay_no.value; <? } ?>
			if (form1.search_pl_name) form1.search_pl_name.value = form0.search_pl_name.value;
			if (form1.search_pl_code) form1.search_pl_code.value = form0.search_pl_code.value;
			if (form1.search_pm_name) form1.search_pm_name.value = form0.search_pm_name.value;
			if (form1.search_pm_code) form1.search_pm_code.value = form0.search_pm_code.value;
			if (form1.search_per_status) form1.search_per_status.value = form0.search_per_status.value;
			if (form1.search_per_type) form1.search_per_type.value = form0.search_per_type.value;
			if (form1.search_data) form1.search_data.value = form0.search_data.value;
			if (form1.SEARCHHIS) form1.SEARCHHIS.value = form0.SEARCHHIS.value;
		}*/
		//------------------------------------------------------------------------------------
	}

	//-----จาก personal_master_form.html-----//
	function changedateformat(name,str) {
		var arr = str.split('/');
		if((str) && (str != arr[0]+'/'+arr[1]+'/'+arr[2])){
			name.value = str.substr(0,2) + "/" + str.substr(2,2) + "/"  + str.substr(4,4) ;
		}
		chk_date(name, "BDH");
	}
	
	function confirm_delete_form(per_id , per_name){
		if(confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่ [ " + per_name + " ] ?")){
			form1.command.value = "DELETE";
			form1.PER_ID.value = per_id;
			form1.submit();
		} // end if
	}

	function call_search_off_type () {	
		parameter = "";
	    call_openDialog("search_offtype.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$OFF_TYPE_TITLE?>");		
	}

	function call_search_province () {	
		parameter = "&CT_CODE=140";		// ประเทศไทย
	    call_openDialog("search_province.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$PV_TITLE?>");		
	}

	function call_search_emp_status () {	
		parameter = "";	
	    call_openDialog("search_emp_status.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ES_TITLE?>");		
	}

	function call_search_movment () {	
		parameter = "";		
	    call_openDialog("search_movment.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MOV_TITLE?>");		
	}

	function call_search_main_ministry () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&send_by=search_main_ministry&OL_CODE=01&PV_CODE=" + PROVINCE_CODE;
	    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$MINISTRY_TITLE?>");		
	}

	function call_search_main_department () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MAIN_MINISTRY_ID":"form1.MAIN_MINISTRY_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=search_main_department&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form1.btn_main_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_search_department_ass () {
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MAIN_MINISTRY_ID":"form1.MAIN_MINISTRY_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&send_by=search_department_ass&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE;
		    call_openDialog("search_org_ass.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$DEPARTMENT_TITLE?>");		
		}else{
			<? if($CTRL_TYPE==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form1.btn_main_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_search_position () {
		//alert(form1.PER_TYPE.value);
		parameter = per_type = "";
		<? if(!trim($SESS_DEPARTMENT_NAME)){ ?>
				var LOGIN_DEPARTMENT_NAME = form1.MAIN_DEPARTMENT_NAME.value;
		<? }else{ ?> 
				var LOGIN_DEPARTMENT_NAME ='<?=trim($SESS_DEPARTMENT_NAME); ?>';		
		<? } ?>
		//__alert(LOGIN_DEPARTMENT_NAME);
		if (form1.PER_TYPE.value == 1) {
			parameter = "&POS_ID=" + form1.CHK_POS_ID.value;
			per_type = 1;
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_position";
			}else{
			<? if($BKK_FLAG==1){ ?>
				search_sitename = "search_position";
			<? }else{ ?>
				search_sitename = "search_position_vacant";
			<? } ?>
			}			
		} else if (form1.PER_TYPE.value == 2) { 
			parameter = "&POEM_ID=" + form1.CHK_POS_ID.value;
			per_type = 2;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_emp";
			}else{
				search_sitename = "search_pos_emp_vacant";
			}
		} else if (form1.PER_TYPE.value == 3) {
			parameter = "&POEMS_ID=" + form1.CHK_POS_ID.value;
			per_type = 3;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_empser";
			}else{
				search_sitename = "search_pos_empser_vacant";
			}
		} else if (form1.PER_TYPE.value == 4) {
			parameter = "&POT_ID=" + form1.CHK_POS_ID.value;
			per_type = 4;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_temp";
			}else{
				search_sitename = "search_pos_temp_vacant";
			}
		}
		parameter += "&send_by=search_position";
	    call_openDialog(search_sitename+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>" + parameter,1100,600,"ตำแหน่ง");		
	}

	function call_search_pay () {	
		parameter = per_type = "";
		parameter += "&send_by=search_pay";
		<? if(!trim($SESS_DEPARTMENT_NAME)){ ?>
				var LOGIN_DEPARTMENT_NAME = form1.MAIN_DEPARTMENT_NAME.value;
		<? }else{ ?> 
				var LOGIN_DEPARTMENT_NAME ='<?=trim($SESS_DEPARTMENT_NAME); ?>';		
		<? } ?>
		//__alert(LOGIN_DEPARTMENT_NAME);
		if (form1.PER_TYPE.value == 1) {
			parameter = "&PAY_ID=" + form1.CHK_PAY_ID.value;
			per_type = 1;
//			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_position";
//			}else{
//				search_sitename = "search_position_vacant";
//			}
		    call_openDialog(search_sitename+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>" + parameter,800,600,"ตำแหน่ง");		
		} else if (form1.PER_TYPE.value == 2) { 
			parameter = "&POEM_ID=" + form1.CHK_PAY_ID.value;
			per_type = 2;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_emp";
			}else{
				search_sitename = "search_pos_emp_vacant";
			}
		    call_openDialog(search_sitename+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>" + parameter,800,600,"ตำแหน่ง");
		} else if (form1.PER_TYPE.value == 3) {
			parameter = "&POEMS_ID=" + form1.CHK_PAY_ID.value;
			per_type = 3;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_empser";
			}else{
				search_sitename = "search_pos_empser_vacant";
			}
		    call_openDialog(search_sitename+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>" + parameter,800,600,"ตำแหน่ง");
		} else if (form1.PER_TYPE.value == 4) {
			parameter = "&POT_ID=" + form1.CHK_PAY_ID.value;
			per_type = 4;			
			if(LOGIN_DEPARTMENT_NAME=="กรมการปกครอง"){
				search_sitename = "search_pos_temp";
			}else{
				search_sitename = "search_pos_temp_vacant";
			}
		    call_openDialog(search_sitename+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>" + parameter,800,600,"ตำแหน่ง");
		}
	}

	function call_search_org (select_org_structure, select_type,obj_id,obj_name) {
		// form1.ASS_ORG_NAME.value=''; form1.ASS_ORG_ID.value=''; form1.ASS_ORG_NAME_1.value=''; form1.ASS_ORG_ID_1.value=''; form1.ASS_ORG_NAME_2.value=''; form1.ASS_ORG_ID_2.value='';  return false;
		var DEPARTMENT_ID = <?=(($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4)?"$DEPARTMENT_ID":"form1.MAIN_DEPARTMENT_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		var dept_element =  document.getElementsByName("ASS_DEPARTMENT_ID")[0];
		if (typeof(dept_element) != 'undefined' && dept_element != null)
		{
			  // exists.
//			  alert("exist");
			if(select_org_structure==1) DEPARTMENT_ID = form1.ASS_DEPARTMENT_ID.value;
			else DEPARTMENT_ID = form1.MAIN_DEPARTMENT_ID.value;
		} else {
//			alert("not exist");
			DEPARTMENT_ID = form1.MAIN_DEPARTMENT_ID.value;
		}
		if(DEPARTMENT_ID != ""){
			if(select_org_structure==0) org_search_file ="search_org";
			else if(select_org_structure==1) org_search_file ="search_org_ass"; 
			parameter = "&OL_CODE=03&ORG_ID_REF=" + DEPARTMENT_ID + "&PV_CODE=" + PROVINCE_CODE + "&send_by=search_org_ass";
//			alert("parameter="+parameter);
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE?>");
		}else{
			if(select_type==2){	
				<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
				alert('<?=$DEPARTMENT_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
				<? }else{ ?>
				alert('<?=$DEPARTMENT_ALERT?>');
				form1.btn_main_department.focus();	
				<? } ?>
			}
		} // end if
	}

	function call_search_org_1 (select_org_structure) {	
		if(select_org_structure==0) org_search_file ="search_org";
		else if(select_org_structure==1) org_search_file ="search_org_ass"; 			ORG_ID=form1.ASS_ORG_ID.value;			btnName="btn_select_orgass_0";
		if(ORG_ID != ""){
			parameter = "&send_by=search_org_1&OL_CODE=04&ORG_ID_REF=" + ORG_ID;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE1?>");		
		}else{
			alert("กรุณาเลือก<?=$ORG_TITLE?>");
			eval("form1."+btnName).focus();
		} // end if
	}
	
	function call_search_org_2 (select_org_structure) {	
		if(select_org_structure==0) org_search_file ="search_org";
		else if(select_org_structure==1) org_search_file ="search_org_ass"; 		ORG_ID_1 = form1.ASS_ORG_ID_1.value;		btnName="btn_select_orgass_1";
		if(ORG_ID_1 != ""){
			parameter = "&send_by=search_org_2&OL_CODE=05&ORG_ID_REF=" + ORG_ID_1;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE2?>");		
		}else{
			alert("กรุณาเลือก<?=$ORG_TITLE1?>");
			eval("form1."+btnName).focus();
		} // end if
	}
	
	function call_search_org_3 (select_org_structure) {	
		if(select_org_structure==0) org_search_file ="search_org";
		else if(select_org_structure==1) org_search_file ="search_org_ass"; 		ORG_ID_2 = form1.ASS_ORG_ID_2.value;			btnName="btn_select_orgass_2";
		if(ORG_ID_2 != ""){
			parameter = "&send_by=search_org_3&OL_CODE=06&ORG_ID_REF=" + ORG_ID_2;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE3?>");		
		}else{
			alert("กรุณาเลือก<?=$ORG_TITLE2?>");
			eval("form1."+btnName).focus();
		} // end if
	}

	function call_search_org_4 (select_org_structure) {	
		if(select_org_structure==0) org_search_file ="search_org";
		else if(select_org_structure==1) org_search_file ="search_org_ass"; 		ORG_ID_3 = form1.ASS_ORG_ID_3.value;			btnName="btn_select_orgass_3";
		if(ORG_ID_3 != ""){
			parameter = "&send_by=search_org_4&OL_CODE=07&ORG_ID_REF=" + ORG_ID_3;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE4?>");		
		}else{
			alert("กรุณาเลือก<?=$ORG_TITLE3?>");
			eval("form1."+btnName).focus();
		} // end if
	}

	function call_search_org_5 (select_org_structure) {	
		if(select_org_structure==0) org_search_file ="search_org";
		else if(select_org_structure==1) org_search_file ="search_org_ass"; 		ORG_ID_4 = form1.ASS_ORG_ID_4.value;			btnName="btn_select_orgass_4";
		if(ORG_ID_4 != ""){
			parameter = "&send_by=search_org_5&OL_CODE=08&ORG_ID_REF=" + ORG_ID_4;
		    call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"<?=$ORG_TITLE5?>");		
		}else{
			alert("กรุณาเลือก<?=$ORG_TITLE4?>");
			eval("form1."+btnName).focus();
		} // end if
	}

	function call_search_salary () {	
		PER_TYPE=form1.PER_TYPE.value;
		var LEVEL_NO = form1.LEVEL_NO.value.trim();
		var POS_ID = form1.POS_ID.value.trim();
	
		if(PER_TYPE==2){			
			parameter = "&POEM_ID=" + POS_ID;
		    call_openDialog("search_layer_emp.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"บัญชีอัตราเงินเดือนลูกจ้าง");		
		}else{
			if(LEVEL_NO != ""){
				parameter = "&PER_TYPE=" + PER_TYPE + "&LEVEL_NO=" + LEVEL_NO;
			    call_openDialog("search_layer.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"บัญชีอัตราเงินเดือน");		
			}else{
				alert("กรุณาเลือกระดับตำแหน่งก่อน");
			} // end if
		} // end if
	}
	
	function check_salary_type(VAR_TYPE, VALUE){
//		alert(">>VAR_TYPE="+VAR_TYPE+", VALUE="+VALUE);
		if(VAR_TYPE==1){	//ระดับตำแหน่ง
			var LEVEL_NO = VALUE.trim();
			//var objPerType = document.getElementsByName("PER_TYPE");
			//for(var i=0; i<objPerType.length; i++)	if(form1.PER_TYPE[i].selected) PER_TYPE = form1.PER_TYPE[i].value;
			PER_TYPE=form1.PER_TYPE.value;
		}else{	//==2 ประเภทบุคลากร
			var PER_TYPE = VALUE;
			var LEVEL_NO = form1.LEVEL_NO.value.trim();
			form1.submit();
		} 

		if(PER_TYPE==2){
			form1.PER_SALARY.readOnly = true;
		}else{
			if(LEVEL_NO== "" || LEVEL_NO==0){
				form1.PER_SALARY.readOnly = true;
			}else{			
				document.all.PROCESS_IFRAME.src = "find_salary_type.html?PER_TYPE="+PER_TYPE+"&LEVEL_NO="+LEVEL_NO;
			} 
		} // end if
	} 
		
	function control_salary_box(SALARY_TYPE){
		if(SALARY_TYPE==1){		//จาก find_salary_type.html
			//form1.PER_SALARY.readOnly = true;	//return 1 และ ช่องอัตราเงินเดือนของ พนง. จะกรอก/เพิ่มไม่ได้
			form1.PER_SALARY.readOnly = false;
		}else{
			form1.PER_SALARY.readOnly = false;
		}
	}
	
	function clearAll_input(){
		form1.PER_ID.value=''; 
		form1.UPD.value=''; 
		if(form1.UPD1)	form1.UPD1.value='';
		//form1.PER_TYPE[0].selected = true;
		form1.PER_STATUS[0].selected = true;
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.PN_CODE[0].selected = true;
		<? }else{ ?>
				form1.PN_NAME.value = "";
		<? } ?>
		form1.PER_NAME.value = "";
		form1.PER_SURNAME.value = "";
		form1.PN_ENG_NAME.value = "";
		form1.PER_NICKNAME.value = "";
		form1.PER_ENG_NAME.value = "";
		form1.PER_ENG_SURNAME.value = "";
		form1.OT_NAME.value = "";
		form1.PER_CARDNO.value = "";
		form1.PER_OFFNO.value = "";
		form1.PER_OFFNO.value = "";
		form1.PER_TAXNO.value = "";
		form1.ES_CODE.value = "";
		form1.ES_NAME.value = "";
		form1.PER_BIRTHDATE.value = "";
		form1.PV_NAME_PER.value = "";
		form1.PV_CODE_PER.value = "";
		form1.PER_STARTDATE.value = "";
		form1.PER_OCCUPYDATE.value = "";
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
			form1.LEVEL_NO.value = "";
		<? } else { ?>
			form1.LEVEL_NAME.value = "";
		<? } ?>
		<? if (!$RPT_N) { ?>form1.LEVEL_NO_SALARY.value = "";<? } ?>
		form1.PER_DISABILITY[0].checked = true;		form1.PER_DISABILITY[1].checked = false;
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.PER_BLOOD[0].selected = true;
		<? } else { ?>
				form1.BL_NAME.value = "";
		<? } ?>
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.RE_CODE.value = "";
		<? } else { ?>
				form1.RE_NAME.value = "";
		<? } ?>
		form1.PER_START_ORG.value = "";
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.MR_CODE[0].selected = true;
		<? } else { ?>
				form1.MR_NAME.value = "";
		<? } ?>
		form1.MOV_CODE.value = "";
		form1.MOV_NAME.value = "";
		form1.PER_POSDATE.value = "";
		form1.PER_DOCDATE.value = "";
		form1.PER_DOCNO.value = "";
		form1.PER_ADD1.value = "";
		form1.PER_ADD2.value = "";
		form1.PER_HOME_TEL.value = "";
		form1.PER_OFFICE_TEL.value = "";
		form1.PER_FAX.value = "";
		form1.PER_MOBILE.value = "";
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.PN_CODE_F[0].selected = true;
		<? } else { ?>
				form1.PN_FATHERNAME.value = "";
		<? } ?>
		form1.PER_FATHERNAME.value = "";
		form1.PER_FATHERSURNAME.value = "";
		<? if(($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y") && !$VIEW) { ?>
				form1.PN_CODE_M[0].selected = true;
		<? } else { ?>
				form1.PN_MOTHERNAME.value = "";
		<? } ?>
		form1.PER_MOTHERNAME.value = "";
		form1.PER_MOTHERSURNAME.value = "";
		form1.SHOW_SPOUSE.value = "";
		form1.PER_CERT_OCC.value = "";
		form1.PER_EMAIL.value = "";
		form1.PER_FILE_NO.value = "";
		form1.PER_BANK_ACCOUNT.value = "";
		form1.PER_COOPERATIVE_NO.value = "";
		if(form1.PER_MEMBERDATE)			form1.PER_MEMBERDATE.value = "";
		if(form1.PER_UNIONDATE)			form1.PER_UNIONDATE.value = "";
		if(form1.PER_UNIONDATE1)			form1.PER_UNIONDATE1.value = "";
		if(form1.PER_UNIONDATE2)			form1.PER_UNIONDATE2.value = "";
		if(form1.PER_UNIONDATE3)			form1.PER_UNIONDATE3.value = "";
		if(form1.PER_UNIONDATE4)			form1.PER_UNIONDATE4.value = "";
		if(form1.PER_UNIONDATE5)			form1.PER_UNIONDATE5.value = "";
		form1.PER_ORDAIN_DETAIL.value = "";
		form1.PER_COOPERATIVE.checked = false;
		if(form1.PER_MEMBER)	form1.PER_MEMBER.checked = false;
		if(form1.PER_UNION)	form1.PER_UNION.checked = false;
		if(form1.PER_UNION2)	form1.PER_UNION2.checked = false;
		if(form1.PER_UNION3)	form1.PER_UNION3.checked = false;
		if(form1.PER_UNION4)	form1.PER_UNION4.checked = false;
		if(form1.PER_UNION5)	form1.PER_UNION5.checked = false;
		form1.PER_ORDAIN.checked = false;
		form1.PER_SOLDIER.checked = false;
		if(form1.PER_CONTACT_COUNT)	form1.PER_CONTACT_COUNT.value = "";
		if(form1.PER_CONTACT_PERSON)	form1.PER_CONTACT_PERSON.value = "";
		form1.PER_JOB.value = "";
		form1.PER_REMARK.value = "";
		form1.SHOW_UPDATE_USER.value = "";
		form1.SHOW_UPDATE_DATE.value = "";
		<? if ($POSITION_NO_CHAR=="Y") { ?> form1.POS_NO_NAME.value = "";<? } ?>
		form1.POS_NO.value = "";
		form1.POS_ID.value = "";
		form1.CHK_POS_ID.value = "";
		form1.SG_NAME.value = "";
		form1.SKILL_NAME.value = "";
		if(form1.SG_NAME1)	form1.SG_NAME1.value = "";
		if(form1.SKILL_NAME1)	form1.SKILL_NAME1.value = "";
		<? if ($SESS_DEPARTMENT_NAME=="กรมการปกครอง") { ?>
			form1.PAY_NO.value = "";
			form1.PAY_ID.value = "";
			form1.CHK_PAY_ID.value = "";
		<? } ?>
		form1.PER_SALARY.value = 0;
		form1.PER_ORGMGT.checked = false;
		form1.ASS_ORG_ID.value = "";
		form1.ASS_ORG_NAME.value = "";
		form1.ASS_ORG_ID_1.value = "";
		form1.ASS_ORG_NAME_1.value = "";
		form1.ASS_ORG_ID_2.value = "";
		form1.ASS_ORG_NAME_2.value = ""; 
		<? if($SESS_ORG_SETLEVEL== 3 || $SESS_ORG_SETLEVEL== 4 || $SESS_ORG_SETLEVEL==5) { ?>
				form1.ASS_ORG_ID_3.value = "";				form1.ASS_ORG_NAME_3.value = ""; 
				form1.ASS_ORG_ID_4.value = "";				form1.ASS_ORG_NAME_4.value = ""; 
				form1.ASS_ORG_ID_5.value = "";				form1.ASS_ORG_NAME_5.value = ""; 
		<? } ?>
		form1.PER_MGTSALARY.value = 0;
		if(form1.PER_EXTRA_INCOME)	form1.PER_EXTRA_INCOME.value = 0;
		form1.PL_NAME.value = "";
		form1.PM_NAME.value = "";
		form1.CL_NAME.value = "";
		form1.PT_NAME.value = "";
		<? if($PER_TYPE==2){ ?>
			form1.PG_NAME.value = "";
			form1.PG_NAME_SALARY.value = "";
		<? } ?>
		form1.LV_NAME.value = "";
		form1.ORG_NAME_1.value = "";
		form1.ORG_NAME_2.value = "";
		<? if($SESS_ORG_SETLEVEL== 3 || $SESS_ORG_SETLEVEL== 4 || $SESS_ORG_SETLEVEL==5) { ?>
			form1.ORG_NAME_3.value = "";		  form1.ORG_NAME_4.value = "";			form1.ORG_NAME_5.value = "";
		<? } ?>
		form1.CT_NAME_POS.value = "";
		form1.PV_NAME_POS.value = "";
		form1.AP_NAME_POS.value = "";
		form1.ORG_TYPE_NAME.value = "";
		<? if($PER_ID && $ES_CODE && $ES_CODE != "02" && ($UPD || $VIEW)){ ?>form1.ORG_NAME_WORK.value = "";<? } ?>
		form1.submit();
	} //end function
	
	function check_require_field(){
		if(form1.MAIN_DEPARTMENT_ID.value.trim()==""){
			alert('<?=$DEPARTMENT_ALERT?>');
			form1.btn_main_department.focus();
			return false;
		} // end if
		if(form1.PN_CODE.value.trim()==""){
			alert("กรุณาเลือกคำนำหน้าชื่อ");
			form1.PN_CODE.focus();
			return false;
		} // end if

		<? if ($CARD_NO_FILL=="Y") { ?>	
		if(form1.PER_CARDNO.value.trim()==""){		// สำหรับกรมอื่นที่ไม่ใช่ bkk / iscs ต้องระบุ
			alert("กรุณาใส่เลขประจำตัวประชาชน");
			form1.PER_CARDNO.focus();
			return false;
		} // end if
		<? } ?>

		/*if(form1.PER_CARDNO.value.trim()!=""){
			checkDupCARDNO('ADD'); 
			return false;
		}*/

		if(form1.PER_BIRTHDATE.value.trim()==""){
			alert("กรุณาระบุ วัน/เดือน/ปีเกิด");
			form1.PER_BIRTHDATE.focus();
			return false;
		} // end if
		
		if(form1.PER_NAME.value.trim()==""){
			alert("กรุณาใส่ชื่อ");
			form1.PER_NAME.focus();
			return false;
		} // end if

		if(form1.PER_SURNAME.value.trim()==""){
			alert("กรุณาใส่นามสกุล");
			form1.PER_SURNAME.focus();
			return false;
		} // end if

		if(form1.OT_CODE.value.trim()==""){
			alert("กรุณาเลือกประเภทบุคลากร");
			form1.btn_officer_type.focus();
			return false;
		} // end if

		if(form1.PER_BIRTHDATE.value.trim()!=""){
			var BIRTHDATE = form1.PER_BIRTHDATE.value.trim();
			var arrBirthdate = BIRTHDATE.split("/");
			var now = new Date();
			var nowDate = now.getDate();
			var nowMonth = now.getMonth();
			var nowYear = now.getFullYear();
			var approxAge = nowYear - (arrBirthdate[2] - 543);
//			alert(approxAge);

			if(approxAge < 18){ 
				alert("ใส่วันเดือนปีเกิด อายุไม่ถึง 18 ปีบริบูรณ์");
				return false;
			}else if(approxAge == 18){
				if(nowMonth < 9) nowMonth = "0" + (nowMonth + 1);
				else if(nowMonth < 12) nowMonth += 1;

//				alert(parseInt((nowMonth + "" + nowDate), 10) + " :: " + parseInt((arrBirthdate[1] + "" + arrBirthdate[0]), 10));
				if(parseInt((nowMonth + "" + nowDate), 10) < parseInt((arrBirthdate[1] + "" + arrBirthdate[0]), 10)){ 
					alert("ใส่วันเดือนปีเกิด อายุไม่ถึง 18 ปีบริบูรณ์");
					return false;
				} // end if
			} // end if
		} // end if
		
		if(form1.MR_CODE.value.trim()==""){
			alert("กรุณาเลือกสถานภาพสมรส");
			form1.MR_CODE.focus();
			return false;
		} // end if

		if(form1.PER_STARTDATE.value.trim()==""){
			alert("กรุณาเลือกวันที่เข้ารับราชการ");
			form1.PER_STARTDATE.focus();
			return false;
		} // end if

		if(form1.PER_TYPE.value==1){
			if(form1.PER_OCCUPYDATE.value.trim()==""){
				alert("กรุณาเลือกวันที่เข้าส่วนราชการ");
				form1.PER_OCCUPYDATE.focus();
				return false;
			} // end if
		} // end if

		if(form1.PER_TYPE.value==1 || form1.PER_TYPE.value==3){
			if(form1.LEVEL_NO.value.trim()=="" || form1.LEVEL_NO.value==0){
				alert("กรุณาเลือกระดับตำแหน่ง");
				form1.LEVEL_NO.focus();
				return false;
			} // end if
		} // end if

		if(form1.MOV_CODE.value.trim()==""){
			alert("กรุณาเลือกประเภทการเคลื่อนไหว");
			form1.btn_movment.focus();
			return false;
		} // end if

		//0=รอบรรจุ,1=ปกติ,2=พ้นส่วนราชการ
		if(form1.PER_STATUS[0].selected==true || form1.PER_STATUS[1].selected==true){
			if(form1.POS_ID.value.trim()==""){
				alert("กรุณาเลือกเลขที่ตำแหน่ง");
				form1.btn_position.focus();
			return false;
			}
//			alert("approxAge:"+approxAge);
			if(approxAge > age_limit){ 
				var stat = "";
				if (form1.PER_STATUS[0].selected) stat = "รอบรรจุ";
				else stat = "ปกติ";
				alert("สถานะ "+stat+" อายุต้องไม่เกิน "+age_limit+" ปี (ป้อนวันเกิดอายุ "+approxAge+" ปี)");
				return false;
			}
		}
		if(form1.PER_STATUS[2].selected==true){
			if(form1.PER_POSDATE.value.trim()==""){
				alert("กรุณาเลือกวันที่<?=$RETIRE_TITLE?>");
				form1.PER_POSDATE.focus();
				return false;
			}
		}

		if(form1.PER_SALARY.value.trim()=="" && (form1.PER_STATUS[0].selected==true || form1.PER_STATUS[1].selected==true)){
			alert("กรุณาเลือกอัตราเงินเดือน");
			form1.PER_SALARY.focus();
			return false;
		} // end if

		form1.command.value='ADD';
		form1.submit();
		return true;
	} //end function

	function check_require_field_upd(){
//		alert("check_require_field_upd");
		if(form1.MAIN_DEPARTMENT_ID.value.trim()==""){
			alert('<?=$DEPARTMENT_ALERT?>');
			form1.btn_main_department.focus();
			return false;
		} // end if
		
		if(form1.PN_CODE.value.trim()==""){
			alert("กรุณาเลือกคำนำหน้าชื่อ");
			form1.PN_CODE.focus();
			return false;
		} // end if

		if(form1.PER_NAME.value.trim()==""){
			alert("กรุณาใส่ชื่อ");
			form1.PER_NAME.focus();
			return false;
		} // end if

		if(form1.PER_SURNAME.value.trim()==""){
			alert("กรุณาใส่นามสกุล");
			form1.PER_SURNAME.focus();
			return false;
		} // end if

		if(form1.OT_CODE.value.trim()==""){
			alert("กรุณาเลือกประเภทบุคลากร");
			form1.btn_officer_type.focus();
			return false;
		} // end if

<? if ($CARD_NO_FILL=="Y") { ?>	
		if(form1.PER_CARDNO.value.trim()==""){		// สำหรับกรมอื่นที่ไม่ใช่ bkk / iscs ต้องระบุ
			alert("กรุณาใส่เลขประจำตัวประชาชน");
			form1.PER_CARDNO.focus();
			return false;
		} // end if
		<? } ?>

		/*if(form1.PER_CARDNO.value.trim()!=""){
			checkDupCARDNO('UPDATE'); 
			return false;
		}*/

		if(form1.PER_BIRTHDATE.value.trim()!=""){
			var BIRTHDATE = form1.PER_BIRTHDATE.value.trim();
			var arrBirthdate = BIRTHDATE.split("/");
			var now = new Date();
			var nowDate = now.getDate();
			var nowMonth = now.getMonth();
			var nowYear = now.getFullYear();
			var approxAge = nowYear - (arrBirthdate[2] - 543);
//			alert(approxAge);

			if(approxAge < 18){ 
				alert("ใส่วันเดือนปีเกิด อายุไม่ถึง 18 ปีบริบูรณ์");
				return false;
			}else if(approxAge == 18){
				if(nowMonth < 9) nowMonth = "0" + (nowMonth + 1);
				else if(nowMonth < 12) nowMonth += 1;

//				alert(parseInt((nowMonth + "" + nowDate), 10) + " :: " + parseInt((arrBirthdate[1] + "" + arrBirthdate[0]), 10));
				if(parseInt((nowMonth + "" + nowDate), 10) < parseInt((arrBirthdate[1] + "" + arrBirthdate[0]), 10)){ 
					alert("ใส่วันเดือนปีเกิด อายุไม่ถึง 18 ปีบริบูรณ์");
					return false;
				} // end if
			} // end if
		} // end if
		
		if(form1.MR_CODE.value.trim()==""){
			alert("กรุณาเลือกสถานภาพสมรส");
			form1.MR_CODE.focus();
			return false;
		} // end if

		if(form1.PER_STARTDATE.value.trim()==""){
			alert("กรุณาเลือกวันที่เข้ารับราชการ");
			form1.PER_STARTDATE.focus();
			return false;
		} // end if

		if(form1.PER_TYPE.value==1){
			if(form1.PER_OCCUPYDATE.value.trim()==""){
				alert("กรุณาเลือกวันที่เข้าส่วนราชการ");
				form1.PER_OCCUPYDATE.focus();
				return false;
			} // end if
		} // end if

		if(form1.PER_TYPE.value==1 || form1.PER_TYPE.value==3){
			if(form1.LEVEL_NO.value.trim()=="" || form1.LEVEL_NO.value==0){
				alert("กรุณาเลือกระดับตำแหน่ง");
				form1.LEVEL_NO.focus();
				return false;
			} // end if
		} // end if

		if(form1.MOV_CODE.value.trim()==""){
			alert("กรุณาเลือกประเภทการเคลื่อนไหว");
			form1.btn_movment.focus();
			return false;
		} // end if

		//0=รอบรรจุ,1=ปกติ,2=พ้นส่วนราชการ
		if(form1.PER_STATUS[0].selected==true || form1.PER_STATUS[1].selected==true){
			if(form1.POS_ID.value.trim()==""){
				alert("กรุณาเลือกเลขที่ตำแหน่ง");
				form1.btn_position.focus();
			return false;
			}
//			alert("approxAge:"+approxAge);
			if(approxAge > age_limit){ 
				var stat = "";
				if (form1.PER_STATUS[0].selected) stat = "รอบรรจุ";
				else stat = "ปกติ";
				alert("สถานะ "+stat+" อายุต้องไม่เกิน "+age_limit+" ปี (ป้อนวันเกิดอายุ "+approxAge+" ปี)");
				return false;
			}
		}
		if(form1.PER_STATUS[2].selected==true){
			if(form1.PER_POSDATE.value.trim()==""){
				alert("กรุณาเลือกวันที่<?=$RETIRE_TITLE?>");
				form1.PER_POSDATE.focus();
				return false;
			}
		}

		if(form1.PER_SALARY.value.trim()=="" && (form1.PER_STATUS[0].selected==true || form1.PER_STATUS[1].selected==true)){
			alert("กรุณาเลือกอัตราเงินเดือน");
			form1.PER_SALARY.focus();
			return false;
		} // end if

	    form1.command.value='UPDATE';
		return true;
	}
	
	function show_hide(val) {
		var sec = document.getElementById("posdate_sec");
//		alert("1..sec.style/display="+sec.style.display+", val="+val);
		if (val == 2) { 	// out
			sec.style.display='block';
//			sec.style.display='run-in';
//			sec.style.display='inline-table';
		} else {
			sec.style.display='none';
			form1.PER_POSDATE.value = "";
		}
//		alert("2..sec.style/display="+sec.style.display+", val="+val);
		//sec.style.display=sec.style.display=='none'?'block':'none';
	} 

	function change_prename(PN_CODE) {
//		alert("PN_CODE="+PN_CODE);
		var objSelect = document.getElementsByName("PN_CODE");
		var PN_NAME = objSelect[0].options[objSelect[0].selectedIndex].text;
		if(PN_NAME == "นาย") form1.PER_GENDER[0].checked = true;
		else if(PN_NAME == "นาง" || PN_NAME.trim() == "นางสาว") form1.PER_GENDER[1].checked = true;
		
		var objENGSelect = document.getElementById('H_ENG_NAME'+PN_CODE);
		//___alert(objENGSelect.value+ '-- '+objENGSelect .value);
		if(objENGSelect && objENGSelect.value){	
			form1.PN_ENG_NAME.value=objENGSelect .value;	
		}else{
			form1.PN_ENG_NAME.value="";		//เคลียร์ค่าเดิมก่อนหน้านั้น
		}
	}  
	
	function unCheck_PERMEM(){
		if(form1.PER_UNION5.checked==true){			//เป็นสมาชิกสหภาพข้าราชการประเภทตำแหน่งผู้บริหาร
			form1.PER_UNION.checked=false;
			form1.PER_UNION2.checked=false;
			form1.PER_UNION3.checked=false;
			form1.PER_UNION4.checked=false;
			
			form1.PER_UNION.disabled=true;
			form1.PER_UNION2.disabled=true;
			form1.PER_UNION3.disabled=true;
			form1.PER_UNION4.disabled=true;
		}else{
			form1.PER_UNION.disabled=false;
			form1.PER_UNION2.disabled=false;
			form1.PER_UNION3.disabled=false;
			form1.PER_UNION4.disabled=false;
		}
	}
	
	function checkDupCARDNO(command){
		if(form1.PER_CARDNO.value){
			if(form1.PER_CARDNO.value.length<13){
				alert("กรุณาใส่เลขประจำตัวประชาชนให้ครบ 13 หลัก");
				form1.PER_CARDNO.focus();
				//return false;
			}
			document.all.PROCESS_IFRAME.src = "find_personal_cardno.html?PER_CARDNO=" + form1.PER_CARDNO.value + "&PER_CARDNO_OLD="+ form1.PER_CARDNO_OLD.value+"&command="+command; 
		} 
	}
//-----------------------------------------------------------------------------------------

	function returnFrom(src, returnValue){
//		alert("returnform....src="+src+"("+returnValue+")");
		if  (src.indexOf("search_org") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				if (arrValue[7]=="search_ministry") {
					form0.search_ministry_id.value = arrValue[0];
					form0.search_ministry_name.value = arrValue[1];
					form0.search_department_id.value = "";
					form0.search_department_name.value = "";
					form0.search_org_id.value = "";
					form0.search_org_name.value = "";
					form0.search_org_id_1.value = "";
					form0.search_org_name_1.value = ""; 
				} else if (arrValue[7]=="search_department_ass") {
//					alert("search_department_ass="+returnValue);
					form1.ASS_DEPARTMENT_ID.value = arrValue[0];
					form1.ASS_DEPARTMENT_NAME.value = arrValue[1];
					form1.ASS_ORG_ID.value = "";
					form1.ASS_ORG_NAME.value = "";
					form1.ASS_ORG_ID_1.value = "";
					form1.ASS_ORG_NAME_1.value = ""; 
					form1.ASS_ORG_ID_2.value = "";
					form1.ASS_ORG_NAME_2.value = ""; 
					form1.ASS_ORG_ID_3.value = "";
					form1.ASS_ORG_NAME_3.value = ""; 
					form1.ASS_ORG_ID_4.value = "";
					form1.ASS_ORG_NAME_4.value = ""; 
					form1.ASS_ORG_ID_5.value = "";
					form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_org_ass") {
//					alert("search_org_ass="+returnValue);
					form1.ASS_ORG_ID.value = arrValue[0];
					form1.ASS_ORG_NAME.value = arrValue[1];
					form1.ASS_ORG_ID_1.value = "";
					form1.ASS_ORG_NAME_1.value = ""; 
					form1.ASS_ORG_ID_2.value = "";
					form1.ASS_ORG_NAME_2.value = ""; 
					form1.ASS_ORG_ID_3.value = "";
					form1.ASS_ORG_NAME_3.value = ""; 
					form1.ASS_ORG_ID_4.value = "";
					form1.ASS_ORG_NAME_4.value = ""; 
					form1.ASS_ORG_ID_5.value = "";
					form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_department") {
					form0.search_department_id.value = arrValue[0];
					form0.search_department_name.value = arrValue[1];
					form0.search_org_id.value = "";
					form0.search_org_name.value = "";
					form0.search_org_id_1.value = "";
					form0.search_org_name_1.value = ""; 
				} else if (arrValue[7]=="search_org_0") {
					form0.search_org_id.value = arrValue[0];
					form0.search_org_name.value = arrValue[1];
					form0.search_org_id_1.value = "";
					form0.search_org_name_1.value = ""; 
				} else if (arrValue[7]=="search_org1") {
					form0.search_org_id_1.value = arrValue[0];
					form0.search_org_name_1.value = arrValue[1];
				} else if (arrValue[7]=="search_main_ministry") {
					form1.MAIN_MINISTRY_ID.value = arrValue[0];
					form1.MAIN_MINISTRY_NAME.value = arrValue[1];
					form1.MAIN_DEPARTMENT_ID.value = "";
					form1.MAIN_DEPARTMENT_NAME.value = "";
				} else if (arrValue[7]=="search_main_department") {
					form1.MAIN_DEPARTMENT_ID.value = arrValue[0]; 
					form1.MAIN_DEPARTMENT_NAME.value = arrValue[1];
				} else if (arrValue[7]=="search_org_1") {
					form1.ASS_ORG_ID_1.value = arrValue[0];
					form1.ASS_ORG_NAME_1.value = arrValue[1];
					form1.ASS_ORG_ID_2.value = "";
					form1.ASS_ORG_NAME_2.value = ""; 
					if(form1.ASS_ORG_ID_3)		form1.ASS_ORG_ID_3.value = "";
					if(form1.ASS_ORG_NAME_3)		form1.ASS_ORG_NAME_3.value = ""; 
					if(form1.ASS_ORG_ID_4)		form1.ASS_ORG_ID_4.value = "";
					if(form1.ASS_ORG_NAME_4)		form1.ASS_ORG_NAME_4.value = ""; 
					if(form1.ASS_ORG_ID_5)		form1.ASS_ORG_ID_5.value = "";
					if(form1.ASS_ORG_NAME_5)		form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_org_2") {
					form1.ASS_ORG_ID_2.value = arrValue[0];
					form1.ASS_ORG_NAME_2.value = arrValue[1];
					if(form1.ASS_ORG_ID_3)		form1.ASS_ORG_ID_3.value = "";
					if(form1.ASS_ORG_NAME_3)	form1.ASS_ORG_NAME_3.value = ""; 
					if(form1.ASS_ORG_ID_4)		form1.ASS_ORG_ID_4.value = "";
					if(form1.ASS_ORG_NAME_4)		form1.ASS_ORG_NAME_4.value = ""; 
					if(form1.ASS_ORG_ID_5)		form1.ASS_ORG_ID_5.value = "";
					if(form1.ASS_ORG_NAME_5)		form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_org_3") {
					form1.ASS_ORG_ID_3.value = arrValue[0];
					form1.ASS_ORG_NAME_3.value = arrValue[1];
					if(form1.ASS_ORG_ID_4)		form1.ASS_ORG_ID_4.value = "";
					if(form1.ASS_ORG_NAME_4)		form1.ASS_ORG_NAME_4.value = ""; 
					if(form1.ASS_ORG_ID_5)		form1.ASS_ORG_ID_5.value = "";
					if(form1.ASS_ORG_NAME_5)		form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_org_4") {
					form1.ASS_ORG_ID_4.value = arrValue[0];
					form1.ASS_ORG_NAME_4.value = arrValue[1];
					if(form1.ASS_ORG_ID_5)		form1.ASS_ORG_ID_5.value = "";
					if(form1.ASS_ORG_NAME_5)	form1.ASS_ORG_NAME_5.value = ""; 
				} else if (arrValue[7]=="search_org_5") {
					form1.ASS_ORG_ID_5.value = arrValue[0];
					form1.ASS_ORG_NAME_5.value = arrValue[1];
				} else if (arrValue[7]=="search_org") {
					form1.MAIN_MINISTRY_ID.value = arrValue[0];
					form1.MAIN_MINISTRY_NAME.value = arrValue[1];
					form1.MAIN_DEPARTMENT_ID.value = "";
					form1.MAIN_DEPARTMENT_NAME.value = "";
				}
			} // end if
		} else if  (src.indexOf("personal_master_desc") > -1) {
			if(returnValue){
				document.form0.submit();
			} // end if
		} else if  (src.indexOf("search_mgt") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				form0.search_pm_code.value = arrValue[0];
				form0.search_pm_name.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_perline") > -1 || src.indexOf("search_pos_name") > -1 || src.indexOf("search_empser_pos_name") > -1 || src.indexOf("search_temp_pos_name") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				form0.search_pl_code.value = arrValue[0];
				form0.search_pl_name.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_offtype") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				form1.OT_CODE.value = arrValue[0];
				form1.OT_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_province") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				form1.PV_CODE_PER.value = arrValue[0];
				form1.PV_NAME_PER.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_emp_status") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				form1.ES_CODE.value = arrValue[0];
				form1.ES_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_movment") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				form1.MOV_CODE.value = arrValue[0];
				form1.MOV_NAME.value = arrValue[1];
			} // end if
		} else if  (src.indexOf("search_layer") > -1) {
			PER_TYPE=form1.PER_TYPE.value;
			var LEVEL_NO = form1.LEVEL_NO.value.trim();
			var POS_ID = form1.POS_ID.value.trim();
		
			if(PER_TYPE==2){
				if(returnValue){
					arrValue = returnValue.split("<::>");
					form1.PER_SALARY.value = arrValue[0];
				} // end if 
			}else{
				if(LEVEL_NO != ""){
					if(returnValue){
						arrValue = returnValue.split("<::>");
						form1.PER_SALARY.value = arrValue[0];
					} // end if
//				}else{
//					alert("กรุณาเลือกระดับตำแหน่งก่อน");
				} // end if
			} // end if
		} else if  (src.indexOf("search_pos") > -1) {
			if(returnValue){
				arrValue = returnValue.split("<::>");
				if(search_sitename=="search_position")
					send_by = arrValue[20]; 
				else if(search_sitename=="search_position_vacant")
					send_by = arrValue[4]; 
				else if(search_sitename=="search_pos_emp" || search_sitename=="search_pos_emp_vacant")
					send_by = arrValue[7]; 
				else if(search_sitename=="search_pos_empser" || search_sitename=="search_pos_empser_vacant")
					send_by = arrValue[6]; 
				else if(search_sitename=="search_pos_temp" || search_sitename=="search_pos_temp_vacant")
					send_by = arrValue[6]; 
				if (send_by=="search_position") {
					form1.POS_ID.value = arrValue[0];
					form1.POS_NO.value = arrValue[1];
					form1.PL_NAME.value = arrValue[2];
					<? if ($POSITION_NO_CHAR=="Y") { ?>	
						if (form1.PER_TYPE.value == 1) {
							if(search_sitename=="search_position"){
								form1.POS_NO_NAME.value = arrValue[6];
							}else{
								form1.POS_NO_NAME.value = arrValue[3];
							}		
						} else if (form1.PER_TYPE.value == 2) { 
							form1.POS_NO_NAME.value = arrValue[6];
						} else if (form1.PER_TYPE.value == 3) {
							form1.POS_NO_NAME.value = arrValue[4];
							form1.LEVEL_NO.value = arrValue[5];
						} else if (form1.PER_TYPE.value == 4) {
							form1.POS_NO_NAME.value = arrValue[5];
						}
		//				alert("POS_NO:"+form1.POS_NO.value+" , PER_TYPE:"+form1.PER_TYPE.value+" , POS_NO_NAME:"+form1.POS_NO_NAME.value);
					<? } ?>
					if(arrValue[0]) {
		//				document.all.PROCESS_IFRAME.src = "find_personal_position.html?POS_ID=" + arrValue[0] + "&PER_TYPE=" + per_type + "&LEVEL_NO=" +  form1.LEVEL_NO.value;
						form1.sendPOS.value = arrValue[0];
					}
					form1.form1command.value = "personal";
					form1.submit(); 
				} else if (arrValue[20]=="search_pay") {
					if(returnValue){
						arrValue = returnValue.split("<::>");
						form1.PAY_ID.value = arrValue[0];
						form1.PAY_NO.value = arrValue[1];
					} // end if	
				}
			}
		}
	} // end if
	
	<? if($command=="ADD" || $command=="UPDATE" || $command=="DELETE"){ ?>parent.refresh_opener(true);<? } ?>

	function confirm_delete(per_id , per_name){
		if(confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่ [ " + per_name + " ] ?")){
			form11.command.value = "DELETE";
			form11.PER_ID.value = per_id;
			form11.submit();
		} // end if
	}

	function call_menu_desc (file, per_id, menulv) {
//		alert("file="+file+", per_id="+per_id+", menulv="+menulv);
		if (menulv) {
			var arr_menu_lv = menulv.split(",");
			menu_lv0 = arr_menu_lv[0];
			menu_lv1 = arr_menu_lv[1];
			menu_lv2 = arr_menu_lv[2];
			menu_lv3 = arr_menu_lv[3];
			document.all.PER_DESC_IFRAME.src = file + "?PER_ID=" + per_id + "&MENU_ID_LV0=" + menu_lv0 + "&MENU_ID_LV1=" + menu_lv1+ "&MENU_ID_LV2=" + menu_lv2 + "&MENU_ID_LV3=" + menu_lv3 + "&HIDE_HEADER=1<?=($MAIN_VIEW?"&MAIN_VIEW=1":"")?>&getdate=<?=date('YmdHis')?>";
		} else {
			document.all.PER_DESC_IFRAME.src = file + "?PER_ID=" + per_id + "&MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>&HIDE_HEADER=1<?=($MAIN_VIEW?"&MAIN_VIEW=1":"")?>&getdate=<?=date('YmdHis')?>";
		}
		//parent.PER_DESC_IFRAME.location.href = "";
	}


</script>
<?  //เช็คปุ่มที่ได้ค่าออกมา ว่าเป็นปุ่มเพิ่มหรือแก้ไข 
	if($PAGE_AUTH["edit"]=="Y" && $UPD) 
	$Submit = "Submit_edit";
	else if(!$VIEW && $PAGE_AUTH["add"]=="Y") 
	$Submit = "Submit_add";    
?>

<span id="defaultTheme"></span>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
<? if (!$HEAD_HIDE) { ?>
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?
		//$OPTIONAL_TITLE="".(($HIDE_HEADER)?"ข้อมูลความสามารถพิเศษ":"") ;
		if ($UPD) $OPTIONAL_TITLE.=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE.=" &gt; ดูข้อมูล";
		include("current_location.html");
?>		</td>
	</tr>
<? } ?>
	<tr>
    	<td align="left" valign="top"><table width="95%" align="center" cellpadding="0" cellspacing="0">
  			<tr>
	  			<td><table width="15%" cellpadding="0" cellspacing="0" class="input_table" style="border-style:solid;" border="1">
		  			<tr><? //echo $SEARCHHIS."//".$PAGE_AUTH["add"]."/".$PAGE_AUTH["edit"]."/".$PAGE_AUTH["del"]; ?>
		  					<? if(!$SEARCHHIS && ($PAGE_AUTH["add"]=="Y" || (($PAGE_AUTH["edit"]=="Y" || $PAGE_AUTH["del"]=="Y") && $UPD))){ ?><td id="CELL_TOPIC_2" height="22" align="center" class="<?=($show_topic==2)?"table_body_3":"table_body"?>"><span style="cursor:hand;" onClick="alert('2'); dum_change_div(2); alert('2.1');"><?=($UPD)?"แก้ไข":$ADDTAB_TITLE?>ข้อมูล</span></td><? } ?>
							<td  id="CELL_TOPIC_1" height="22" align="center" class="<?=($show_topic==1)?"table_body_3":"table_body"?>"><span style="cursor:hand;"  onClick="alert('1'); dum_change_div(1); alert('1.1');"><?=$SEARCH_TITLE?></span></td>
                            <td  id="CELL_TOPIC_3" height="22" align="center" class="<?=($show_topic==3)?"table_body_3":"table_body"?>"><span style="cursor:hand;"  onClick="form0.PER_ID.value=<?=$PER_ID?>; dum_change_div(3);">ข้อมูลรายบุคคล</span></td>
		  			</tr>
	  			</table></td>
			</tr></table>
		<? echo "111"; ?>
		<form name="form0" method="post" action="0_test_for_personal_master1.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="<?=$command; ?>">
		  <input type="hidden" name="PER_ID" value="">
		  <input type="hidden" name="HEAD_HIDE" value="<?=$HEAD_HIDE?>">
		  <? if($_GET['SEARCHHIS']){	?><input type="hidden" name="SEARCHHIS" value="<?=$_GET['SEARCHHIS']; ?>"><? } ?>
			<input type="hidden" name="show_topic" value="<?=$show_topic?>">
<div id="DIV_TOPIC_1" style="display:<?=($show_topic==1)?"block":"none"?>;"> 
<input type="text" name="dum111" value="dum111">
		<input type="button" name="bt_1" value="ทดสอบ per_id=14211" onClick="call_desc_personal(14211);">
<!-------------------------------->
</div> 
		</form>
<!---ADD--->
 <div id="DIV_TOPIC_2" style="display:<?=($show_topic==2)?"block":"none"?>;">
 <form name="form1" method="post" action="0_test_for_personal_master1.html" enctype="multipart/form-data">
		<input type="hidden" name="current_page" value="<?=$current_page?>">
		<input type="hidden" name="total_page" value="<?=$total_page?>">
		<input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		<input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		<input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		<input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
		<input type="hidden" name="command" value="<?=$command; ?>">
		<input type="text" name="PER_ID" value="<?=$PER_ID?>">
		<input type="hidden" name="c_duplicate" value="<?=$c_duplicate?>">
		<input type="hidden" name="VIEW" value="<?=$VIEW?>"><br>
		<input type="hidden" name="UPD" value="<?=$UPD?>">
		<input type="hidden" name="show_topic" value="<?=$show_topic?>">
		<input type="hidden" name="form1command" value="">
		<input type="hidden" name="sendPOS" value="">
		<!--//--- จากฟอร์มค้นหา personal_master.html ---//-->
		<input type="hidden"  name="search_org_name" value="<?=$search_org_name; ?>">
		<input type="hidden"  name="search_org_id" value="<?=$search_org_id; ?>">
		<input type="hidden"  name="search_org_name_1" value="<?=$search_org_name_1; ?>">
		<input type="hidden"  name="search_org_id_1" value="<?=$search_org_id_1; ?>">
		<input type="hidden"  name="search_name" value="<?=$search_name; ?>">
		<input type="hidden"  name="search_surname" value="<?=$search_surname; ?>">
		<input type="hidden"  name="search_cardno" value="<?=$search_cardno; ?>">
		<input type="hidden"  name="search_offno" value="<?=$search_offno; ?>">
		<input type="hidden"  name="search_pos_no_name" value="<?=$search_pos_no_name; ?>">
		<input type="hidden"  name="search_pos_no" value="<?=$search_pos_no; ?>">
		<input type="hidden"  name="search_pay_no" value="<?=$search_pay_no; ?>">
		<input type="hidden"  name="search_pl_name" value="<?=$search_pl_name; ?>">
		<input type="hidden"  name="search_pl_code" value="<?=$search_pl_code; ?>">
		<input type="hidden"  name="search_pm_name" value="<?=$search_pm_name; ?>">
		<input type="hidden"  name="search_pm_code" value="<?=$search_pm_code; ?>">
		<input type="hidden"  name="search_per_status" value="<?=$search_per_status; ?>">
		<input type="hidden"  name="search_per_type" value="<?=$search_per_type; ?>">
		<input type="hidden"  name="search_data" value="<?=$search_data; ?>"> 
		<input type="hidden"  name="SEARCHHIS" value="<?=$SEARCHHIS; ?>">
<input type="text" name="dum222" value="dum222">
</form>
 </div>
<!--------------->
<div id="DIV_TOPIC_3" style="display:<?=($show_topic==3)?"block":"none"?>;">
<form name="form11" method="post" action="0_test_for_personal_master1.html" target="frame_personal_master_desc" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="PER_ID" value="<?=$PER_ID?>">
			<input type="hidden" name="show_topic" value="<?=$show_topic?>">
<input type="text" name="dum333" value="dum333">
</form>
</div>
    </tr>
</table>
</body>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
<script type="text/javascript">
setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
</script>
</html>
