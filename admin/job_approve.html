<? 
	include("../php_scripts/connect_database.php");
	include("../php_scripts/calendar_data.php");
	include("php_scripts/job_approve.php"); 
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/>
</head>
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script> 
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script language="JavaScript">
<? if($command=="SAVE" && ($PAGE_ID > count($ARR_EVALUATE_QUESTION))){ ?>parent.refresh_opener(true);<? } ?>

	function verify_data(command){		
		var ISPASSED = "";
		var ISPASSED_TXT = "";
		var objRadio = document.getElementsByName("ISPASSED");
//		alert(objRadio.length);
		for(i=0; i<objRadio.length; i++){
			if(objRadio[i].checked==true){
				ISPASSED = objRadio[i].value;
				break;
			} 
		} 
//		alert(ANSWER);

		if( ISPASSED=="" ){
			alert("กรุณาเลือกผลการตรวจสอบ");
			return false;
		} 

		if( document.form1.REASON.value.trim()=="" ){
			if(ISPASSED == "Y") ISPASSED_TXT = "ที่อนุมัติให้ผ่านการทดสอบ";
			if(ISPASSED == "N") ISPASSED_TXT = "ที่ไม่อนุมัติให้ผ่านการทดสอบ";
			alert("กรุณาระบุเหตุผล" + ISPASSED_TXT);
			return false;
		} 

		document.form1.command.value = command;
		return true;
	}

	function call_export_file() {
		var currDate = new Date();
		var rptDate = currDate.getFullYear().toString() + currDate.getMonth().toString() + currDate.getDate().toString(); 
			   rptDate += currDate.getHours().toString() + currDate.getMinutes().toString() + currDate.getSeconds().toString();
		var report_title = "ผลการประเมินค่างาน";
		document.form1.target = "_blank";
		document.form1.action = "report/rpt_job_approve_xls.php?report_title=" + report_title + "&show_detail=1&UTC" + rptDate;
//		alert(document.form1.action);
		document.form1.submit();
		document.form1.target = "_self";
		document.form1.action = "job_approve.html";
	}	

	function view_job_evaluation (pos_id, job_eva_id) {
		parameter = "&POS_ID=" + pos_id + "&JOB_EVA_ID=" + job_eva_id + "&VIEW=1";
	    call_openDialog("job_evaluation.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,1000,600,"ประเมินค่างาน");		
	}

	function returnFrom(src, returnValue){
//		alert("src="+src+"("+returnValue+")");
		 if  (src.indexOf("job_evaluation") > -1) {
			if(returnValue){
				document.form1.submit();
			} // end if
		} 		
//		$( "#d_frame" )[0].src="";
//		alert("returnValue="+tt.value);
		tt.value = returnValue;
	} // end if
	
</script>
<span id="defaultTheme"></span>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="job_approve.html" enctype="multipart/form-data">
          <input type="hidden" name="current_page" value="<?=$current_page?>">
          <input type="hidden" name="total_page" value="<?=$total_page?>">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="POS_ID" value="<?=$POS_ID?>">
          <input type="hidden" name="JOB_EVA_ID" value="<?=$JOB_EVA_ID?>">
          <input type="hidden" name="APPROVE_NO" value="<?=$APPROVE_NO?>">
          <input type="hidden" name="HISTORY_ID" value="<?=$HISTORY_ID?>">
  &nbsp;
  <table width="95%" align="center" cellpadding="0" cellspacing="0" class="input_table">
    <tr>
      <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
        <tr>
          <td height="25" class="table_head">&nbsp;&nbsp;ผลการประเมินค่างาน&nbsp;&nbsp;</td>
        </tr>
        <tr>
          <td height="25" align="center" class="label_sub_normal">ตำแหน่ง <?=$PL_NAME?> สังกัด <?=$ORG_NAME?></td>
        </tr>
        <tr>
          <td><table width="100%" border="0" cellpadding="0" cellspacing="0" class="label_normal">
            <tr>
              <td height="22" class="table_body_2">&nbsp;&nbsp;ผลการทดสอบ</td>
            </tr>
            <tr>
              <td height="5"></td>
            </tr>
            <tr>
              <td height="22" align="center"><table width="95%" border="0" cellspacing="1" cellpadding="1" class="input_table">
                <tr>
                  <td colspan="2" align="center" class="table_body" height="25" nowrap>ความรู้ (Know-how) </td>
                  <td colspan="2" align="center" class="table_body" nowrap>การแก้ปัญหา (Problem Solving) </td>
                  <td colspan="2" align="center" class="table_body" nowrap>ความรับผิดชอบ (Accountability) </td>
                  </tr>
                <tr>
                  <td width="25%" align="center" class="table_body_2" height="25" nowrap>ความกว้างและลึกของความรู้</td>
                  <td width="8%" align="center" class="table_body_3" nowrap><?=$KH1?></td>
                  <td align="center" class="table_body_2" nowrap>อิสระในความคิด</td>
                  <td width="8%" align="center" class="table_body_3" nowrap><?=$PS1?></td>
                  <td width="25%" align="center" class="table_body_2" nowrap>อิสระในการปฏิบัติงาน</td>
                  <td width="8%" align="center" class="table_body_3" nowrap><?=$ACC1?></td>
                </tr>
                <tr>
                  <td align="center" class="table_body_2" height="25" nowrap>การบริหารจัดการ</td>
                  <td align="center" class="table_body_3" nowrap><?=$KH2?></td>
                  <td align="center" class="table_body_2" nowrap>ความท้าทายในความคิด</td>
                  <td align="center" class="table_body_3" nowrap><?=$PS2?></td>
                  <td align="center" class="table_body_2" nowrap>ขอบเขตผลกระทบของงาน</td>
                  <td align="center" class="table_body_3" nowrap><?=$ACC2?></td>
                </tr>
                <tr>
                  <td align="center" class="table_body_2" height="25" nowrap>การปฏิสัมพันธ์กับผู้อื่น</td>
                  <td align="center" class="table_body_3" nowrap><?=$KH3?></td>
                  <td align="center" class="table_body_2" nowrap>%</td>
                  <td align="center" class="table_body_3" nowrap><?=$PS_SCORE?></td>
                  <td align="center" class="table_body_2" nowrap>ชนิดของผลกระทบ</td>
                  <td align="center" class="table_body_3" nowrap><?=$ACC3?></td>
                </tr>
                <tr>
                  <td align="center" class="table_body" height="25" nowrap>คะแนน</td>
                  <td align="center" class="table_body_3" nowrap><?=$KH_SCORE?></td>
                  <td align="center" class="table_body" nowrap>คะแนน</td>
                  <td align="center" class="table_body_3" nowrap><?=$PS_KH_SCORE?></td>
                  <td align="center" class="table_body" nowrap>คะแนน</td>
                  <td align="center" class="table_body_3" nowrap><?=$ACC_SCORE?></td>
                </tr>
                <tr>
                  <td align="center" class="table_body" height="25" nowrap>ความสอดคล้องของการวิเคราะห์</td>
                  <td align="center" class="table_body_over" nowrap><?=(($KH_CONSISTENCY=="Y")?"ผ่าน":"ไม่ผ่าน")?></td>
                  <td align="center" class="table_body" nowrap>ความสอดคล้องของการวิเคราะห์</td>
                  <td align="center" class="table_body_over" nowrap><?=(($PS_CONSISTENCY=="Y")?"ผ่าน":"ไม่ผ่าน")?></td>
                  <td align="center" class="table_body" nowrap>ความสอดคล้องของการวิเคราะห์</td>
                  <td align="center" class="table_body_over" nowrap><?=(($ACC_CONSISTENCY=="Y")?"ผ่าน":"ไม่ผ่าน")?></td>
                </tr>
                <tr>
                  <td colspan="4" align="right" class="table_body" height="25" nowrap>คะแนนรวม (CSC Points)&nbsp;:&nbsp;</td>
                  <td colspan="2" align="center" class="table_body_over" nowrap><?=$TOTAL_POINTS?></td>
                  </tr>
                <tr>
                  <td colspan="4" align="right" class="table_body" height="25" nowrap>Profile Check&nbsp;:&nbsp;</td>
                  <td align="center" class="table_body_3" nowrap><?=$PROFILE_CHECK?></td>
                  <td align="center" class="table_body_over" nowrap><?=(($PC_CONSISTENCY=="Y")?"ผ่าน":"ไม่ผ่าน")?></td>
                </tr>
                <tr>
                  <td colspan="4" align="right" class="table_body" height="25" nowrap>ผลการประเมิน&nbsp;:&nbsp;</td>
                  <td colspan="2" align="center" class="table_body_over" nowrap><?=(($EVALUATE_RESULT=="Y")?"ผ่าน":"ไม่ผ่าน")?></td>
                </tr>
                <tr>
                  <td align="center" class="table_body" height="25" nowrap>ประเภท/ระดับตำแหน่ง (ใหม่) </td>
                  <td colspan="5" align="center" class="table_body_3" nowrap><?=$EVALUATE_LEVEL_NAME?></td>
                  </tr>
              </table></td>
              </tr>
            <tr>
              <td height="10"></td>
              </tr>
            <tr>
              <td height="22" align="center"><table width="95%" border="0" cellpadding="1" cellspacing="1" class="input_table">
                <tr>
                  <td width="33%" height="22" class="table_body_2">&nbsp;&nbsp;ผู้ทำแบบทดสอบ</td>
                  <td class="table_body_3"><?=$TESTER_NAME?></td>
                  </tr>
                <tr>
                  <td height="22" class="table_body_2">&nbsp;&nbsp;วัน - เวลา </td>
                  <td class="table_body_3"><?=$TEST_TIME?></td>
                  </tr>
              </table></td>
              </tr>
            <tr>
              <td height="5"></td>
              </tr>
            <tr>
              <td height="22" class="table_body_2">&nbsp;&nbsp;การตรวจสอบ &nbsp;</td>
              </tr>
            <tr>
              <td height="5"></td>
              </tr>
            <tr>
              <td height="22" align="center"><table width="95%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                <tr>
                  <td width="40%" valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
                    <tr>
                      <td>&nbsp;<input type="radio" name="ISPASSED" value="Y" <?=($ISPASSED=="Y")?"checked":""?>  onClick="document.all.MESSAGE.innerHTML='ที่ผ่านเกณฑ์การประเมิน';"> ผลการประเมินผ่านเกณฑ์การประเมิน</td>
                    </tr>
                    <tr>
                      <td>&nbsp;<input type="radio" name="ISPASSED" value="N" <?=($ISPASSED=="N")?"checked":""?>  onClick="document.all.MESSAGE.innerHTML='ที่ไม่ผ่านเกณฑ์การประเมิน';"> ผลการประเมินไม่ผ่านเกณฑ์การประเมิน</td>
                    </tr>
                  </table></td>
                  <td valign="top"><table width="100%" border="0" cellpadding="1" cellspacing="1" class="input_table">
                    <tr>
                      <td height="22" class="table_body">&nbsp;เหตุผล<span id="MESSAGE"></span></td>
                    </tr>
                    <tr>
                      <td align="center"><textarea name="REASON" rows="3" class="selectbox" style="width:100%"><?=$REASON?></textarea></td>
                    </tr>
                  </table></td>
                </tr>
              </table></td>
            </tr>
          </table></td>
        </tr>
        <tr>
          <td height="5" align="center"><iframe src="javascript:;" id="PROCESS_IFRAME" frameborder="0" height="5" scrolling="no">หาประเภทตำแหน่งใหม่</iframe></td>
        </tr>
        <tr align="center">
          <td height="30">
		  	<? if ($POS_ID) { ?>
			  <input name="button1" type="button" class="button" value="ออกรายงาน Excel" onClick="call_export_file();">
			  <input name="button2" type="button" class="button" value="บทวิเคราะห์งาน" onClick="view_job_evaluation(<?=$POS_ID?>,<?=$JOB_EVA_ID?>);">              
      		  <?if($PAGE_AUTH["edit"]=="Y"){?><input name="Submit22" type="submit" class="button" onClick="if(!verify_data('SAVE')){ return false; }" value="บันทึก"><?}?> 
      		  <input name="Reset1" type="reset" class="button" value="กรอกข้อมูลใหม่"> 
			  <input type="submit" name="Reset2" value="ย้อนกลับ" onClick="window.parent.close(); self.close();" class="button" >
            <?}?>		  </td>
        </tr>
      </table></td>
    </tr>
  </table>
        </form>	
		</td>
	</tr>
</table>
<?
	include("jqModalDialog.html");
?>
</body>
<script type="text/javascript">
setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
</script>
</html>