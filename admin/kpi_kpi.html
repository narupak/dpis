<? 
	include("../php_scripts/connect_database.php");
	include("php_scripts/kpi_kpi.php");
//echo "โปรแกรมฉบับชั่วคราว (beta 5.1.0.2 : 23 ธ.ค. 2558)<br>";
//echo "โปรแกรมฉบับชั่วคราว (beta 5.1.0.3 : 5 ม.ค. 2559)<br>";/*ปรับปรุงให้สามารถแก้ไข ประเด็นการประเมินผลฯ ได้*/
?>
<html>
<head>
<title><?=$webpage_title?> - <?=$MENU_TITLE_LV0?><?if($MENU_ID_LV1){?> - <?=$MENU_TITLE_LV1?><?}?><?if($MENU_ID_LV2){?> - <?=$MENU_TITLE_LV2?><?}?><?if($MENU_ID_LV3){?> - <?=$MENU_TITLE_LV3?><?}?></title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-874">
<link rel="stylesheet" href="<?=$cssfileselected?>" type="text/css">
<link rel="alternate stylesheet" type="text/css" media="all" href="stylesheets/calendar-blue.css" title="winter"/>
</head>
<script type="text/javascript" src="java_scripts/chk_date.js"></script>
<script type="text/javascript" src="java_scripts/calendar.js"></script>
<script type="text/javascript" src="java_scripts/calendar-th.js"></script> 
<script type="text/javascript" src="java_scripts/function_utility.js"></script> 
<script type="text/javascript" src="java_scripts/function_code_param.js"></script> 
<script type="text/javascript">
	function MM_openBrWindow(theURL,winName,features) { //v2.0
	  window.open(theURL,winName,features);
	}
	
	function call_more_editor (fieldname) {
		var getdate = new Date();
		MM_openBrWindow("maximize_editor.html?formname=form1&fieldname="+fieldname+"&gatedate="+getdate,'moreeditor','toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=yes,width=550,height=520')
	}
		
	function call_search_person (type) {	
	    if(type==1){
		 parameter = "&isLock=1&LOCK_MINISTRY_ID=" + form1.MINISTRY_ID.value + "&LOCK_DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value+"&send_by=call_type_1";
			}else {
			 parameter = "&isLock=1&LOCK_MINISTRY_ID=" + form1.MINISTRY_ID.value + "&LOCK_DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value;
			}
		call_openDialog("search_person.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"รายชื่อ<?=$PERSON_TITLE?>");
	
	}

	function call_search_performance_review (type) {
        
            if(type==1){
                parameter = "&PFR_YEAR=<?=$KPI_YEAR?>&MINISTRY_ID=" + form1.MINISTRY_ID.value + "&DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value+"&send_by=call_type_1";
            }else{
                parameter = "&PFR_YEAR=<?=$KPI_YEAR?>&MINISTRY_ID=" + form1.MINISTRY_ID.value + "&DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value;
            }
            call_openDialog("kpi_performance_review_list.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"Performance Review");
		
	}

	function select_kpi(kpi_id, kpi_id_ref){
		form1.KPI_ID.value = kpi_id;
		form1.KPI_ID_REF.value = kpi_id_ref;
		form1.submit();
	}
	
	function add_opened_kpi(opened_kpi_id){
		opened_kpi = form1.LIST_OPENED_KPI.value;
		if(opened_kpi==""){
			opened_kpi = "," + opened_kpi_id + ",";
		}else{
			opened_kpi += (opened_kpi_id + ",");
		}
		form1.LIST_OPENED_KPI.value = opened_kpi;
	//	alert(form1.LIST_OPENED_KPI.value);
	//	form1.KPI_ID.value = opened_kpi_id;
	//	form1.KPI_ID_REF.value = "";
		form1.submit();
	}
	
	function remove_closed_kpi(closed_kpi_id){
		opened_kpi = form1.LIST_OPENED_KPI.value;
		if(opened_kpi==""){
			opened_kpi = "";
		}else{
			search_str = "," + closed_kpi_id + ",";
			pos = opened_kpi.indexOf(search_str);
	//		alert(pos);
			opened_kpi = opened_kpi.substring(0, pos) + opened_kpi.substring((pos + search_str.length - 1), opened_kpi.length);
			if(opened_kpi=="," || opened_kpi==",,") opened_kpi = "";
		}
		form1.LIST_OPENED_KPI.value = opened_kpi;	
	//	alert(form1.LIST_OPENED_KPI.value);
	//	form1.KPI_ID.value = form1.KPI_ID_REF.value;
	//	form1.KPI_ID_REF.value = "";
		form1.submit();
	}

	function call_change_kpi_level () {
		parameter = "&KPI_YEAR=<?=$KPI_YEAR?>&KPI_ID=" + document.form1.KPI_ID.value + "&KPI_ID_REF=" + document.form1.KPI_ID_REF.value + "&MINISTRY_ID=" + form1.MINISTRY_ID.value + "&DEPARTMENT_ID=" + form1.DEPARTMENT_ID.value;
		call_openDialog("kpi_kpi_parent.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"Change KPI Parent");
		
	}

	function call_search_ministry () {	
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		parameter = "&OL_CODE=01&PV_CODE=" + PROVINCE_CODE+"&send_by=call_search_ministry";
		call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"โครงสร้างตามกฎหมาย - <?=$page_title?>");
		
	}

	function call_search_department () {	
		var MINISTRY_ID = <?=(($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3)?"$MINISTRY_ID":"form1.MINISTRY_ID.value")?>;
		var PROVINCE_CODE = "<?=($CTRL_TYPE==2 || $SESS_USERGROUP_LEVEL==2)?"$PROVINCE_CODE":""?>";
		if(MINISTRY_ID != ""){
			parameter = "&OL_CODE=02&ORG_ID_REF=" + MINISTRY_ID + "&PV_CODE=" + PROVINCE_CODE+"&send_by=call_search_department";
			call_openDialog("search_org.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"โครงสร้างตามกฎหมาย - <?=$page_title?>");
			
		}else{
			<? if($CTRL_TYPE==3 || $SESS_USERGROUP_LEVEL==3){ ?>
			alert('<?=$MINISTRY_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$MINISTRY_ALERT?>');
			form1.btn_ministry.focus();
			<? } ?>
		} // end if
	}

	function call_search_org () {	
		var DEPARTMENT_ID = form1.DEPARTMENT_ID.value;
		<? if ($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4) { ?>
				DEPARTMENT_ID = "<?=$DEPARTMENT_ID?>";
		<? } ?>
		if(DEPARTMENT_ID != ""){
			org_search_file ="search_org";
			parameter = "&OL_CODE=03&ORG_ID_REF=" + DEPARTMENT_ID+"&send_by=call_search_org";
			call_openDialog(org_search_file+".html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"โครงสร้างตามกฎหมาย - <?=$page_title?>");
			
		}else{
			<? if($CTRL_TYPE==4 || $SESS_USERGROUP_LEVEL==4){ ?>
			alert('<?=$DEPARTMENT_ALERT?> (กำหนดค่าเริ่มต้นหน่วยงาน)');
			<? }else{ ?>
			alert('<?=$DEPARTMENT_ALERT?>');
			form1.btn_department.focus();
			<? } ?>
		} // end if
	}

	function checkaddyear(f) {
	if(f.NEW_KPI_YEAR.value=="") {
		alert("กรุณาระบุ <?=$YEAR_TITLE?>");
		f.NEW_KPI_YEAR.focus();
		return false;
		} 
		else  	
		 form1.command.value='ADDYEAR'; 					
		return true;
		}

        function checkupdate(f) {
            if(f.KPI_TARGET_LEVEL1.value>9999.99){
                alert('เป้าหมาย 1 ไม่ควรเกิน 9999.99');
                f.KPI_TARGET_LEVEL1.focus();
                return false;
            }else if(f.KPI_TARGET_LEVEL2.value>9999.99){
                alert('เป้าหมาย 2 ไม่ควรเกิน 9999.99');
                f.KPI_TARGET_LEVEL2.focus();
                return false;
            }else if(f.KPI_TARGET_LEVEL3.value>9999.99){
                alert('เป้าหมาย 3 ไม่ควรเกิน 9999.99');
                f.KPI_TARGET_LEVEL3.focus();
                return false;
            }else if(f.KPI_TARGET_LEVEL4.value>9999.99){
                alert('เป้าหมาย 4 ไม่ควรเกิน 9999.99');
                f.KPI_TARGET_LEVEL4.focus();
                return false;
            }else if(f.KPI_TARGET_LEVEL5.value>9999.99){
                alert('เป้าหมาย 5 ไม่ควรเกิน 9999.99');
                f.KPI_TARGET_LEVEL5.focus();
                return false;
            }else{
                if(f.KPI_NAME.value=="") {
                    alert("กรุณาระบุ ตัวชี้วัด");
                    f.KPI_NAME.focus();
                    return false;
                }else if(f.KPI_PER_NAME.value=="") {
                    alert("กรุณาระบุ ผู้กำกับดูแลตัวชี้วัด");
                    f.KPI_PER_NAME.focus();
                    return false;
                }else if(f.PFR_NAME.value=="" && f.PFR_NAME1.value=="" && f.PFR_NAME2.value=="") {
                    alert("กรุณาระบุ ประเด็นการประเมินผลฯ");
                    f.PFR_NAME.focus();
                    f.PFR_NAME1.focus();
                    f.PFR_NAME2.focus();
                    return false;
                }else  						
                    form1.command.value='UPDATE';
                    return true;
                
            }
        }
        
		
	function checkadd(f) {
            if(f.NEW_KPI_TARGET_LEVEL1.value>9999.99){
                alert('เป้าหมาย 1 ไม่ควรเกิน 9999.99');
                f.NEW_KPI_TARGET_LEVEL1.focus();
                return false;
            }else if(f.NEW_KPI_TARGET_LEVEL2.value>9999.99){
                alert('เป้าหมาย 2 ไม่ควรเกิน 9999.99');
                f.NEW_KPI_TARGET_LEVEL2.focus();
                return false;
            }else if(f.NEW_KPI_TARGET_LEVEL3.value>9999.99){
                alert('เป้าหมาย 3 ไม่ควรเกิน 9999.99');
                f.NEW_KPI_TARGET_LEVEL3.focus();
                return false;
            }else if(f.NEW_KPI_TARGET_LEVEL4.value>9999.99){
                alert('เป้าหมาย 4 ไม่ควรเกิน 9999.99');
                f.NEW_KPI_TARGET_LEVEL4.focus();
                return false;
            }else if(f.NEW_KPI_TARGET_LEVEL5.value>9999.99){
                alert('เป้าหมาย 5 ไม่ควรเกิน 9999.99');
                f.NEW_KPI_TARGET_LEVEL5.focus();
                return false;
            }else{
               if(f.NEW_KPI_NAME.value=="") {
			alert("กรุณาระบุ ตัวชี้วัด");
			f.NEW_KPI_NAME.focus();
		return false;
		} else if(f.NEW_KPI_PER_NAME.value=="") {
			alert("กรุณาระบุ ผู้กำกับดูแลตัวชี้วัด");
			f.NEW_KPI_PER_NAME.focus();
		return false;
		}else if(f.NEW_PFR_NAME.value=="" && f.NEW_PFR_NAME1.value=="" && f.NEW_PFR_NAME2.value=="") {
			alert("กรุณาระบุ ประเด็นการประเมินผลฯ");
			f.NEW_PFR_NAME.focus();
			f.NEW_PFR_NAME1.focus();
			f.NEW_PFR_NAME2.focus();
		return false;
		}else{ 
			form1.command.value='ADD';
		return true;
		}
                
            }
            
            
			
	}
		
	function call_print(year){
		parameter = "&KPI_YEAR=" +year;
		call_openDialog("rpt_kpi_kpi_frame.html?MENU_ID_LV0=<?=$MENU_ID_LV0?>&MENU_ID_LV1=<?=$MENU_ID_LV1?>&MENU_ID_LV2=<?=$MENU_ID_LV2?>&MENU_ID_LV3=<?=$MENU_ID_LV3?>" + parameter,800,600,"รายงานตัวชี้วัด");
	}	

	function returnFrom(src, returnValue){
//		alert("src="+src+"("+returnValue+")");
		 if  (src.indexOf("search_org") > -1) {
                     
                    //alert('1..'+returnValue+arrValue[1]+"..."+arrValue[0]); 
			if(returnValue){
				arrValue = returnValue.split("<::>");
				if (arrValue[7]=="call_search_ministry") {
					form1.MINISTRY_ID.value = arrValue[0];
					form1.MINISTRY_NAME.value = arrValue[1];
					form1.DEPARTMENT_ID.value = "";
					form1.DEPARTMENT_NAME.value = "";
					form1.ORG_ID.value = "";
					form1.ORG_NAME.value = "";
				}else if (arrValue[7]=="call_search_department") {
					form1.DEPARTMENT_ID.value = arrValue[0];
					form1.DEPARTMENT_NAME.value = arrValue[1];
					form1.ORG_ID.value = "";
					form1.ORG_NAME.value = "";
					form1.submit();
				}else if (arrValue[7]=="call_search_org") {
					form1.ORG_ID.value = arrValue[0];
					form1.ORG_NAME.value = arrValue[1];
					form1.submit();
				}
			} // end if
		} else if  (src.indexOf("search_person") > -1) {
				   //alert('2..'+returnValue+arrValue[1]+"..."+arrValue[0]);
			if(returnValue){
				arrValue = returnValue.split("<::>");
				if (arrValue[20]=="call_type_1") {
				 form1.KPI_PER_ID.value = arrValue[0];
				 form1.KPI_PER_NAME.value = arrValue[1];
				 form1.UNDER_ORG_NAME.value = arrValue[4];
				 form1.UNDER_ORG_NAME1.value = arrValue[14];	
				}else  {
				 form1.NEW_KPI_PER_ID.value = arrValue[0];
				 form1.NEW_KPI_PER_NAME.value = arrValue[1];
				 form1.NEW_ORG_NAME.value = arrValue[4];
				 form1.NEW_UNDER_ORG_NAME1.value = arrValue[14];	
				}
			} // end if
		} else if  (src.indexOf("kpi_performance_review_list") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				if (arrValue[5]=="call_type_1") {
					form1.PFR_ID.value = arrValue[0];
					if (myDecode(arrValue[4])) {
                                            form1.PFR_NAME2.value = myDecode(arrValue[2]);
                                            form1.PFR_NAME1.value = myDecode(arrValue[3]);
                                            form1.PFR_NAME.value = myDecode(arrValue[4]);
					}else if (myDecode(arrValue[3])) {
                                            form1.PFR_NAME.value = myDecode(arrValue[3]);
                                            form1.PFR_NAME1.value = myDecode(arrValue[2]);
                                            form1.PFR_NAME2.value = "";
					}else if (myDecode(arrValue[2])) {
                                            form1.PFR_NAME.value = myDecode(arrValue[2]);
                                            form1.PFR_NAME1.value = "";
                                            form1.PFR_NAME2.value = "";
					}	
				}else  {
					form1.NEW_PFR_ID.value = arrValue[0];
					if (myDecode(arrValue[4])) {
                                            form1.NEW_PFR_NAME2.value = myDecode(arrValue[2]);
                                            form1.NEW_PFR_NAME1.value = myDecode(arrValue[3]);
                                            form1.NEW_PFR_NAME.value = myDecode(arrValue[4]);
					}else if (myDecode(arrValue[3])) {
                                            form1.NEW_PFR_NAME.value = myDecode(arrValue[3]);
                                            form1.NEW_PFR_NAME1.value = myDecode(arrValue[2]);
                                            form1.NEW_PFR_NAME2.value = "";
					}else if (myDecode(arrValue[2])) {
                                            form1.NEW_PFR_NAME.value = myDecode(arrValue[2]);
                                            form1.NEW_PFR_NAME1.value = "";
                                            form1.NEW_PFR_NAME2.value = "";
					}
				}
			} // end if
		}else if  (src.indexOf("kpi_kpi_parent") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				if(arrValue[0] != form1.KPI_ID_REF.value){
				form1.NEW_KPI_ID_REF.value = arrValue[0];
				form1.command.value = "CHANGEKPIPARENT";
				form1.submit();
				}
			} // end if
		} else if  (src.indexOf("rpt_kpi_kpi_frame") > -1) {
			if(returnValue){
			    arrValue = returnValue.split("<::>");
				//ไม่มีค่า value
			} // end if
		}  		
//		$( "#d_frame" )[0].src="";
//		alert("returnValue="+tt.value);
		tt.value = returnValue;
	} // end if
	
</script>
<span id="defaultTheme"></span> 
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="label_normal">
	<tr>
    	<td height="10"><?include("header_menu.html")?></td>
  	</tr>
    <tr> 
	  <td align="left" valign="top">
<?	
		if ($UPD) $OPTIONAL_TITLE=" &gt; แก้ไขข้อมูล"; elseif ($VIEW) $OPTIONAL_TITLE=" &gt; ดูข้อมูล";
		include("current_location.html");
?>
	  </td>
	</tr>
  	<tr>
    	<td align="left" valign="top"><form name="form1" method="post" action="kpi_kpi.html" enctype="multipart/form-data">
		  <input type="hidden" name="MENU_ID_LV0" value="<?=$MENU_ID_LV0?>">
		  <input type="hidden" name="MENU_ID_LV1" value="<?=$MENU_ID_LV1?>">
		  <input type="hidden" name="MENU_ID_LV2" value="<?=$MENU_ID_LV2?>">
		  <input type="hidden" name="MENU_ID_LV3" value="<?=$MENU_ID_LV3?>">
          <input type="hidden" name="command" value="">
          <input type="hidden" name="NEW_KPI_ID_REF">
          <input type="hidden" name="KPI_ID_REF" value="<?=$KPI_ID_REF?>">
          <input type="hidden" name="KPI_ID" value="<?=$KPI_ID?>">
          <input type="hidden" name="KPI_LEAF_NODE" value="<?=$KPI_LEAF_NODE?>">
          <input type="hidden" name="LIST_OPENED_KPI" value="<?=$LIST_OPENED_KPI?>">
		  <input type="hidden" name="KPI_YEAR" value="<?=$KPI_YEAR?>">
&nbsp;
<center><?php echo $srtAlert;?></center>
  <table width="95%"  border="0" align="center" cellpadding="0" cellspacing="0">
    <tr>
      <td align="center" valign="top">
          <table width="98%" border="0" align="center" cellpadding="1" cellspacing="1" class="table_body">
        <tr>
          <td height="10"></td>
        </tr>
        <tr align="center">
          <td height="25" valign="top"><? if($HAVE_YEAR && $DEPARTMENT_ID || $BKK_FLAG==1){ ?>
              <table width="98%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td width="15%" rowspan="2" align="center" valign="top">
                      <table width="95%" border="0" cellspacing="0" cellpadding="0" class="table_body_3">
                      <tr>
                        <td height="22" align="center" class="table_head"><?=$YEAR_TITLE?></td>
                      </tr>
                      <? 
						foreach($arr_kpi_year as $value){ 
							$class = "table_body_3";
							if($value==$KPI_YEAR) $class = "table_body_3_over";

							$cmd = " select SUM(KPI_EVALUATE) as SUM_KPI_EVALUATE, COUNT(KPI_ID) as COUNT_KPI_CHILD from PER_KPI where trim(KPI_YEAR)='$value' and (KPI_ID_REF IS NULL or KPI_ID_REF='') and KPI_EVALUATE IS NOT NULL ";
							$db_dpis->send_cmd($cmd);
							//echo $cmd;
							$data = $db_dpis->get_array();
							$SUM_KPI_EVALUATE = $data[SUM_KPI_EVALUATE] + 0;
							$COUNT_KPI_CHILD = $data[COUNT_KPI_CHILD] + 0;
							
							$APPROX_KPI_EVALUATE = "";
							if($SUM_KPI_EVALUATE > 0 && $COUNT_KPI_CHILD > 0) $APPROX_KPI_EVALUATE = floor($SUM_KPI_EVALUATE / $COUNT_KPI_CHILD);

							switch($APPROX_KPI_EVALUATE){
								case 1 :
									$KPI_IMG = "images/ball_red.gif";
									break;
								case 2 :
									$KPI_IMG = "images/ball_orange.gif";
									break;
								case 3 :
									$KPI_IMG = "images/ball_yellow.gif";
									break;
								case 4 :
									$KPI_IMG = "images/ball_green_light.gif";
									break;
								case 5 :
									$KPI_IMG = "images/ball_green.gif";
									break;
								default :
									$KPI_IMG = "images/space.gif";
							} // end switch case
					?>
                      <tr>
                        <td height="22" class="<?=$class?>" align="center">
                            <img src="<?=$KPI_IMG?>" width="11" height="11" hspace="4"><span onClick="form1.KPI_YEAR.value='<?=$value?>'; form1.KPI_ID.value=''; form1.KPI_ID_REF.value=''; form1.LIST_OPENED_KPI.value=''; form1.submit();" style="cursor:hand;">
                          <?=$value?>
                        </span>&nbsp;<img src="images/print01.gif" width="20" height="20" onClick="call_print(<?=$value; ?>);" style="cursor:hand;" align="middle">
                        </td>
                      </tr>
                      <? } // end foreach ?>
                  </table>
                  </td>
                  <td width="1%" rowspan="2" >&nbsp;</td>
                  <?
				  		if($KPI_YEAR){
							$cmd = " select SUM(KPI_EVALUATE) as SUM_KPI_EVALUATE, COUNT(KPI_ID) as COUNT_KPI_CHILD from PER_KPI where trim(KPI_YEAR)='$KPI_YEAR' and (KPI_ID_REF IS NULL or KPI_ID_REF='') and KPI_EVALUATE IS NOT NULL ";
							$db_dpis->send_cmd($cmd);
//							echo "$cmd<br>";
							$data = $db_dpis->get_array();
							//echo "<pre>"; print_r($data); echo "</pre>";
							$SUM_KPI_EVALUATE = $data[SUM_KPI_EVALUATE] + 0;
							$COUNT_KPI_CHILD = $data[COUNT_KPI_CHILD] + 0;
							
							$APPROX_KPI_EVALUATE = "";
							$REAL_KPI_EVALUATE = "";							
							if($SUM_KPI_EVALUATE > 0 && $COUNT_KPI_CHILD > 0){ 
								$APPROX_KPI_EVALUATE = floor($SUM_KPI_EVALUATE / $COUNT_KPI_CHILD);
								$REAL_KPI_EVALUATE = number_format(round(($SUM_KPI_EVALUATE / $COUNT_KPI_CHILD), 3), 3);
							} // end if
//							echo "$APPROX_KPI_EVALUATE<br>";

							switch($APPROX_KPI_EVALUATE){
								case 1 :
									$KPI_IMG = "images/ball_red.gif";
									break;
								case 2 :
									$KPI_IMG = "images/ball_orange.gif";
									break;
								case 3 :
									$KPI_IMG = "images/ball_yellow.gif";
									break;
								case 4 :
									$KPI_IMG = "images/ball_green_light.gif";
									break;
								case 5 :
									$KPI_IMG = "images/ball_green.gif";
									break;
								default :
									$KPI_IMG = "images/space.gif";
							} // end switch case
						} // end if
						
						$class = "table_head";
						if(!$KPI_ID) $class = "table_body_over";
				  ?>
                  <td height="22" class="<?=$class?>">&nbsp;<img src="<?=$KPI_IMG?>" width="11" height="11" hspace="4"><?=($REAL_KPI_EVALUATE)?" [$REAL_KPI_EVALUATE] ":""?><span onClick="select_kpi(<?=($START_KPI_ID + 0)?>,<?=($START_KPI_ID + 0)?>);" style="cursor:hand;">ตัวชี้วัด ประจำ<?=$YEAR_TITLE?>&nbsp;&nbsp;<?=$KPI_YEAR?></span></td>
                </tr>
                <tr>
                  <td valign="top"><? list_tree_kpi("", $START_KPI_ID, $KPI_ID, 1); ?></td>
                </tr>
              </table>
             <? 
	     		}elseif(!$DEPARTMENT_ID){ echo "กรุณาเลือก<?=$DEPARTMENT_TITLE?>ที่ต้องการดูข้อมูล";
			}else{ echo "ไม่มีตัวชี้วัด";
			 } // end if 
		?>
          </td>
        </tr>
        <tr>
          <td height="10"></td>
        </tr>
      </table>
          
      </td>
      <td width="45%" align="center" valign="top">
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td >
                <table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="25%" align="right" height="22"><span class="label_alert">*</span>&nbsp;<?=$MINISTRY_TITLE?>&nbsp;:&nbsp;</td>
                  <td><input type="text" name="MINISTRY_NAME" value="<?=$MINISTRY_NAME?>" style="width:75%" class="textbox" readonly>
			<input type="hidden" name="MINISTRY_ID" value="<?=$MINISTRY_ID?>">
			<? if($CTRL_TYPE < 3 && $SESS_USERGROUP_LEVEL < 3){ ?>
			<input type="button" name="btn_ministry" class="button" value="<?=$SELECT_TITLE?>" title="<?=$MINISTRY_SELECT?>" onClick="call_search_ministry();">
			<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.MINISTRY_ID.value=''; form1.MINISTRY_NAME.value=''; form1.DEPARTMENT_ID.value=''; form1.DEPARTMENT_NAME.value=''; form1.ORG_NAME.value=''; form1.ORG_ID.value=''; form1.submit();" align="center" alt="ล้างค่า">
			<? } // end if ?>		    </td>
                </tr>
                <tr>
                  <td align="right" height="22"><span class="label_alert">*</span>&nbsp;<?=$DEPARTMENT_TITLE ?>&nbsp;:&nbsp;</td>
                  <td>
		    	<input type="text" name="DEPARTMENT_NAME" value="<?=$DEPARTMENT_NAME?>" style="width:75%" class="textbox" readonly>
			<input type="hidden" name="DEPARTMENT_ID" value="<?=$DEPARTMENT_ID?>">
			<? if($CTRL_TYPE < 4 && $SESS_USERGROUP_LEVEL < 4){ ?>
			<input type="button" name="btn_department" class="button" value="<?=$SELECT_TITLE?>" title="<?=$DEPARTMENT_SELECT?>" onClick="call_search_department();">
			<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.DEPARTMENT_ID.value=''; form1.DEPARTMENT_NAME.value=''; form1.ORG_NAME.value=''; form1.ORG_ID.value=''; form1.submit();" align="center" alt="ล้างค่า">
			<? } // end if ?>		    </td>
                </tr>
				<tr>
				  <td align="right"><?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
				  <td><input type="text" name="ORG_NAME" value="<?=$ORG_NAME?>" style="width:75%" class="textbox"  readonly="true">
							<input type="hidden" name="ORG_ID" value="<?=$ORG_ID?>">
							<? if($SESS_USERGROUP_LEVEL < 5 && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")){ ?>
							<input type="button" name="btn_org" value="<?=$SELECT_TITLE?>" class="button" onClick="call_search_org()" >
			<input type="image" src="images/icon_clear.gif" width="22" height="22" onClick="form1.ORG_NAME.value=''; form1.ORG_ID.value=''; return false;" align="center" alt="ล้างค่า">
							<? } // end if ?>	    				  </td>
                </tr>
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
            </table></td>
          </tr>
      </table>
      &nbsp;
	  <? if($DEPARTMENT_ID || $BKK_FLAG==1){ ?>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="23%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body">เพิ่ม<?=$YEAR_TITLE?></td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal" onKeyPress="return keyEnter(event,document.form1.Submit_add);">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="25%" align="right" height="22"><span class="label_alert">*</span>&nbsp;<?=$YEAR_TITLE?>&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_YEAR" value="" style="width:20%" class="textbox" onKeyPress="return DigitOnly();"></td>
                </tr>
                <tr align="center">
                  <td height="30" colspan="2">
                      <?if($PAGE_AUTH["add"]=="Y"){?>
                      <input name="Submit_add" type="submit" class="button" onClick="form1.KPI_ID.value=''; return checkaddyear(form1); " value="เพิ่ม<?=$YEAR_TITLE?>">
                      <?}?>                  
                      <input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>">
					  </td>
                </tr>
            </table></td>
          </tr>
      </table>
	  &nbsp;
	  <? } // end if ?>
	  <? if($HAVE_YEAR && $KPI_ID) : ?>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="40%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body">เปลี่ยนระดับ&amp;ปรับปรุงตัวชี้วัด</td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="35%" align="right" height="22"><span class="label_alert">*</span>&nbsp;ตัวชี้วัด&nbsp;:&nbsp;</td>
                  <td>
				    	<textarea name="KPI_NAME" rows="10" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_NAME?></textarea>			   			
				  </td>
                </tr>
                <tr>
                  <td width="35%" align="right" height="22">ผลงานจริง&nbsp;:&nbsp;</td>
                  <td>
				    	<textarea name="KPI_RESULT" rows="10" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_RESULT?></textarea>			   			
				  </td>
                </tr>
	  <? if($BKK_FLAG==1){ ?>
            <tr>
              <td height="22" align="right">&nbsp;<span class="label_alert">*</span>&nbsp;<?=$KPI_TYPE_TITLE?>&nbsp;:&nbsp;</td>
              <td>
				<select name="KPI_TYPE" <?=(($PAGE_AUTH["edit"]=="Y" || $PAGE_AUTH["add"]=="Y") && !$VIEW)?"":"disabled"?>>
					<?  foreach($ARR_KPI_TYPE as $key=>$value){  ?><option value="<?=$key; ?>"<?=($KPI_TYPE==$key)?"selected":""?> ><?=$value; ?></option><?  } ?>
				</select>				
				</td>
				</tr>
	  <? } ?>
                <tr>
                  <td height="22" align="right">น้ำหนัก (ร้อยละ)&nbsp;:&nbsp;</td>
                  <td><input type="text" name="KPI_WEIGHT" value="<?=$KPI_WEIGHT?>" style="width:85%" class="textbox" onKeyPress="return NumOnly();" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right">หน่วยวัด&nbsp;:&nbsp;</td>
                  <td><input type="text" name="KPI_MEASURE" value="<?=$KPI_MEASURE?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ผู้กำกับดูแลตัวชี้วัด&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="KPI_PER_NAME" value="<?=$KPI_PER_NAME?>" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="KPI_PER_ID" value="<?=$KPI_PER_ID?>">					  </td>
                      <td width="15%">&nbsp;<? if($KPI_ID && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="Submit" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกผู้กำกับดูแลตัวชี้วัด" onClick="call_search_person(1);"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
				<tr>
                  <td height="22" align="right"><?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input name="UNDER_ORG_NAME" type="text" class="textbox" id="UNDER_ORG_NAME" style="width:100%" value="<?=$UNDER_ORG_NAME?>" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?> ></td>
                      <td width="15%">&nbsp;</td>
                    </tr>
                  </table></td>
                </tr>
				<tr>
                  <td height="22" align="right"><?=$ORG_TITLE1?> &nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22"><input name="UNDER_ORG_NAME1" type="text" class="textbox" id="UNDER_ORG_NAME1" style="width:100%" value="<?=$UNDER_ORG_NAME1?>" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?> ></td>
                      <td width="15%">&nbsp;</td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ประเด็นการประเมินผลฯ&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
                        <input type="text" name="PFR_NAME" value="<?=$PFR_NAME?>" style="width:100%" class="textbox" readonly>
                        <input type="text" name="PFR_NAME1" value="<?=$PFR_NAME1?>" style="width:100%" class="textbox" readonly>
                        <input type="text" name="PFR_NAME2" value="<?=$PFR_NAME2?>" style="width:100%" class="textbox" readonly>
                        <input type="hidden" name="PFR_ID" value="<?=$PFR_ID?>">					  
                      </td>
                      <td width="15%">&nbsp;<? if($KPI_ID && ($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")) : ?><input type="button" name="Submit" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกประเด็นการประเมินผลฯ" onClick="call_search_performance_review(1);"><? endif; ?></td>
                    </tr>
                  </table></td>
                </tr>
<tr>
<td align="right">
				  &nbsp;<img src="images/ball_red.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 1&nbsp;:&nbsp;</td>
                  <td>
                      <input onKeyPress="return NumOnly();" type="text" name="KPI_TARGET_LEVEL1" value="<?=$KPI_TARGET_LEVEL1?>" style="width:85%" class="textbox"  <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>>
                  </td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="KPI_EVALUATE1" value="1" onClick="if(this.checked){ form1.KPI_EVALUATE1[1].checked=false; form1.KPI_EVALUATE1[2].checked=false; form1.KPI_EVALUATE1[3].checked=false; form1.KPI_EVALUATE1[4].checked=false; }" <?=($KPI_EVALUATE1==1)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE2" value="1" onClick="if(this.checked){ form1.KPI_EVALUATE2[1].checked=false; form1.KPI_EVALUATE2[2].checked=false; form1.KPI_EVALUATE2[3].checked=false; form1.KPI_EVALUATE2[4].checked=false; }" <?=($KPI_EVALUATE2==1)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE3" value="1" onClick="if(this.checked){ form1.KPI_EVALUATE3[1].checked=false; form1.KPI_EVALUATE3[2].checked=false; form1.KPI_EVALUATE3[3].checked=false; form1.KPI_EVALUATE3[4].checked=false; }" <?=($KPI_EVALUATE3==1)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE" value="1" onClick="if(this.checked){ form1.KPI_EVALUATE[1].checked=false; form1.KPI_EVALUATE[2].checked=false; form1.KPI_EVALUATE[3].checked=false; form1.KPI_EVALUATE[4].checked=false; }" <?=($KPI_EVALUATE==1)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="KPI_TARGET_LEVEL1_DESC" rows="3" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_TARGET_LEVEL1_DESC?></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_orange.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 2&nbsp;:&nbsp;</td>
                  <td>
                      <input onKeyPress="return NumOnly();" type="text" name="KPI_TARGET_LEVEL2" value="<?=$KPI_TARGET_LEVEL2?>" style="width:85%" class="textbox"  <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>>
                  </td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="KPI_EVALUATE1" value="2" onClick="if(this.checked){ form1.KPI_EVALUATE1[0].checked=false; form1.KPI_EVALUATE1[2].checked=false; form1.KPI_EVALUATE1[3].checked=false; form1.KPI_EVALUATE1[4].checked=false; }" <?=($KPI_EVALUATE1==2)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE2" value="2" onClick="if(this.checked){ form1.KPI_EVALUATE2[0].checked=false; form1.KPI_EVALUATE2[2].checked=false; form1.KPI_EVALUATE2[3].checked=false; form1.KPI_EVALUATE2[4].checked=false; }" <?=($KPI_EVALUATE2==2)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE3" value="2" onClick="if(this.checked){ form1.KPI_EVALUATE3[0].checked=false; form1.KPI_EVALUATE3[2].checked=false; form1.KPI_EVALUATE3[3].checked=false; form1.KPI_EVALUATE3[4].checked=false; }" <?=($KPI_EVALUATE3==2)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE" value="2" onClick="if(this.checked){ form1.KPI_EVALUATE[0].checked=false; form1.KPI_EVALUATE[2].checked=false; form1.KPI_EVALUATE[3].checked=false; form1.KPI_EVALUATE[4].checked=false; }" <?=($KPI_EVALUATE==2)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="KPI_TARGET_LEVEL2_DESC" rows="3" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_TARGET_LEVEL2_DESC?></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_yellow.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 3&nbsp;:&nbsp;</td>
                  <td>
                      <input onKeyPress="return NumOnly();" type="text" name="KPI_TARGET_LEVEL3" value="<?=$KPI_TARGET_LEVEL3?>" style="width:85%" class="textbox"  <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>>
                  </td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="KPI_EVALUATE1" value="3" onClick="if(this.checked){ form1.KPI_EVALUATE1[0].checked=false; form1.KPI_EVALUATE1[1].checked=false; form1.KPI_EVALUATE1[3].checked=false; form1.KPI_EVALUATE1[4].checked=false; }" <?=($KPI_EVALUATE1==3)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE2" value="3" onClick="if(this.checked){ form1.KPI_EVALUATE2[0].checked=false; form1.KPI_EVALUATE2[1].checked=false; form1.KPI_EVALUATE2[3].checked=false; form1.KPI_EVALUATE2[4].checked=false; }" <?=($KPI_EVALUATE2==3)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE3" value="3" onClick="if(this.checked){ form1.KPI_EVALUATE3[0].checked=false; form1.KPI_EVALUATE3[1].checked=false; form1.KPI_EVALUATE3[3].checked=false; form1.KPI_EVALUATE3[4].checked=false; }" <?=($KPI_EVALUATE3==3)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE" value="3" onClick="if(this.checked){ form1.KPI_EVALUATE[0].checked=false; form1.KPI_EVALUATE[1].checked=false; form1.KPI_EVALUATE[3].checked=false; form1.KPI_EVALUATE[4].checked=false; }" <?=($KPI_EVALUATE==3)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="KPI_TARGET_LEVEL3_DESC" rows="3" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_TARGET_LEVEL3_DESC?></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_green_light.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 4&nbsp;:&nbsp;</td>
                  <td>
                      <input onKeyPress="return NumOnly();" type="text" name="KPI_TARGET_LEVEL4" value="<?=$KPI_TARGET_LEVEL4?>" style="width:85%" class="textbox"  <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>>
                  </td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="KPI_EVALUATE1" value="4" onClick="if(this.checked){ form1.KPI_EVALUATE1[0].checked=false; form1.KPI_EVALUATE1[1].checked=false; form1.KPI_EVALUATE1[2].checked=false; form1.KPI_EVALUATE1[4].checked=false; }" <?=($KPI_EVALUATE1==4)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE2" value="4" onClick="if(this.checked){ form1.KPI_EVALUATE2[0].checked=false; form1.KPI_EVALUATE2[1].checked=false; form1.KPI_EVALUATE2[2].checked=false; form1.KPI_EVALUATE2[4].checked=false; }" <?=($KPI_EVALUATE2==4)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE3" value="4" onClick="if(this.checked){ form1.KPI_EVALUATE3[0].checked=false; form1.KPI_EVALUATE3[1].checked=false; form1.KPI_EVALUATE3[2].checked=false; form1.KPI_EVALUATE3[4].checked=false; }" <?=($KPI_EVALUATE3==4)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE" value="4" onClick="if(this.checked){ form1.KPI_EVALUATE[0].checked=false; form1.KPI_EVALUATE[1].checked=false; form1.KPI_EVALUATE[2].checked=false; form1.KPI_EVALUATE[4].checked=false; }" <?=($KPI_EVALUATE==4)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="KPI_TARGET_LEVEL4_DESC" rows="3" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_TARGET_LEVEL4_DESC?></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_green.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 5&nbsp;:&nbsp;</td>
                  <td>
                      <input onKeyPress="return NumOnly();" type="text" name="KPI_TARGET_LEVEL5" value="<?=$KPI_TARGET_LEVEL5?>" style="width:85%" class="textbox"  <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>>
                  </td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="KPI_EVALUATE1" value="5" onClick="if(this.checked){ form1.KPI_EVALUATE1[0].checked=false; form1.KPI_EVALUATE1[1].checked=false; form1.KPI_EVALUATE1[2].checked=false; form1.KPI_EVALUATE1[3].checked=false; }" <?=($KPI_EVALUATE1==5)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE2" value="5" onClick="if(this.checked){ form1.KPI_EVALUATE2[0].checked=false; form1.KPI_EVALUATE2[1].checked=false; form1.KPI_EVALUATE2[2].checked=false; form1.KPI_EVALUATE2[3].checked=false; }" <?=($KPI_EVALUATE2==5)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE3" value="5" onClick="if(this.checked){ form1.KPI_EVALUATE3[0].checked=false; form1.KPI_EVALUATE3[1].checked=false; form1.KPI_EVALUATE3[2].checked=false; form1.KPI_EVALUATE3[3].checked=false; }" <?=($KPI_EVALUATE3==5)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  <td><input type="checkbox" name="KPI_EVALUATE" value="5" onClick="if(this.checked){ form1.KPI_EVALUATE[0].checked=false; form1.KPI_EVALUATE[1].checked=false; form1.KPI_EVALUATE[2].checked=false; form1.KPI_EVALUATE[3].checked=false; }" <?=($KPI_EVALUATE==5)?"checked":""?> <?=(!$VIEW && $PAGE_AUTH["edit"]=="Y" && $KPI_LEAF_NODE)?"":"disabled"?>></td>
				  </tr></table>		  
		  </td>
          <td><textarea name="KPI_TARGET_LEVEL5_DESC" rows="3" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_TARGET_LEVEL5_DESC?></textarea></td>
        </tr>
                <!--tr>
                  <td height="22" align="right">ผลการประเมิน&nbsp;:&nbsp;</td>
                  <td><input type="text" name="KPI_EVALUATE" value="<?=$KPI_EVALUATE?>" style="width:85%" class="textbox" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>></td>
                </tr-->
                <tr>
                  <td width="35%" align="right" height="22"><?=$KPI_DEFINE_TITLE?>&nbsp;:&nbsp;</td>
                  <td>
				    	<textarea name="KPI_DEFINE" rows="10" class="selectbox" style="width:85%" <?=($PAGE_AUTH["add"]=="Y" || $PAGE_AUTH["edit"]=="Y")?"":"readonly"?>><?=$KPI_DEFINE?></textarea>			   			
				  </td>
                </tr>
	  <? if($BKK_FLAG==1){ ?>
				<tr>
                        <td width="35%" align="right">ให้คะแนนการประเมินผล&nbsp;:&nbsp;</td>
                        <td>
						  <input type="radio" name="KPI_SCORE_FLAG" value="1" <?=($KPI_SCORE_FLAG==1 || !$KPI_SCORE_FLAG)?"checked":""?>> ได้
                          <input type="radio" name="KPI_SCORE_FLAG" value="2" <?=($KPI_SCORE_FLAG==2)?"checked":""?>> ไม่ได้						</td>
                </tr>					  
	  <? } ?>
				<? if($KPI_ID) : ?>
                <tr align="center">
                  <td height="30" colspan="2">
                      <?if($PAGE_AUTH["edit"]=="Y"){?>
					  <input name="Submit2" type="button" class="button" onClick="call_change_kpi_level();" value="เปลี่ยนระดับตัวชี้วัด">
					  <?}?>
                      <?if($PAGE_AUTH["edit"]=="Y"){?>
                      <input name="Submit22" type="submit" class="button" onClick="return checkupdate(form1);" value="ปรับปรุงตัวชี้วัด">
                      <?}?>
                      <?if($PAGE_AUTH["del"]=="Y"){?>
                      <input name="Submit22" type="submit" class="button" onClick="
					  if(confirm('ต้องการลบตัวชี้วัดนี้ใช่หรือไม่ [<?=$KPI_NAME?>] ตัวชี้วัดย่อยที่อยู่ภายใต้ตัวชี้วัดนี้จะถูกลบไปด้วย?')){ form1.command.value='DELETE'; }else{ return false; }" value="ลบตัวชี้วัด">
                      <?}?>                  </td>
                </tr>
				<? endif; ?>
            </table></td>
          </tr>
      </table>
	  &nbsp;
	  <? endif; ?>
	  <? if($KPI_YEAR && $PAGE_AUTH["add"]=="Y" && $DEPARTMENT_ID || ($BKK_FLAG==1 && $KPI_YEAR)) : ?>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0">
  	<tr>
	  <td><table width="23%" cellpadding="0" cellspacing="0" class="input_table" style="border-bottom:none;">
		  <tr>
		  	<td height="22" align="center" class="table_body">เพิ่มตัวชี้วัด</td>
		  </tr>		
	  </table></td>
	</tr>
  </table>
	  <table width="100%" align="center" cellpadding="0" cellspacing="0" class="input_table">
          <tr>
            <td>
			
			<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="label_normal">
                <tr>
                  <td colspan="2" height="5"></td>
                </tr>
                <tr>
                  <td width="35%" align="right" height="22"><span class="label_alert">*</span>&nbsp;ตัวชี้วัด&nbsp;:&nbsp;</td>
                  <td>
				    	<textarea name="NEW_KPI_NAME" rows="10" class="selectbox" style="width:85%"></textarea>			   			
				  </td>
                </tr>
	  <? if($BKK_FLAG==1){ ?>
            <tr>
              <td height="22" align="right">&nbsp;<span class="label_alert">*</span>&nbsp;<?=$KPI_TYPE_TITLE?>&nbsp;:&nbsp;</td>
              <td>
				<select name="NEW_KPI_TYPE">
					<?  foreach($ARR_KPI_TYPE as $key=>$value){  ?><option value="<?=$key; ?>"<?=($NEW_KPI_TYPE==$key)?"selected":""?> ><?=$value; ?></option><?  } ?>
				</select>				
				</td>
				</tr>
	  <? } ?>
                <tr>
                  <td height="22" align="right">น้ำหนัก (ร้อยละ)&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_WEIGHT" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
                <tr>
                  <td height="22" align="right">หน่วยวัด&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_MEASURE" value="" style="width:85%" class="textbox"></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ผู้กำกับดูแลตัวชี้วัด&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_KPI_PER_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_KPI_PER_ID" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="Submit" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกผู้กำกับดูแลตัวชี้วัด" onClick="call_search_person(2);"></td>
                    </tr>
                  </table></td>
                </tr>
				<tr>
				  <td align="right"><?=$ORG_TITLE?>&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input name="NEW_ORG_NAME" type="text" class="textbox" id="NEW_ORG_NAME" style="width:100%" ></td>
                      <td width="15%">&nbsp;</td>
                    </tr>
                  </table></td>
                </tr>
				<tr>
				  <td align="right"><?=$ORG_TITLE1?> &nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input name="NEW_UNDER_ORG_NAME1" type="text" class="textbox" id="NEW_UNDER_ORG_NAME1" style="width:100%" ></td>
                      <td width="15%">&nbsp;</td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right"><span class="label_alert">*</span>&nbsp;ประเด็นการประเมินผลฯ&nbsp;:&nbsp;</td>
                  <td><table width="100%"  border="0" cellpadding="0" cellspacing="0" class="label_normal">
                    <tr>
                      <td width="85%" height="22">
						<input type="text" name="NEW_PFR_NAME" value="" style="width:100%" class="textbox" readonly>
						<input type="text" name="NEW_PFR_NAME1" value="" style="width:100%" class="textbox" readonly>
						<input type="text" name="NEW_PFR_NAME2" value="" style="width:100%" class="textbox" readonly>
						<input type="hidden" name="NEW_PFR_ID" value="">					  </td>
                      <td width="15%">&nbsp;<input type="button" name="Submit" class="button" value="<?=$SELECT_TITLE?>" alt="เลือกประเด็นการประเมินผลฯ" onClick="call_search_performance_review(2);"></td>
                    </tr>
                  </table></td>
                </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_red.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 1&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_TARGET_LEVEL1" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE1" value="1" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE1[1].checked=false; form1.NEW_KPI_EVALUATE1[2].checked=false; form1.NEW_KPI_EVALUATE1[3].checked=false; form1.NEW_KPI_EVALUATE1[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE2" value="1" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE2[1].checked=false; form1.NEW_KPI_EVALUATE2[2].checked=false; form1.NEW_KPI_EVALUATE2[3].checked=false; form1.NEW_KPI_EVALUATE2[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE3" value="1" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE3[1].checked=false; form1.NEW_KPI_EVALUATE3[2].checked=false; form1.NEW_KPI_EVALUATE3[3].checked=false; form1.NEW_KPI_EVALUATE3[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE" value="1" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE[1].checked=false; form1.NEW_KPI_EVALUATE[2].checked=false; form1.NEW_KPI_EVALUATE[3].checked=false; form1.NEW_KPI_EVALUATE[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  </tr></table>		
		  </td>
          <td><textarea name="NEW_KPI_TARGET_LEVEL1_DESC" rows="3" class="selectbox" style="width:85%"></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_orange.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 2&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_TARGET_LEVEL2" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE1" value="2" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE1[0].checked=false; form1.NEW_KPI_EVALUATE1[2].checked=false; form1.NEW_KPI_EVALUATE1[3].checked=false; form1.NEW_KPI_EVALUATE1[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE2" value="2" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE2[0].checked=false; form1.NEW_KPI_EVALUATE2[2].checked=false; form1.NEW_KPI_EVALUATE2[3].checked=false; form1.NEW_KPI_EVALUATE2[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE3" value="2" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE3[0].checked=false; form1.NEW_KPI_EVALUATE3[2].checked=false; form1.NEW_KPI_EVALUATE3[3].checked=false; form1.NEW_KPI_EVALUATE3[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE" value="2" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE[0].checked=false; form1.NEW_KPI_EVALUATE[2].checked=false; form1.NEW_KPI_EVALUATE[3].checked=false; form1.NEW_KPI_EVALUATE[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  </tr></table>		
		  </td>
          <td><textarea name="NEW_KPI_TARGET_LEVEL2_DESC" rows="3" class="selectbox" style="width:85%"></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_yellow.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 3&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_TARGET_LEVEL3" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE1" value="3" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE1[0].checked=false; form1.NEW_KPI_EVALUATE1[1].checked=false; form1.NEW_KPI_EVALUATE1[3].checked=false; form1.NEW_KPI_EVALUATE1[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE2" value="3" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE2[0].checked=false; form1.NEW_KPI_EVALUATE2[1].checked=false; form1.NEW_KPI_EVALUATE2[3].checked=false; form1.NEW_KPI_EVALUATE2[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE3" value="3" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE3[0].checked=false; form1.NEW_KPI_EVALUATE3[1].checked=false; form1.NEW_KPI_EVALUATE3[3].checked=false; form1.NEW_KPI_EVALUATE3[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE" value="3" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE[0].checked=false; form1.NEW_KPI_EVALUATE[1].checked=false; form1.NEW_KPI_EVALUATE[3].checked=false; form1.NEW_KPI_EVALUATE[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="NEW_KPI_TARGET_LEVEL3_DESC" rows="3" class="selectbox" style="width:85%"></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_green_light.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 4&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_TARGET_LEVEL4" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE1" value="4" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE1[0].checked=false; form1.NEW_KPI_EVALUATE1[1].checked=false; form1.NEW_KPI_EVALUATE1[2].checked=false; form1.NEW_KPI_EVALUATE1[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE2" value="4" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE2[0].checked=false; form1.NEW_KPI_EVALUATE2[1].checked=false; form1.NEW_KPI_EVALUATE2[2].checked=false; form1.NEW_KPI_EVALUATE2[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE3" value="4" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE3[0].checked=false; form1.NEW_KPI_EVALUATE3[1].checked=false; form1.NEW_KPI_EVALUATE3[2].checked=false; form1.NEW_KPI_EVALUATE3[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE" value="4" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE[0].checked=false; form1.NEW_KPI_EVALUATE[1].checked=false; form1.NEW_KPI_EVALUATE[2].checked=false; form1.NEW_KPI_EVALUATE[4].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  </tr></table>
		  </td>
          <td><textarea name="NEW_KPI_TARGET_LEVEL4_DESC" rows="3" class="selectbox" style="width:85%"></textarea></td>
        </tr>
                <tr>
                  <td height="22" align="right">&nbsp;<img src="images/ball_green.gif" width="11" height="11" hspace="4">&nbsp;เป้าหมาย 5&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_TARGET_LEVEL5" value="" style="width:85%" class="textbox" onKeyPress="return NumOnly();"></td>
                </tr>
        <tr>
          <td height="22" align="right">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="label_normal">
            <tr class="table_head" align="center">
				  <td colspan="4">ไตรมาส</td>
				  </tr>
				  <tr align="center">
				  <td>1</td>
				  <td>2</td>
				  <td>3</td>
				  <td>4</td>
				  </tr><tr align="center">
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE1" value="5" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE1[0].checked=false; form1.NEW_KPI_EVALUATE1[1].checked=false; form1.NEW_KPI_EVALUATE1[2].checked=false; form1.NEW_KPI_EVALUATE1[3].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE2" value="5" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE2[0].checked=false; form1.NEW_KPI_EVALUATE2[1].checked=false; form1.NEW_KPI_EVALUATE2[2].checked=false; form1.NEW_KPI_EVALUATE2[3].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE3" value="5" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE3[0].checked=false; form1.NEW_KPI_EVALUATE3[1].checked=false; form1.NEW_KPI_EVALUATE3[2].checked=false; form1.NEW_KPI_EVALUATE3[3].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  <td><input type="checkbox" name="NEW_KPI_EVALUATE" value="5" onClick="if(this.checked){ form1.NEW_KPI_EVALUATE[0].checked=false; form1.NEW_KPI_EVALUATE[1].checked=false; form1.NEW_KPI_EVALUATE[2].checked=false; form1.NEW_KPI_EVALUATE[3].checked=false; }" <?=(!$VIEW && $PAGE_AUTH["add"]=="Y")?"":"disabled"?>></td>
				  </tr></table>		  
		  </td>
          <td><textarea name="NEW_KPI_TARGET_LEVEL5_DESC" rows="3" class="selectbox" style="width:85%"></textarea></td>
        </tr>
                <!--tr>
                  <td height="22" align="right">ผลการประเมิน&nbsp;:&nbsp;</td>
                  <td><input type="text" name="NEW_KPI_EVALUATE" value="" style="width:85%" class="textbox"></td>
                </tr-->
                <tr>
                  <td width="35%" align="right" height="22"><?=$KPI_DEFINE_TITLE?>&nbsp;:&nbsp;</td>
                  <td>
				    	<textarea name="NEW_KPI_DEFINE" rows="10" class="selectbox" style="width:85%"></textarea>			   			
				  </td>
                </tr>
	  <? if($BKK_FLAG==1){ ?>
				<tr>
                        <td width="35%" align="right">ให้คะแนนการประเมินผล&nbsp;:&nbsp;</td>
                        <td>
						  <input type="radio" name="NEW_KPI_SCORE_FLAG" value="1" <?=($NEW_KPI_SCORE_FLAG==1 || !$NEW_KPI_SCORE_FLAG)?"checked":""?>> ได้
                          <input type="radio" name="NEW_KPI_SCORE_FLAG" value="2" <?=($NEW_KPI_SCORE_FLAG==2)?"checked":""?>> ไม่ได้						</td>
                </tr>					  
	  <? } ?>
                <tr align="center">
                  <td height="30" colspan="2">
                      <?if($PAGE_AUTH["add"]=="Y"){?>
                      <input name="Submit2" type="submit" class="button" onClick="return checkadd(form1);" value="เพิ่มตัวชี้วัด<?=($KPI_ID?"ย่อย":"")?>">
                      <?}?>                  
                      <input name="Reset" type="reset" class="button" value="<?=$CLEAR_TITLE?>">
					  </td>
                </tr>
            </table></td>
          </tr>
      </table>
	  <? endif; ?>
      </td>
    </tr>
  </table>
        </form>	
		</td>
	</tr>
</table>
<?
	include("jqModalDialog.html");
?>
</body>
<script type="text/javascript">
setActiveStyleSheet(document.getElementById("defaultTheme"), "winter");
</script>
<script language="JavaScript" src="java_scripts/menu_layer.js"></script>
    
</html>
